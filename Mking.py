import base64
exec(base64.b64decode("IyMjIEltcG9ydCBNb2R1bGUNCmltcG9ydCByZXF1ZXN0cyxiczQsc3lzLG9zLHJhbmRvbSx0aW1lLHJlLGpzb24sdXVpZCxzdWJwcm9jZXNzLHBsYXRmb3JtLGJhc2U2NA0KZnJvbSByYW5kb20gaW1wb3J0IHJhbmRpbnQNCmZyb20gY29uY3VycmVudC5mdXR1cmVzIGltcG9ydCBUaHJlYWRQb29sRXhlY3V0b3IgYXMgVGhyZWFkUG9vbA0KZnJvbSBiczQgaW1wb3J0IEJlYXV0aWZ1bFNvdXAgYXMgcGFyDQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRlDQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQ0KZnJvbSB1cmxsaWIucGFyc2UgaW1wb3J0IHF1b3RlDQoNCg0KDQojIyMgUGVydW1wYW1hYW4gTW9kdWxlICYgU3ludGF4DQpfcmVxX3Nlc18gID0gcmVxdWVzdHMuU2Vzc2lvbigpDQpfcmVxX2dldF8gID0gcmVxdWVzdHMuZ2V0DQpfcmVxX3Bvc3RfID0gcmVxdWVzdHMucG9zdA0KX2pzX2xvXyAgICA9IGpzb24ubG9hZHMNCl9jaWNpX2F6aW12YXVfICAgID0gaW5wdXQNCl9hemltdmF1X2RhcHVudGFfID0gb3Blbg0KX2NpY2lfY2ljaV8gICAgICAgPSBleGl0DQoNCiMjIyBXYXJuYQ0KWiA9ICJcMDMzWzE7MzBtIiAjIEhpdGFtDQpQID0gIlwwMzNbMTszN20iICMgUHV0aWgNCk0gPSAiXDAzM1sxOzMxbSIgIyBNZXJhaA0KSCA9ICJcMDMzWzE7MzJtIiAjIEhpamF1DQpLID0gIlwwMzNbMTszM20iICMgS3VuaW5nDQpCID0gIlwwMzNbMTszNG0iICMgQmlydQ0KVSA9ICJcMDMzWzE7MzVtIiAjIFVuZ3UNCk8gPSAiXDAzM1sxOzM2bSIgIyBCaXJ1IE11ZGENCk4gPSAiXDAzM1swbSIgICAgIyBXYXJuYSBNYXRpDQoNCiMjIyBIb3N0ICYgUGVuYW1wdW5nYW4NCmhvc3QgPSAiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tIg0Kb2sgPSBbXQ0KY3AgPSBbXQ0KdHRsID0gW10NCmNvdW50ID0gMQ0KZGF0YV8xID0ge30NCmRhdGFfMiA9IHt9DQpkYXRhX2NoYW5nZV8xID0ge30NCmRhdGFfY2hhbmdlXzIgPSB7fQ0KZGF0YV91c2VyID0gW10NCmhlYWRlcl9ncnVwID0geyJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwXzE1XzcpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS85Ni4wLjQ2NjQuMTEwIFNhZmFyaS81MzcuMzYifQ0KaGVhZGVyX25hbWEgPSB7Im9yaWdpbiI6ICJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20iLCJhY2NlcHQtbGFuZ3VhZ2UiOiAiZW4tR0IsZW4tVVM7cT0wLjksZW47cT0wLjgsYm47cT0wLjciLCJhY2NlcHQtZW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsImFjY2VwdCI6ICJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS93ZWJwLGltYWdlL2FwbmcsKi8qO3E9MC44IiwidXNlci1hZ2VudCI6ICJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNC40LjQ7IGVuLWF1OyBTQU1TVU5HIFNNLU45MTVHIEJ1aWxkL0tUVTg0UCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLVEhNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi8yLjAgQ2hyb21lLzM0LjAuMTg0Ny43NiBNb2JpbGUgU2FmYXJpLzUzNy4zNiIsIkhvc3QiOiAiIi5qb2luKGJzNC5yZS5maW5kYWxsKCI6Ly8oLio/KSQiLCJodHRwczovL20uZmFjZWJvb2suY29tIikpLCJyZWZlcmVyIjogImh0dHBzOi8vbS5mYWNlYm9vay5jb20vbG9naW4vP25leHQmcmVmPWRibCZmbCZyZWZpZD04IiwiY2FjaGUtY29udHJvbCI6ICJtYXgtYWdlPTAiLCJ1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzIjogIjEiLCJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIn0NCmhlYWRlcl9oYXNodGFnID0geydhdXRob3JpdHknOiAnbWJhc2ljLmZhY2Vib29rLmNvbScsJ21ldGhvZCc6ICdHRVQnLCdwYXRoJzogJy9mYXZpY29uLmljbycsJ3NjaGVtZSc6ICdodHRwcycsJ2FjY2VwdCc6ICdpbWFnZS9hdmlmLGltYWdlL3dlYnAsaW1hZ2UvYXBuZyxpbWFnZS9zdmcreG1sLGltYWdlLyosKi8qO3E9MC44JywnYWNjZXB0LWVuY29kaW5nJzogJ2d6aXAsIGRlZmxhdGUnLCdhY2NlcHQtbGFuZ3VhZ2UnOiAnZW4tVVMsZW47cT0wLjknLCd1c2VyLWFnZW50JzogJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA0LjQuNDsgZW4tYXU7IFNBTVNVTkcgU00tTjkxNUcgQnVpbGQvS1RVODRQKSBBcHBsZVdlYktpdC81MzcuMzYgKEtUSE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzIuMCBDaHJvbWUvMzQuMC4xODQ3Ljc2IE1vYmlsZSBTYWZhcmkvNTM3LjM2Jywnb3JpZ2luJzogJ2h0dHBzOi8vd3d3LmZhY2Vib29rLmNvbScsJ3JlZmVyZXInOiAnaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tJ30NCg0KciA9IHN0cihyYW5kb20ucmFuZGludCgxLDk5OTkpKQ0KcnggPSByLnJlcGxhY2UoIjEiLCJBIikucmVwbGFjZSgiMiIsIkMiKS5yZXBsYWNlKCIzIiwiQiIpLnJlcGxhY2UoIjQiLCJFIikucmVwbGFjZSgiNSIsIkgiKS5yZXBsYWNlKCI2IiwiSSIpLnJlcGxhY2UoIjciLCJZIikNCnBsaXN0ID0gKHBsYXRmb3JtLnVuYW1lKCkpWzJdDQpiYXNleCA9IHBsaXN0DQpiYXNleDEgPSBiYXNleC5lbmNvZGUoJ2FzY2lpJykNCmJhc2V4MiA9IGJhc2U2NC5iNjRlbmNvZGUoYmFzZXgxKQ0KYmFzZXgzID0gYmFzZXgyLmRlY29kZSgnYXNjaWknKQ0KYmFzZTQgPSAoYmFzZXgzKS51cHBlcigpDQpiYXNlc3BsaXQgPSBiYXNlNC5yZXBsYWNlKCc9JywgJ04nKS5yZXBsYWNlKCdBJywgJzMnKS5yZXBsYWNlKCdCJywgJzknKS5yZXBsYWNlKCdDJywgJzcnKS5yZXBsYWNlKCdEJywgJzEnKS5yZXBsYWNlKCdFJywgJzQnKS5yZXBsYWNlKCdNJywgJzInKS5yZXBsYWNlKCdMJywgJzYnKS5yZXBsYWNlKCdGJywgJzgnKS5yZXBsYWNlKCdOJywgJ0UnKS5yZXBsYWNlKCdUJywgJ1InKS5yZXBsYWNlKCI1IiwiWCIpLnJlcGxhY2UoIjEiLCJYIikNCg0KdHJ5Og0KICAgIHJxID0gcmVxdWVzdHMuZ2V0KCdodHRwczovL3Bhc3RlYmluLmNvbS9yYXcvbkVwanQ2UU4nKS50ZXh0DQpleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5Db25uZWN0aW9uRXJyb3I6DQogICAgcHJpbnQoJ1xuTk8gSU5URVJORVQgQ09OTkVDVElPTlxuJykNCiAgICBleGl0KCkNCg0KIyMjIFdha3R1ICYgVGFuZ2dhbA0KX19zZWthcmFuZ19fID0gZGF0ZXRpbWUubm93KCkNCl9fdGFodW5fXyA9IF9fc2VrYXJhbmdfXy55ZWFyDQpfX2J1bGFuX18gPSBfX3Nla2FyYW5nX18ubW9udGgNCl9faGFyaV9fICA9IF9fc2VrYXJhbmdfXy5kYXkNCg0KYnVsYW5fdHRsID0geyIwMSI6ICJKQU4iLCAiMDIiOiAiRkVCIiwgIjAzIjogIk1BUiIsICIwNCI6ICJBUFIiLCAiMDUiOiAiTUFZIiwgIjA2IjogIkpVTiIsICIwNyI6ICJKVUwiLCAiMDgiOiAiQVVHIiwgIjA5IjogIlNFUCIsICIxMCI6ICJPQ1QiLCAiMTEiOiAiTk9WIiwgIjEyIjogIkRFQyJ9DQpfbGlzdF9idWxhbl8gPSBbIkpBTiIsICJGRUIiLCAiTUFSIiwgIkFQUiIsICJNQVkiLCAiSlVOIiwgIkpVTCIsICJBVUciLCAiU0VQIiwgIk9DVCIsICJOT1YiLCAiREVDIl0NCg0KdHJ5Og0KICAgIGlmIF9fYnVsYW5fXyA8IDAgb3IgX19idWxhbl9fID4gMTI6DQogICAgICAgIF9jaWNpX2NpY2lfKCkNCiAgICBfYnVsYW5fc2VrYXJhbmdfID0gX19idWxhbl9fIC0gMQ0KZXhjZXB0IFZhbHVlRXJyb3I6DQogICAgX2NpY2lfY2ljaV8oKQ0KX2J1bGFuXyA9IF9saXN0X2J1bGFuX1tfYnVsYW5fc2VrYXJhbmdfXQ0KdGFuZ2dhbCA9ICgiJXMtJXMtJXMiJShfX2hhcmlfXyxfYnVsYW5fLF9fdGFodW5fXykpDQoNCl9teV9hY2NvdW50XyA9IFsNCiAgICAnMTAwMDQ1MjAzODU1Mjk0JywnMTAwMDE0ODM5MjcwMjA1J10NCg0KIyMjIFVzZXIgQWdlbnQNCnVhX2ludGVsbWFjID0gJ01vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwXzE1XzcpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS85Ni4wLjQ2NjQuMTEwIFNhZmFyaS81MzcuMzY7XScNCnVhX25va2lhICAgPSAnTW96aWxsYS80LjEgKGNvbXBhdGlibGU7IE1TSUUgNS4wOyBTeW1iaWFuIE9TOyBOb2tpYSA3NjEwOzQ1MSkgT3BlcmEgNi4yMCcNCnVhX2FzdXMgICAgPSAnRGFsdmlrLzEuNi4wIChMaW51eDsgVTsgQW5kcm9pZCA0LjQuMjsgQVNVU19UMDBRIEJ1aWxkL0tWVDQ5TCkvQ0xEQy0xLjE7XScNCnVhX2h1YXdlaSAgPSAnTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDcuMDsgSFVBV0VJIENBWi1BTDEwOyBITVNDb3JlIDUuMy4wLjMxMjsgR01TQ29yZSAyMC4zOS4xNSkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzgzLjAuNDEwMy4xMDYgSHVhd2VpQnJvd3Nlci8xMS4xLjAuMzAyIE1vYmlsZSBTYWZhcmkvNTM3LjM2IFtGQkFOL0VNQTtGQkxDL2VuX1VTO0ZCQVYvMTczLjAuMC4xMC4xMTg7XScgI0RPTkUNCnVhX3Zpdm8gICAgPSAnTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBWMjAyNykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzgwLjAuMzk4Ny45OSBNb2JpbGUgU2FmYXJpLzUzNy4zNicNCnVhX29wcG8gICAgPSAnTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDQuMS4xOyBYOTA5IEJ1aWxkL0pSTzAzTCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzMwLjAuMTU5OS45MiBNb2JpbGUgU2FmYXJpLzUzNy4zNiBbRkJBTi9FTUE7RkJMQy9lbl9VUztGQkFWLzE3My4wLjAuMTAuMTE4O10nDQp1YV9zYW1zdW5nID0gJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA1LjAuMTsgU0FNU1VORyBHVC1JOTUxNSBCdWlsZC9MUlgyMkMpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFNhbXN1bmdCcm93c2VyLzIuMSBDaHJvbWUvMzQuMC4xODQ3Ljc2IE1vYmlsZSBTYWZhcmkvNTM3LjM2O10nDQp1YV93aW5kb3dzID0gJ01vemlsbGEvNS4wIChYMTE7IFU7IExpbnV4IGk2ODY7IGZyLUZSOyBydjoxLjcuOCkgR2Vja28vMjAwNTA1MTEgRmlyZWZveC8xLjAuNDtdJw0KdWFfeGlhb21pICA9ICdNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTE7IE1pIDlUIFBybyBCdWlsZC9SS1ExLjIwMDgyNi4wMDI7IHd2KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBDaHJvbWUvOTQuMC40NjA2LjgwIE1vYmlsZSBTYWZhcmkvNTM3LjM2IFJlZGRpdC9WZXJzaW9uIDIwMjEuMzguMC9CdWlsZCAzNjUwMzIvQW5kcm9pZCAxMSBbRkJBTi9FTUE7RkJMQy9lbl9VUztGQkFWLzI0Ny4wLjAuNS4xMzA7XScNCiMjIyBDbGVhciBMb2dpbiBTZXNzaW9uDQpkZWYgYmVyc2loKCk6DQogICAgdHJ5Om9zLnJlbW92ZSgndG9rZW4udHh0JykNCiAgICBleGNlcHQ6cGFzcw0KICAgIHRyeTpvcy5yZW1vdmUoJ2Nvb2tpZXMudHh0JykNCiAgICBleGNlcHQ6cGFzcw0KDQojIyMgRGlzcGxheSBUZXh0DQpkZWYgamFsYW4oeik6DQogICAgZm9yIGUgaW4geiArICJcbiI6c3lzLnN0ZG91dC53cml0ZShlKTtzeXMuc3Rkb3V0LmZsdXNoKCk7dGltZS5zbGVlcCgwLjA0KQ0KZGVmIG1sYWt1KHopOg0KICAgIGZvciBlIGluIHogKyAiXG4iOnN5cy5zdGRvdXQud3JpdGUoZSk7c3lzLnN0ZG91dC5mbHVzaCgpO3RpbWUuc2xlZXAoMC4wMykNCg0KZGVmIHBzYih6KToNCiAgICBmb3IgZSBpbiB6ICsgJ1xuJzoNCiAgICAgICAgc3lzLnN0ZG91dC53cml0ZShlKQ0KICAgICAgICBzeXMuc3Rkb3V0LmZsdXNoKCkNCiAgICAgICAgdGltZS5zbGVlcCgwLjAwMSkNCg0KDQojIyMgQ2xlYXIgVGVybWluYWwNCmRlZiBjbGVhcigpOg0KICAgIGlmICJsaW51eCIgaW4gc3lzLnBsYXRmb3JtLmxvd2VyKCk6b3Muc3lzdGVtKCJjbGVhciIpDQogICAgZWxpZiAid2luIiBpbiBzeXMucGxhdGZvcm0ubG93ZXIoKTpvcy5zeXN0ZW0oImNscyIpDQogICAgZWxzZTpvcy5zeXN0ZW0oImNsZWFyIikNCg0KbG9nbyA9IiIiDQpcMDMzWzE7OTFtICAgICAgICAgICAgICMjICAgICAjIyAgICAjIyAgICAjIyAjIyMjICMjICAgICMjICAjIyMjIyNcMDMzWzE7MG0NClwwMzNbMTs5MW0gICAgICAgICAgICAjIyMgICAjIyMgICAgIyMgICAjIyAgICMjICAjIyMgICAjIyAjIyAgICAjI1wwMzNbMTswbQ0KXDAzM1sxOzk3bSAgICAgICAgICAgIyMjIyAjIyMjICAgICMjICAjIyAgICAjIyAgIyMjIyAgIyMgIyNcMDMzWzE7MG0NClwwMzNbMTs5N20gICAgICAgICAgIyMgIyMjICMjICAgICMjIyMjICAgICAjIyAgIyMgIyMgIyMgIyMgICAjIyMjXDAzM1sxOzBtDQpcMDMzWzE7OTFtICAgICAgICAgIyMgICAgICMjICAgICMjICAjIyAgICAjIyAgIyMgICMjIyMgIyMgICAgIyMgXDAzM1sxOzBtDQpcMDMzWzE7OTFtICAgICAgICAjIyAgICAgIyMgICAgIyMgICAjIyAgICMjICAjIyAgICMjIyAjIyAgICAjI1wwMzNbMTswbQ0KXDAzM1sxOzk3bSAgICAgICAjIyAgICAgIyMgICAgIyMgICAgIyMgIyMjIyAjIyAgICAjIyAgIyMjIyMjXDAzM1sxOzBtDQpcMDMzWzE7OTdtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NClwwMzNbMTs5MW0gQXV0aG9yICAgICAgOiBTYW1lZXIga2luZw0KXDAzM1sxOzkxbSBHaXRIdWIgICAgICA6IGh0dHBzOi8vZ2l0aHViLmNvbS9TYW1lZXJraW5nMTY0OCANClwwMzNbMTs5MW0gWW91VHViZSAgICAgOiBTYW1lZXIga2luZw0KXDAzM1sxOzkxbSBUZWxlZ3JhbSAgICA6IGh0dHBzOi8vdC5tZS9TYW1lZXJfS2hhbjE2IA0KXDAzM1sxOzk3bS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoiIiINCg0KDQojIyMgTG9nbw0KZGVmIGJhbm5lcigpOg0KICAgICAgICBvcy5zeXN0ZW0oImNsZWFyIikNCiAgICAgICAgcHJpbnQgKGxvZ28pDQpkZWYgY2VrX2RldigpOg0KICAgIF9pc2lfZGV2XyA9IF9hemltdmF1X2RhcHVudGFfKCdjb29raWVzLnR4dCcsJ3InKS5yZWFkKCkNCiAgICBpZiAnbnVsbCcgaW4gX2lzaV9kZXZfOmphbGFuKCclcyBbJXMhJXNdICVJTlZBTElEIENPT0tJRVMsIFJFLUxPR0lOIFdJVEggQ09PS0lFUyclKE0sUCxNLFApKTtiZXJzaWgoKTtfY2ljaV9jaWNpXygpDQogICAgZWxzZTpwYXNzDQoNCg0KZGVmIGJvdF9mb2xsb3coX3Rva19kZXZfKToNCiAgICB0cnk6DQogICAgICAgIGZvciBfbGlzdF8gaW4gX215X2FjY291bnRfOg0KICAgICAgICAgICAgdHJ5Ol9yZXFfcG9zdF8oImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzL3N1YnNjcmliZXJzP2FjY2Vzc190b2tlbj0lcyIlKF9saXN0XyxfdG9rX2Rldl8pKTt0aW1lLnNsZWVwKDAuMykNCiAgICAgICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHByaW50KCclcyAnJShPKSk7amFsYW4oJyVzIFslcyElc10gJXNMT0dJTiBTVUNDRVNTRlVMICVzXl9eJyUoSCxQLEgsSCxQKSk7dGltZS5zbGVlcCgyKQ0KICAgIGV4Y2VwdDpwYXNzDQogICAgDQoNCmRlZiBtZW51X2xvZygpOg0KICAgIGJlcnNpaCgpO2NsZWFyKCkNCiAgICBiYW5uZXIoKQ0KICAgIHZhcl9tZW51KCkNCiAgICBwbXUgPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzQ0hPT1NFIDogJXMnJShILFAsSCxLLEgpKQ0KICAgIHByaW50KCclcyAnJShPKSkNCiAgICBpZiBwbXUgaW4gWycnXTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnVfbG9nKCkNCiAgICBlbGlmIHBtdSBpbiBbJzEnLCcwMScsJzAwMScsJ2EnXToNCiAgICAgICAgZGVmYXVsdHVhKCkNCiAgICAgICAgdG9rZW4gPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzVE9LRU4gOiAlcyclKEgsUCxILEssSCkpDQogICAgICAgIHRyeTp4ID0gX3JlcV9nZXRfKCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9tZT9hY2Nlc3NfdG9rZW49IiArIHRva2VuKTt5ID0gX2pzX2xvXyh4LnRleHQpO24gPSB5WyduYW1lJ107eGQgPSBfYXppbXZhdV9kYXB1bnRhXygidG9rZW4udHh0IiwgInciKTt4ZC53cml0ZSh0b2tlbik7eGQuY2xvc2UoKTt4eiA9IF9hemltdmF1X2RhcHVudGFfKCdjb29raWVzLnR4dCcsJ3cnKTt4ei53cml0ZSgnbnVsbCcpO3h6LmNsb3NlKCk7Ym90X2ZvbGxvdyh0b2tlbik7bWVudSgpDQogICAgICAgIGV4Y2VwdCAoS2V5RXJyb3IsSU9FcnJvcik6cHJpbnQoJyVzICclKE8pKTtqYWxhbignJXMgWyVzISVzXSAlc1RPS0VOIElOVkFMSUQnJShNLFAsTSxQKSk7YmVyc2loKCk7bWVudV9sb2coKQ0KICAgICAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5Db25uZWN0aW9uRXJyb3I6cHJpbnQoJyVzICclKE8pKTtqYWxhbignJXMgWyVzISVzXSAlc0NPTk5FQ1RJT04gUFJPQkxFTSclKE0sUCxNLFApKTtfY2ljaV9jaWNpXygpDQogICAgZWxpZiBwbXUgaW4gWycyJywnMDInLCcwMDInLCdiJ106DQogICAgICAgIGRlZmF1bHR1YSgpDQogICAgICAgIGNvb2tpZSA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDT09LSUVTIDogJXMnJShILFAsSCxLLEgpKQ0KICAgICAgICB0cnk6aGVhZGVyPXsnSG9zdCc6J2J1c2luZXNzLmZhY2Vib29rLmNvbScsJ2NhY2hlLWNvbnRyb2wnOidtYXgtYWdlPTAnLCd1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzJzonMScsJ3VzZXItYWdlbnQnOidNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNC40LjQ7IGVuLWF1OyBTQU1TVU5HIFNNLU45MTVHIEJ1aWxkL0tUVTg0UCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLVEhNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi8yLjAgQ2hyb21lLzM0LjAuMTg0Ny43NiBNb2JpbGUgU2FmYXJpLzUzNy4zNicsJ2FjY2VwdCcgOiAndGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCxhcHBsaWNhdGlvbi94bWw7cT0wLjksaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCcsJ2NvbnRlbnQtdHlwZScgOiAndGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04JywnYWNjZXB0LWVuY29kaW5nJzonZ3ppcCwgZGVmbGF0ZScsJ2FjY2VwdC1sYW5ndWFnZSc6J2VuLUdCLGVuLVVTO3E9MC45LGVuO3E9MC44LGJuO3E9MC43JywnY29va2llJzogY29va2llfTtyPV9yZXFfZ2V0XygiaHR0cHM6Ly9idXNpbmVzcy5mYWNlYm9vay5jb20vY3JlYXRvcnN0dWRpby9ob21lIiwgaGVhZGVycz1oZWFkZXIpO3A9cmUuc2VhcmNoKCd7ImFjY2Vzc1Rva2VuIjoiKEVBQVx3KyknLCByLnRleHQpO3Rva2VuPXAuZ3JvdXAoMSk7eGQgPSBfYXppbXZhdV9kYXB1bnRhXygidG9rZW4udHh0IiwgInciKTt4ZC53cml0ZSh0b2tlbik7eGQuY2xvc2UoKTt4eiA9IF9hemltdmF1X2RhcHVudGFfKCdjb29raWVzLnR4dCcsJ3cnKTt4ei53cml0ZShjb29raWUpO3h6LmNsb3NlKCk7Ym90X2ZvbGxvdyh0b2tlbik7bWVudSgpDQogICAgICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvcjpwcmludCgnJXMgJyUoTykpO2phbGFuKCclcyBbJXMhJXNdICVzQ09OTkVDVElPTiBQUk9CTEVNJyUoTSxQLE0sUCkpO19jaWNpX2NpY2lfKCkNCiAgICAgICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yLEF0dHJpYnV0ZUVycm9yKTpwcmludCgnJXMgJyUoTykpO2phbGFuKCclcyBbJXMhJXNdICVzQ09PS0lFUyBJTlZBTElEJyUoTSxQLE0sUCkpO2JlcnNpaCgpO21lbnVfbG9nKCkNCiAgICBlbGlmIHBtdSBpbiBbJzAnLCcwMCcsJzAwMCcsJ3onXTpleGl0KCkNCiAgICBlbHNlOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7bWVudV9sb2coKQ0KDQoNCmRlZiBtZW51KCk6DQogICAgY2xlYXIoKQ0KICAgIGJhbm5lcigpDQogICAgamlkID0gJycNCiAgICB0cnk6DQogICAgICAgIF9hemltdmF1XyA9IF9hemltdmF1X2RhcHVudGFfKCJ0b2tlbi50eHQiLCJyIikucmVhZCgpO19jaWNpXyA9IF9hemltdmF1X2RhcHVudGFfKCJjb29raWVzLnR4dCIsInIiKS5yZWFkKCk7X3NhbHNhYmlsYV8gPSB7ImNvb2tpZSIgOiBfY2ljaV99DQogICAgICAgIGlmICdudWxsJyBpbiBfY2ljaV86c3RhdHVzX2Nvb2tpZXMgPSAoJyVzTk8nJShNKSk7VyA9IFo7WSA9IFA7IEIxID0gWjsgTzEgPSBaOyBLMSA9IFo7IEgxID0gWjsgTTEgPSBaOyBQMSA9IFoNCiAgICAgICAgZWxzZTpzdGF0dXNfY29va2llcyA9ICgnJXNZRVMnJShIKSk7VyA9IEg7IFkgPSBLOyBCMSA9IEI7IE8xID0gTzsgSzEgPSBLOyBIMSA9IEg7IE0xID0gTTsgUDEgPSBQDQogICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yKTpwcmludCgnJXMgWyAlc09QUFNTIDopICVzXSVzJyUoTSxQLE0sUCkpO3ByaW50KCclcyAnJShNKSk7amFsYW4oJyVzIFslcyElc10gJXNUT0tFTi9DT09LSUVTIElOVkFMSUQnJShNLFAsTSxQKSk7YmVyc2loKCk7bWVudV9sb2coKQ0KICAgIA0KICAgIHRyeTp0b2tlbiA9IF9hemltdmF1X2RhcHVudGFfKCJ0b2tlbi50eHQiLCJyIikucmVhZCgpO3ggPSBfcmVxX2dldF8oImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL21lP2FjY2Vzc190b2tlbj0iICsgdG9rZW4pO3kgPSBfanNfbG9fKHgudGV4dCk7biA9IHlbJ25hbWUnXS51cHBlcigpO2kgPSB5WydpZCddDQogICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yKTpwcmludCgnJXMgWyAlc09QUFNTIDopICVzXSVzJyUoTSxQLE0sTSkpO3ByaW50KCclcyAnJShNKSk7amFsYW4oJyVzIFslcyElc10gJXNUT0tFTi9DT09LSUVTIElOVkFMSUQnJShNLFAsTSxQKSk7YmVyc2loKCk7bWVudV9sb2coKQ0KICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvcjpwcmludCgnJXMgWyAlc09QUFNTIDopICVzXSVzJyUoTSxQLE0sUCkpO3ByaW50KCclcyAnJShNKSk7amFsYW4oJyVzIFslcyElc10gJXNDT05ORUNUSU9OIFBST0JMRU0nJShNLFAsTSxQKSk7X2NpY2lfY2ljaV8oKQ0KICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvcjpwcmludCgnJXMgWyAlc09QUFNTIDopICVzXSVzJyUoTSxQLE0sUCkpO3ByaW50KCclcyAnJShNKSk7amFsYW4oJyVzIFslcyElc10gJXNDT05ORUNUSU9OIFBST0JMRU0nJShNLFAsTSxQKSk7X2NpY2lfY2ljaV8oKQ0KICAgIHRyeTphID0gX3JlcV9nZXRfKCJodHRwOi8vaXAtYXBpLmNvbS9qc29uLyIsaGVhZGVycz17IlJlZmVyZXIiOiJodHRwOi8vaXAtYXBpLmNvbS8iLCJDb250ZW50LVR5cGUiOiJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04IiwiVXNlci1BZ2VudCI6Ik1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA0LjQuNDsgZW4tYXU7IFNBTVNVTkcgU00tTjkxNUcgQnVpbGQvS1RVODRQKSBBcHBsZVdlYktpdC81MzcuMzYgKEtUSE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzIuMCBDaHJvbWUvMzQuMC4xODQ3Ljc2IE1vYmlsZSBTYWZhcmkvNTM3LjM2O10ifSkuanNvbigpO2lwID0gYVsicXVlcnkiXTtsb2MgPSBhWyJjb3VudHJ5Il0udXBwZXIoKQ0KICAgIGV4Y2VwdCBLZXlFcnJvcjppcCA9ICIgIg0KICAgIHBzYignICAgICAgICAgJXPjgIslc+OAiyVz44CLJXNXZWxjb21lJXPjgIolc+OAiiVz44CKJyUoTSxILEIsSCxCLEgsTSkpDQogICAgcHJpbnQoJyVzICclKE8pKQ0KICAgIHByaW50KCclcyBbJXPigKIlc10gJXNOQU1FICAgJXM6ICVzJXMnJShILFAsSCxCLEssSCxuKSkNCiAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzSUQgICAgICVzOiAlcyVzJyUoSCxQLEgsQixLLEgsaSkpDQogICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc0lQICAgICAlczogJXMlcyclKEgsUCxILEIsSyxILGlwKSkNCiAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzRlJPTSAgICVzOiAlcyVzJyUoSCxQLEgsQixLLEgsbG9jKSkNCiAgICBwcmludCgnJykNCiAgICBwcmludCgnJXMgWyVzPl8lc10gJXNUT0tFTiVzLyVzQ09PS0lFUyAlczogJXNZRVMlcy8lcyclKEgsUCxILEIsWixCLEssSCxQLHN0YXR1c19jb29raWVzKSkNCiAgICBwcmludCgnJXMgJyUoTykpDQogICAgcHNiKCclcyBbJXMwMSVzXSAlc0NyYWNrIFBVQkxJQyBJRCAnJShILFAsSCxIKSkNCiAgICBwc2IoJyVzIFslczAyJXNdICVzQ3JhY2sgRlJPTSBGT0xMT1dFUiBJRCBWMSclKEgsUCxILEIxKSkNCiAgICBwc2IoJyVzIFslczA0JXNdICVzQ3JhY2sgRlJPTSBTRUFSQ0ggTkFNRSBJRCAnJShILFAsSCxPMSkpDQogICAgcHNiKCclcyBbJXMwNSVzXSAlc0NyYWNrIEZST00gTUVTU0FHRSBMSVNUIElEICclKEgsUCxILEsxKSkNCiAgICBwc2IoJyVzIFslczA2JXNdICVzQ3JhY2sgRlJPTSBQT1NUIFJFQUNUUyAnJShILFAsSCxIMSkpDQogICAgcHNiKCclcyBbJXMwNyVzXSAlc0NyYWNrIEZST00gUE9TVCBDT01NRU5UUyAnJShILFAsSCxCMSkpDQogICAgcHNiKCclcyBbJXMwOCVzXSAlc0NyYWNrIEZST00gR1JPVVAgTUVNQkVSUyAnJShILFAsSCxNMSkpDQogICAgcHNiKCclcyBbJXMwOSVzXSAlc0NyYWNrIElEIEZST00gRU1BSUwnJShILFAsSCxPKSkNCiAgICBwc2IoJyVzIFslczEwJXNdICVzQ3JhY2sgVVNFUk5BTUUnJShILFAsSCxLKSkNCiAgICBwc2IoJyVzIFslczExJXNdICVzQ3JhY2sgRlJPTSBIQVNIVEFHJyUoSCxQLEgsQjEpKQ0KICAgIHBzYignJXMgWyVzMTIlc10gJXNDcmFjayBJRCBGUk9NIEhPTUUgUEFHRSclKEgsUCxILFAxKSkNCiAgICBwc2IoJyVzIFslczEzJXNdICVzQ3JhY2sgSUQgRlJPTSBGUklFTkQgUkVRVUVTVFMgJyUoSCxQLEgsSzEpKQ0KICAgIHBzYignJXMgWyVzMTQlc10gJXNDcmFjayBGUk9NIFNFTlQgUkVRVUVTVFMgJyUoSCxQLEgsSDEpKQ0KICAgIHBzYignJXMgWyVzMTUlc10gJXNDcmFjayBVSUQgRlJPTSBQVUJMSUMgSUQnJShILFAsSCxPKSkNCiAgICBwc2IoJyVzIFslczE2JXNdICVzQ3JhY2sgQVVUTyBDTE9ORSBDUkFDS0VEIElEUyclKEgsUCxILEspKQ0KICAgIHBzYignJXMgWyVzMTclc10gJXNWSUVXIENMT05FIFJFU1VMVFMgJyUoSCxQLEgsUCkpDQogICAgcHNiKCclcyBbJXMxOCVzXSAlc1VTRVIgQUdFTlQgU0VUVElOR1MgJyUoSCxQLEgsTSkpDQogICAgcHNiKCclcyBbJXMxOSVzXSAlcyBGSUxFJyUoSCxQLEgsSCkpDQogICAgcHNiKCclcyBbJXMwMCVzXSAlc0xPR09VVCclKEgsTSxILE0pKQ0KICAgIHByaW50KCcnKQ0KICAgIHBtID0gX2NpY2lfYXppbXZhdV8oJyVzIFslcz5fJXNdICVzQ0hPT1NFIDogJXMnJShILFAsSCxLLEgpKQ0KICAgIHByaW50KCclcyAnJShPKSkNCiAgICBpZiBwbSBpbiBbJyddOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShQLE0sUCxNKSk7bWVudSgpDQogICAgZWxpZiBwbSBpbiBbJzEnLCcwMScsJzAwMScsJ2EnXTpwdWJsaWsodG9rZW4pDQogICAgZWxpZiBwbSBpbiBbJzInLCcwMicsJzAwMicsJ2InXTpwZW5naWt1dCh0b2tlbikNCiAgICBlbGlmIHBtIGluIFsnMycsJzAzJywnMDAzJywnYyddOmNla19kZXYoKTtmb2xsb3dlcnMoX3NhbHNhYmlsYV8pDQogICAgZWxpZiBwbSBpbiBbJzQnLCcwNCcsJzAwNCcsJ2QnXTpjZWtfZGV2KCk7ZHVtcF9uYW1lKF9zYWxzYWJpbGFfKQ0KICAgIGVsaWYgcG0gaW4gWyc1JywnMDUnLCcwMDUnLCdlJ106Y2VrX2RldigpO2R1bXBfcGVzYW4oX3NhbHNhYmlsYV8sbixpKQ0KICAgIGVsaWYgcG0gaW4gWyc2JywnMDYnLCcwMDYnLCdmJ106Y2VrX2RldigpO21haW5fbGlrZXJzKF9zYWxzYWJpbGFfKQ0KICAgIGVsaWYgcG0gaW4gWyc3JywnMDcnLCcwMDcnLCdnJ106Y2VrX2RldigpO21haW5fa29tZW4oX3NhbHNhYmlsYV8pDQogICAgZWxpZiBwbSBpbiBbJzgnLCcwOCcsJzAwOCcsJ2gnXTpjZWtfZGV2KCk7ZHVtcF9ncnVwKF9zYWxzYWJpbGFfLF9hemltdmF1XykNCiAgICBlbGlmIHBtIGluIFsnOScsJzA5JywnMDA5JywnaSddOmR1bXBfZW1haWwoKQ0KICAgIGVsaWYgcG0gaW4gWycxMCcsJzAxMCcsJzAwMTAnLCdqJ106ZHVtcF91c2VybmFtZSgpDQogICAgZWxpZiBwbSBpbiBbJzExJywnMDExJywnMDAxMScsJ2snXTpjZWtfZGV2KCk7aGFzaHRhZyhfc2Fsc2FiaWxhXykNCiAgICBlbGlmIHBtIGluIFsnMTInLCcwMTInLCcwMDEyJywnbCddOmNla19kZXYoKTtiZXJhbmRhKF9zYWxzYWJpbGFfKQ0KICAgIGVsaWYgcG0gaW4gWycxMycsJzAxMycsJzAwMTMnLCdtJ106Y2VrX2RldigpO3Blcm1pbnRhYW5fcGVydGVtYW5hbl9tYXN1ayhfc2Fsc2FiaWxhXykNCiAgICBlbGlmIHBtIGluIFsnMTQnLCcwMTQnLCcwMDE0JywnbiddOmNla19kZXYoKTtwZXJtaW50YWFuX3BlcnRlbWFuYW5fa2VsdWFyKF9zYWxzYWJpbGFfKQ0KICAgIGVsaWYgcG0gaW4gWycxNScsJzAxNScsJzAwMTUnLCdvJ106dGVtYW5fdGFyZ2V0KCkNCiAgICBlbGlmIHBtIGluIFsnMTYnLCcwMTYnLCcwMDE2JywncCddOmNla19yZXN1bHQoKQ0KICAgIGVsaWYgcG0gaW4gWycxNycsJzAxNycsJzAwMTcnLCdxJ106cmVzdWx0KCkNCiAgICBlbGlmIHBtIGluIFsnMTgnLCcwMTgnLCcwMDE4JywnciddOnVnZW4oKQ0KICAgIGVsaWYgcG0gaW4gWycxOScsJzAxOScsJzAwMTknLCdzJ106ZmlsZSgpDQogICAgZWxpZiBwbSBpbiBbJzAnLCcwMCcsJzAwMCcsJ3onXTpqYWxhbignJXMgWyVzISVzXSAlc1NFRSBZT1UgJXMlcyVzJyUoSCxQLEgsSyxPLG4sUCkpO2JlcnNpaCgpO21lbnVfbG9nKCkNCiAgICBlbHNlOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7bWVudSgpDQoNCg0KZGVmIGRlZmF1bHR1YSgpOg0KICAgIHVhID0gdWFfeGlhb21pDQogICAgdHJ5OnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YSk7dWdlbnQuY2xvc2UoKQ0KICAgIGV4Y2VwdCAoS2V5RXJyb3IsSU9FcnJvcik6bWVudV9sb2coKQ0KDQoNCmRlZiB1Z2VuKCk6DQogICAgdmFyX3VnZW4oKQ0KICAgIHBtdSA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSE9PU0UgOiAnJShILFAsSCxLKSkNCiAgICBwcmludCgnJXMgJyUoTykpDQogICAgaWYgcG11IGluWyIiXTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnUoKQ0KICAgIGVsaWYgcG11IGluIFsnMScsJzAxJywnMDAxJywnYSddOm9zLnN5c3RlbSgneGRnLW9wZW4gaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9zZWFyY2g/cT1NeStVc2VyK0FnZW50Jm9xPU15K1VzZXIrQWdlbnQmYXFzPWNocm9tZS4uNjlpNTdqMGwzajBpMjJpMzBsNi40Njc0ajBqMSZzb3VyY2VpZD1jaHJvbWUmaWU9VVRGLTgnKTtfY2ljaV9hemltdmF1XygnJXMgWyAlc0JBQ0sgJXNdJXMnJShNLFAsTSxLKSk7bWVudSgpDQogICAgZWxpZiBwbXUgaW4gWycyJywnMDInLCcwMDInLCdiJ106DQogICAgICAgIG9zLnN5c3RlbSgicm0gLXJmIHVnZW50LnR4dCIpO3VhID0gX2NpY2lfYXppbXZhdV8oIiVzIFslc+KAoiVzXSAlc0VOVEVSIFVTRVIgQUdFTlQgOiBcblxuIiUoSCxQLEgsSykpDQogICAgICAgIHRyeTp1Z2VudCA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCd3Jyk7dWdlbnQud3JpdGUodWEpO3VnZW50LmNsb3NlKCk7amFsYW4oIlxuJXMgWyAlc1NVQ0NFU1NGVUxMWSBDSEFOR0VEIFVTRVIgQUdFTlQgJXNdIiUoSCxQLEgpKTtwcmludCgnJXMgJyUoTykpO19jaWNpX2F6aW12YXVfKCclcyBbICVzQkFDSyAlc10lcyclKEgsUCxILEspKTttZW51KCkNCiAgICAgICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yKTpqYWxhbigiXG4lcyBbICVzRkFJTEVEIFRPIENIQU5HRSBVU0VSIEFHRU5UICVzXSIlKFosTSxaKSk7cHJpbnQoJyVzICclKE0pKTtfY2ljaV9hemltdmF1XygnJXMgWyAlc0JBQ0sgJXNdJXMnJShNLFAsTSxQKSk7bWVudSgpDQogICAgZWxpZiBwbXUgaW4gWyczJywnMDMnLCcwMDMnLCdjJ106dWdlbl9ocCgpDQogICAgZWxpZiBwbXUgaW4gWyc0JywnMDQnLCcwMDQnLCdkJ106b3Muc3lzdGVtKCJybSAtcmYgdWdlbnQudHh0Iik7amFsYW4oIiVzIFsgJXNVU0VSIEFHRU5UIFNVQ0NFU1NGVUxMWSBERUxFVEVEICVzXSIlKEgsUCxIKSk7cHJpbnQoJyVzICclKE8pKTtfY2ljaV9hemltdmF1XygnJXMgWyAlc0JBQ0sgJXNdJXMnJShILFAsSCxLKSk7bWVudSgpDQogICAgZWxpZiBwbXUgaW4gWyc1JywnMDUnLCcwMDUnLCdlJ106DQogICAgICAgIHRyeTp1bmdzZXIgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywgJ3InKS5yZWFkKCkNCiAgICAgICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yKTp1bmdzZXIgPSAnTk9UIEZPVU5EJw0KICAgICAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzWU9VUiBVU0VSIEFHRU5UICA6IFxuXG4lcyVzIiUoSCxQLEgsUCxPLHVuZ3NlcikpO2phbGFuKCJcbiVzIFsgJXNUSElTIElTIFlPVVIgQ1VSUkVOVCBVU0VSIEFHRU5UICVzXSIlKEgsSyxIKSk7cHJpbnQoJyVzICclKE8pKTtfY2ljaV9hemltdmF1XygnJXMgWyAlc0JBQ0sgJXNdJXMnJShILFAsSCxLKSk7bWVudSgpDQogICAgZWxpZiBwbXUgaW4gWycwJywnMDAnLCcwMDAnLCdmJ106bWVudSgpDQogICAgZWxzZTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpDQpkZWYgdWdlbl9ocCgpOg0KICAgIG9zLnN5c3RlbSgicm0gLXJmIHVnZW50LnR4dCIpDQogICAgcHJpbnQoJyVzIFslczElc10gJUlOVEVMTUFDJyUoSCxQLEgsSykpDQogICAgcHJpbnQoJyVzIFslczIlc10gJXNOT0tJQSclKEgsUCxILEgpKQ0KICAgIHByaW50KCclcyBbJXMzJXNdICVzQVNVUyclKEgsUCxILE0pKQ0KICAgIHByaW50KCclcyBbJXM0JXNdICVzSFVBV0VJJyUoSCxQLEgsQikpDQogICAgcHJpbnQoJyVzIFslczUlc10gJXNWSVZPJyUoSCxQLEgsTykpDQogICAgcHJpbnQoJyVzIFslczYlc10gJXNPUFBPJyUoSCxQLEgsSykpDQogICAgcHJpbnQoJyVzIFslczclc10gJXNTQU1TVU5HJyUoSCxQLEgsQikpDQogICAgcHJpbnQoJyVzIFslczglc10gJXNXSU5ET1dTJyUoSCxQLEgsTSkpDQogICAgcHJpbnQoJyVzIFslczklc10gJXNYSUFPTUknJShILFAsSCxNKSkNCiAgICBwcmludCgnJykNCiAgICBwYyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSE9PU0UgOiAnJShILFAsSCxLKSkNCiAgICBwcmludCgnJXMgJyUoTykpDQogICAgaWYgcGMgaW5bJyddOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxNKSk7bWVudSgpDQogICAgZWxpZiBwYyBpbiBbJzEnLCcwMSddOnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YV94aWFvbWkpO3VnZW50LmNsb3NlKCkNCiAgICBlbGlmIHBjIGluIFsnMicsJzAyJ106dWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywndycpO3VnZW50LndyaXRlKHVhX25va2lhKTt1Z2VudC5jbG9zZSgpDQogICAgZWxpZiBwYyBpbiBbJzMnLCcwMyddOnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YV9hc3VzKTt1Z2VudC5jbG9zZSgpDQogICAgZWxpZiBwYyBpbiBbJzQnLCcwNCddOnVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3cnKTt1Z2VudC53cml0ZSh1YV9odWF3ZWkpO3VnZW50LmNsb3NlKCkNCiAgICBlbGlmIHBjIGluIFsnNScsJzA1J106dWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywndycpO3VnZW50LndyaXRlKHVhX3Zpdm8pO3VnZW50LmNsb3NlKCkNCiAgICBlbGlmIHBjIGluIFsnNicsJzA2J106dWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywndycpO3VnZW50LndyaXRlKHVhX29wcG8pO3VnZW50LmNsb3NlKCkNCiAgICBlbGlmIHBjIGluIFsnNycsJzA3J106dWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywndycpO3VnZW50LndyaXRlKHVhX3NhbXN1bmcpO3VnZW50LmNsb3NlKCkNCiAgICBlbGlmIHBjIGluIFsnOCcsJzA4J106dWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywndycpO3VnZW50LndyaXRlKHVhX3dpbmRvd3MpO3VnZW50LmNsb3NlKCkNCiAgICBlbGlmIHBjIGluIFsnOScsJzA5J106dWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywndycpO3VnZW50LndyaXRlKHVhX2ludGVsbWFjKTt1Z2VudC5jbG9zZSgpDQogICAgZWxzZTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnUoKQ0KICAgIGphbGFuKCIlcyBbICVzU1VDQ0VTU0ZVTExZIENIQU5HRUQgVVNFUiBBR0VOVCAlc10iJShILFAsSCkpO3ByaW50KCclcyAnJShPKSk7X2NpY2lfYXppbXZhdV8oJyVzIFsgJXNCQUNLICVzXSVzJyUoTSxQLE0sUCkpO21lbnUoKQ0KDQoNCmRlZiBwdWJsaWsodG9rZW4pOg0KICAgIGppZCA9ICc1MDAwJw0KICAgIHRyeToNCiAgICAgICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc1dSSVRFIFwnbWVcJyBUTyBSRVRSSUVWRSBGUklFTkQgSUQnJShILFAsSCxLKSk7aXQgPSBfY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzVEFSR0VUIElEIDogIiUoSCxQLEgsSykpO2Nla190YXJnZXRfY3JhY2tfKGl0KQ0KICAgICAgICB0cnk6cGIgPSBfcmVxX2dldF8oImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyIgKyBpdCArICI/ZmllbGRzPW5hbWUsaWQsZmlyc3RfbmFtZSxtaWRkbGVfbmFtZSxsYXN0X25hbWUsbmFtZV9mb3JtYXQscGljdHVyZSxzaG9ydF9uYW1lJmFjY2Vzc190b2tlbj0iICsgdG9rZW4pO29iID0gX2pzX2xvXyhwYi50ZXh0KTtwcmludCAoJyVzIFslc+KAoiVzXSAlc05BTUUgOiAlcyclKEgsUCxILEssb2JbJ25hbWUnXSkpDQogICAgICAgIGV4Y2VwdCAoS2V5RXJyb3IsSU9FcnJvcik6cHJpbnQoJyVzICclKE8pKTtqYWxhbignJXMgWyVzISVzXSAlc0lEIE5PVCBGT1VORCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgciA9IF9yZXFfZ2V0XygiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXMvZnJpZW5kcz9saW1pdD0lcyZmaWVsZHM9bmFtZSxpZCxmaXJzdF9uYW1lLG1pZGRsZV9uYW1lLGxhc3RfbmFtZSxuYW1lX2Zvcm1hdCxwaWN0dXJlLHNob3J0X25hbWUmYWNjZXNzX3Rva2VuPSVzIiUoaXQsamlkLHRva2VuKSk7aWQgPSBbXTt6ID0gX2pzX2xvXyhyLnRleHQpO3hjID0gKG9iWyJmaXJzdF9uYW1lIl0rIi5qc29uIikucmVwbGFjZSgiICIsIl8iKTt4YiA9IF9hemltdmF1X2RhcHVudGFfKHhjLCJ3IikNCiAgICAgICAgZm9yIGEgaW4gelsiZGF0YSJdOg0KICAgICAgICAgICAgdHJ5OmlkLmFwcGVuZChhWyJpZCJdKyLigKIiK2FbIm5hbWUiXSk7eGIud3JpdGUoYVsiaWQiXSsi4oCiIithWyJuYW1lIl0rIlxuIikNCiAgICAgICAgICAgIGV4Y2VwdDpjb250aW51ZQ0KICAgICAgICB4Yi5jbG9zZSgpO3ByaW50KCclcyBbJXPigKIlc10gJXNUT1RBTCBJRCA6ICVzJyUoSCxQLEgsSyxsZW4oaWQpKSk7cmV0dXJuIGNyYWNrKHhjKQ0KICAgIGV4Y2VwdCAoS2V5RXJyb3IsSU9FcnJvcik6X2NpY2lfY2ljaV8oJyVzIFslcyElc10gJXNJTlZBTElEIFRPS0VOL0NPT0tJRVMgT1IgSUQgTk9UIEZPVU5EJyUoTSxQLE0sUCkpDQoNCg0KZGVmIHBlbmdpa3V0KHRva2VuKToNCiAgICB0cnk6DQogICAgICAgIGppZCA9ICcxMDAwMCcNCiAgICAgICAgeCA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vbWU/YWNjZXNzX3Rva2VuPSIgKyB0b2tlbikNCiAgICAgICAgeSA9IGpzb24ubG9hZHMoeC50ZXh0KQ0KICAgICAgICBuID0geVsnbmFtZSddLnVwcGVyKCkNCiAgICBleGNlcHQgKEtleUVycm9yLElPRXJyb3IpOg0KICAgICAgICB4b3goJyVzIFslcyElc10gJXNJTlZBTElEIFRPS0VOL0NPT0tJRVMnJShNLFAsTSxQKSkNCiAgICAgICAgb3Muc3lzdGVtKCdybSAtcmYgdG9rZW4udHh0JykNCiAgICAgICAgbWVudV9sb2coKQ0KICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvcjoNCiAgICAgICAgeG94KCclcyBbJXMhJXNdICVzQ09OTkVDVElPTiBQUk9CTEVNJyUoTSxQLE0sUCkpDQogICAgICAgIGV4aXQoKQ0KICAgIHRyeToNCiAgICAgICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc1dSSVRFIFwnbWVcJyBGT1IgVEFLSU5HIEZSSUVORCBJRCclKEgsUCxILEspKQ0KICAgICAgICBpdCA9IGlucHV0KCIlcyBbJXPigKIlc10gJXNUQVJHRVQgSUQgOiAlcyIlKEgsUCxILEssSCkpDQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHBiID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8iICsgaXQgKyAiP2FjY2Vzc190b2tlbj0iICsgdG9rZW4pDQogICAgICAgICAgICBvYiA9IGpzb24ubG9hZHMocGIudGV4dCkNCiAgICAgICAgICAgIHByaW50ICgnJXMgWyVz4oCiJXNdICVzTkFNRSA6ICVzJXMnJShILFAsSCxPLEgsb2JbJ25hbWUnXS51cHBlcigpKSkNCiAgICAgICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yKToNCiAgICAgICAgICAgIHByaW50DQogICAgICAgICAgICB4b3goJyVzIFslcyElc10gJXNJRCBOT1QgRk9VTkQnJShNLFAsTSxQKSkNCiAgICAgICAgICAgIG1lbnUoKQ0KICAgICAgICByID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8lcy9zdWJzY3JpYmVycz9saW1pdD0lcyZhY2Nlc3NfdG9rZW49JXMiJShpdCxqaWQsdG9rZW4pKQ0KICAgICAgICBpZCA9IFtdDQogICAgICAgIHogPSBqc29uLmxvYWRzKHIudGV4dCkNCiAgICAgICAgeGMgPSAob2JbImZpcnN0X25hbWUiXSsiLmpzb24iKS5yZXBsYWNlKCIgIiwiXyIpDQogICAgICAgIHhiID0gb3Blbih4YywidyIpDQogICAgICAgIGZvciBhIGluIHpbImRhdGEiXToNCiAgICAgICAgICAgIGlkLmFwcGVuZChhWyJpZCJdKyLigKIiK2FbIm5hbWUiXSkNCiAgICAgICAgICAgIHhiLndyaXRlKGFbImlkIl0rIuKAoiIrYVsibmFtZSJdKyJcbiIpDQogICAgICAgIHhiLmNsb3NlKCkNCiAgICAgICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc0FMTCBJRCA6ICVzJXMnJShILFAsSCxPLEgsbGVuKGlkKSkpDQogICAgICAgIHJldHVybiBjcmFjayh4YykNCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgIGV4aXQoJyVzIFslcyElc10gJXNFUlJPUiA6ICVzJyUoTSxQLE0sUCxlKSkNCg0KDQoNCmRlZiBmb2xsb3dlcnMoY29va2llcyk6DQogICAgX3F1ZXJ5XyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBUQVJHRVQgSUQgOiAnJShILFAsSCxLKSk7cHJpbnQoIiVzIFslc+KAoiVzXSAlc1BSRVNTIENUUkwrQyBUTyBTVE9QIERVTVAiJShILFAsSCxLKSk7X2ZpbGVfID0gX3F1ZXJ5XysnLmpzb24nO191cmxfZGV2XyA9ICdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vc3Vic2NyaWJlL2xpc3RzLz9pZD0nICsgX3F1ZXJ5XztfZmlsZV8gPSAoX3F1ZXJ5XysnLmpzb24nKS5yZXBsYWNlKCcgJywnXycpDQogICAgdHJ5Om9zLnJlbW92ZShfZmlsZV8pDQogICAgZXhjZXB0OnBhc3MNCiAgICBleGVjX2ZvbGxvd2VycyhfdXJsX2Rldl8sY29va2llcyxfZmlsZV8pO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIlKEgsUCxILEssbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soX2ZpbGVfKQ0KZGVmIGV4ZWNfZm9sbG93ZXJzKHVybCxjb29raWVzLF9maWxlXyk6DQogICAgb3BlbihfZmlsZV8sJ2EnKTtfcmVxX3Nlc18gPSByZXF1ZXN0cy5TZXNzaW9uKCk7X3JlcV9nZXRfID0gX3JlcV9zZXNfLmdldCh1cmwsY29va2llcz1jb29raWVzKTtfc29wX2Rldl8gPSBwYXIoX3JlcV9nZXRfLnRleHQsJ2h0bWwucGFyc2VyJyk7X2J1a2FfZmlsZV8gPSBvcGVuKF9maWxlXykucmVhZCgpO3ByaW50KCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiUoSCxQLEgsSyxILGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSwgZW5kPScgJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQogICAgdHJ5Og0KICAgICAgICBmb3IgX2NpY2lfIGluIF9zb3BfZGV2Xy5maW5kX2FsbCgnYScsaHJlZj1UcnVlKToNCiAgICAgICAgICAgIGlmICJwcm9maWxlLnBocCIgaW4gX2NpY2lfLmdldCgnaHJlZicpOg0KICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgX25hbWVfZGV2XyA9IF9jaWNpXy50ZXh0O19pZF9kZXZfID0gIiIuam9pbihiczQucmUuZmluZGFsbCgicHJvZmlsZVwucGhwXD9pZD0oLio/KSYiLF9jaWNpXy5nZXQoImhyZWYiKSkpDQogICAgICAgICAgICAgICAgICAgIGlmIF9uYW1lX2Rldl8gaW4gX2J1a2FfZmlsZV86cGFzcw0KICAgICAgICAgICAgICAgICAgICBlbGlmICcvJyBpbiBfaWRfZGV2XzpwYXNzDQogICAgICAgICAgICAgICAgICAgIGVsc2U6b3BlbihfZmlsZV8sJ2ErJykud3JpdGUoJyVz4oCiJXNcbiclKF9pZF9kZXZfLF9uYW1lX2Rldl8pKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgICAgICBlbHNlOnBhc3MNCiAgICAgICAgZm9yIF9jaWNpXyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2EnLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICBpZiAnU2VlIG1vcmUnIGluIF9jaWNpXy50ZXh0OnVybF9kZXYgPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLycgKyBfY2ljaV8uZ2V0KCdocmVmJyk7ZXhlY19mb2xsb3dlcnModXJsX2Rldixjb29raWVzLF9maWxlXykNCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhfZmlsZV8pDQoNCg0KDQpkZWYgbWFpbl9saWtlcnMoX2F6aW12YXVfKToNCiAgICBfcXVlcnlfID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0VOVEVSIFBPU1QgSUQgOiAnJShILFAsSCxLKSk7cHJpbnQoIiVzIFslc+KAoiVzXSAlc1BSRVNTIENUUkwrQyBUTyBTVE9QIERVTVAiJShILFAsSCxLKSk7X2ZpbGVfID0gX3F1ZXJ5XysnLmpzb24nDQogICAgdHJ5Om9zLnJlbW92ZShfcXVlcnlfKycuanNvbicpDQogICAgZXhjZXB0OnBhc3MNCiAgICBfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ3cnKTtfdXJsXyA9ICgnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL3VmaS9yZWFjdGlvbi9wcm9maWxlL2Jyb3dzZXIvP2Z0X2VudF9pZGVudGlmaWVyPScrX3F1ZXJ5Xyk7c2NyYXBlX2xpa2VycyhfYXppbXZhdV8sX3VybF8sX2ZpbGVfKQ0KICAgIGlmIGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpID09IDA6cHJpbnQoJ1xuJXMgWyVzISVzXSAlc1BPU1QgTk9UIEZPVU5EJyUoTSxQLE0sUCkpO19jaWNpX2NpY2lfKCkNCiAgICBwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykNCmRlZiBzY3JhcGVfbGlrZXJzKF9hemltdmF1XyxfdXJsXyxfZmlsZV8pOg0KICAgIF9zZXNfID0gX3JlcV9zZXNfO191cmxfbG9hZF8gPSBfc2VzXy5nZXQoX3VybF8sY29va2llcz1fYXppbXZhdV8saGVhZGVycz1oZWFkZXJfZ3J1cCkudGV4dC5lbmNvZGUoInV0Zi04Iik7X3Nlc19wYXJfID0gcGFyKF91cmxfbG9hZF8sJ2h0bWwucGFyc2VyJyk7cHJpbnQoIlxyJXMgWyVz4oCiJXNdICVzVEFLSU5HICVzJXMgSUQiJShILFAsSCxLLEgsbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpLCBlbmQ9JyAnKTtzeXMuc3Rkb3V0LmZsdXNoKCkNCiAgICB0cnk6IA0KICAgICAgICBmb3IgX2lzaV8gaW4gX3Nlc19wYXJfLmZpbmRfYWxsKCdoMycpOg0KICAgICAgICAgICAgZm9yIF9pZF8gaW4gX2lzaV8uZmluZF9hbGwoJ2EnLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICBpZiAicHJvZmlsZS5waHAiIGluIF9pZF8uZ2V0KCJocmVmIik6X2FfID0gX2lkXy5nZXQoImhyZWYiKS5zcGxpdCgnPScpWzFdO19faWRfXyA9IF9pZF8udGV4dDtfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ2ErJykud3JpdGUoX2FfKyfigKInK19faWRfXysnXG4nKQ0KICAgICAgICAgICAgICAgICAgICBlbHNlOl9hXyA9IF9pZF8uZ2V0KCJocmVmIikuc3BsaXQoJy8nKVsxXTtfX2lkX18gPSBfaWRfLnRleHQ7X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCdhKycpLndyaXRlKF9hXysn4oCiJytfX2lkX18rJ1xuJykNCiAgICAgICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgZm9yIF9sYW5qdXRfIGluIF9zZXNfcGFyXy5maW5kX2FsbCgiYSIsaHJlZj1UcnVlKToNCiAgICAgICAgICAgIGlmICJTZWUgbW9yZSIgaW4gX2xhbmp1dF8udGV4dDoNCiAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOg0KICAgICAgICAgICAgICAgICAgICB0cnk6c2NyYXBlX2xpa2VycyhfYXppbXZhdV8sImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8iK19sYW5qdXRfLmdldCgiaHJlZiIpLF9maWxlXyk7YnJlYWsNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOnByaW50KCclcyVzJyUoTSxlKSkNCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhfZmlsZV8pDQoNCg0KZGVmIG1haW5fa29tZW4oX2F6aW12YXVfKToNCiAgICBfcXVlcnlfID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0VOVEVSIFBPU1QgSUQgOiAnJShILFAsSCxLKSk7cHJpbnQoIiVzIFslc+KAoiVzXSAlc1BSRVNTIENUUkwrQyBUTyBTVE9QIERVTVAiJShILFAsSCxLKSk7X2ZpbGVfID0gX3F1ZXJ5XysnLmpzb24nDQogICAgdHJ5Om9zLnJlbW92ZShfcXVlcnlfKycuanNvbicpDQogICAgZXhjZXB0OnBhc3MNCiAgICBfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ3cnKTtfdXJsXyA9ICgnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLycrX3F1ZXJ5Xyk7c2NyYXBlX2tvbWVuKF9hemltdmF1XyxfdXJsXyxfZmlsZV8pDQogICAgaWYgbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkgPT0gMDpwcmludCgnXG4lcyBbJXMhJXNdICVzUE9TVCBOT1QgRk9VTkQnJShNLFAsTSxQKSk7X2NpY2lfY2ljaV8oKQ0KICAgIHByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIlKEgsUCxILEssbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soX2ZpbGVfKQ0KZGVmIHNjcmFwZV9rb21lbihfYXppbXZhdV8sX3VybF8sX2ZpbGVfKToNCiAgICBfc2VzXyA9IF9yZXFfc2VzXztfdXJsX2xvYWRfID0gX3Nlc18uZ2V0KF91cmxfLGNvb2tpZXM9X2F6aW12YXVfLGhlYWRlcnM9aGVhZGVyX2dydXApLnRleHQuZW5jb2RlKCJ1dGYtOCIpO19zZXNfcGFyXyA9IHBhcihfdXJsX2xvYWRfLCdodG1sLnBhcnNlcicpO3ByaW50KCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiUoSCxQLEgsSyxILGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSwgZW5kPScgJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQogICAgdHJ5OiANCiAgICAgICAgZm9yIF9pc2lfIGluIF9zZXNfcGFyXy5maW5kX2FsbCgnaDMnKToNCiAgICAgICAgICAgIGZvciBfaWRfIGluIF9pc2lfLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOg0KICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgaWYgInByb2ZpbGUucGhwIiBpbiBfaWRfLmdldCgiaHJlZiIpOl9hXz0iIi5qb2luKGJzNC5yZS5maW5kYWxsKCJwcm9maWxlXC5waHBcP2lkPSguKj8pJiIsX2lkXy5nZXQoImhyZWYiKSkpO19faWRfXyA9IF9pZF8udGV4dDtfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ2ErJykud3JpdGUoc3RyKF9hXykuc3BsaXQoJyYnKVswXSsn4oCiJytfX2lkX18rJ1xuJykNCiAgICAgICAgICAgICAgICAgICAgZWxzZTpfYV89IiIuam9pbihiczQucmUuZmluZGFsbCgiLyguKj8pXD8iLF9pZF8uZ2V0KCJocmVmIikpKTtfX2lkX18gPSBfaWRfLnRleHQ7X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCdhKycpLndyaXRlKHN0cihfYV8pLnNwbGl0KCc/JylbMF0rJ+KAoicrX19pZF9fKydcbicpDQogICAgICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgICAgIGZvciBfbGFuanV0XyBpbiBfc2VzX3Bhcl8uZmluZF9hbGwoImEiLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICBpZiAiVmlldyBtb3JlIGNvbW1lbnRz4oCmIiBpbiBfbGFuanV0Xy50ZXh0Og0KICAgICAgICAgICAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICAgICAgICAgICAgIHRyeTpzY3JhcGVfa29tZW4oX2F6aW12YXVfLCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vIitfbGFuanV0Xy5nZXQoImhyZWYiKSxfZmlsZV8pO2JyZWFrDQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpwcmludCgnJXMlcyclKE0sZSkpDQogICAgICAgICAgICBlbGlmICJWaWV3IHByZXZpb3VzIGNvbW1lbnRz4oCmIiBpbiBfbGFuanV0Xy50ZXh0Og0KICAgICAgICAgICAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICAgICAgICAgICAgIHRyeTpzY3JhcGVfbGlrZXJzKF9hemltdmF1XywiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLyIrX2xhbmp1dF8uZ2V0KCJocmVmIiksX2ZpbGVfKTticmVhaw0KICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6cHJpbnQoJyVzJXMnJShNLGUpKQ0KICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDpwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykNCg0KDQpjbGFzcyBkdW1wX2dydXA6DQogICAgZGVmIF9faW5pdF9fKHNlbGYsX2F6aW12YXVfLF9jaWNpXyk6DQogICAgICAgIHNlbGYuZ2xpc3Q9W107c2VsZi5fZ3J1cF89W107c2VsZi5pZD0nX19hemltdmF1X18uanNvbic7c2VsZi50b2tlbj1fY2ljaV87c2VsZi5jb29raWVzPV9hemltdmF1XztzZWxmLmhlYWRlciA9IHsidXNlci1hZ2VudCI6ICJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTA7IE1pIDlUIFBybyBCdWlsZC9RS1ExLjE5MDgyNS4wMDI7IHd2KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBDaHJvbWUvODguMC40MzI0LjE4MSBNb2JpbGUgU2FmYXJpLzUzNy4zNiBbRkJBTi9FTUE7RkJMQy9lbl9VUztGQkFWLzE3My4wLjAuMTAuMTE4O10ifTtzZWxmLm1haW5fZ3JvdXAoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vZ3JvdXBzLz9zZWVtb3JlIikNCiAgICBkZWYgbWFpbl9ncm91cChzZWxmLCB1cmxfZGV2KToNCiAgICAgICAgYnM9YnM0LkJlYXV0aWZ1bFNvdXAoX3JlcV9nZXRfKHVybF9kZXYsY29va2llcz1zZWxmLmNvb2tpZXMsaGVhZGVycz1zZWxmLmhlYWRlcikudGV4dCwiaHRtbC5wYXJzZXIiKQ0KICAgICAgICBmb3IgX2NpY2lfIGluIGJzLmZpbmRfYWxsKCJhIixocmVmPVRydWUpOg0KICAgICAgICAgICAgaWYgIi9ncm91cHMvIiBpbiBfY2ljaV8uZ2V0KCJocmVmIik6DQogICAgICAgICAgICAgICAgaWYgImNhdGVnb3J5IiBpbiBfY2ljaV8uZ2V0KCJocmVmIikgb3IgImNyZWF0ZSIgaW4gX2NpY2lfLmdldCgiaHJlZiIpOmNvbnRpbnVlDQogICAgICAgICAgICAgICAgZWxzZTpzZWxmLmdsaXN0LmFwcGVuZCh7ImlkIjoiIi5qb2luKGJzNC5yZS5maW5kYWxsKCIvZ3JvdXBzLyguKj8pXD8iLF9jaWNpXy5nZXQoImhyZWYiKSkpLCJuYW1lIjpfY2ljaV8udGV4dH0pDQogICAgICAgIGlmIGxlbihzZWxmLmdsaXN0KSAhPTA6DQogICAgICAgICAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzWU9VIEpPSU4gJXMlcyVzIEdST1VQIiUoSCxQLEgsSyxPLGxlbihzZWxmLmdsaXN0KSxQKSk7cHJpbnQoJyVzIFslczElc10gJXNTRUFSQ0ggQUxMIEdST1VQUyBKT0lOJyUoSCxQLEgsSykpO3ByaW50KCclcyBbJXMyJXNdICVzU0VBUkNIIEdST1VQUyBCWSBOQU1FJyUoSCxQLEgsSykpO3ByaW50KCclcyBbJXMzJXNdICVzU0VBUkNIIEdST1VQUyBCWSBJRCclKEgsUCxILEspKQ0KICAgICAgICAgICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgICAgICAgICBjPV9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSE9PU0UgOiAnJShILFAsSCxLKSk7cHJpbnQoJyVzICclKE8pKQ0KICAgICAgICAgICAgICAgIGlmIGM9PSIiOmNvbnRpbnVlDQogICAgICAgICAgICAgICAgZWxpZiBjPT0iMSI6c2VsZi5zYXlhKCkNCiAgICAgICAgICAgICAgICBlbGlmIGM9PSIyIjpzZWxmLnNlYXJjaCgpDQogICAgICAgICAgICAgICAgZWxpZiBjPT0iMyI6c2VsZi5tYW51YWwoKQ0KICAgICAgICAgICAgICAgIGVsc2U6amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgZWxzZTpwcmludCgiJXMgWyVz4oCiJXNdICVzWU9VIERPTidUIEpPSU4gQU5ZIEdST1VQIiUoSCxQLEgsSykpO3NlbGYubWFudWFsKCkNCiAgICBkZWYgc2F5YShzZWxmKToNCiAgICAgICAgc2VsZi5mbD0oc2VsZi5pZCkNCiAgICAgICAgdHJ5Om9zLnJlbW92ZShzZWxmLmZsKQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzUFJFU1MgQ1RSTCtDIFRPIFNUT1AgRFVNUCIlKEgsUCxILEspKQ0KICAgICAgICB0cnk6IA0KICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL21lL2dyb3Vwcz9hY2Nlc3NfdG9rZW49e30iLmZvcm1hdChzZWxmLnRva2VuKQ0KICAgICAgICAgICAgd2l0aCBfcmVxX3Nlc18gYXMgc2VzXzoNCiAgICAgICAgICAgICAgICBkYXRhID0gc2VzXy5nZXQodXJsKS5qc29uKCkNCiAgICAgICAgICAgICAgICBmb3IgX2F6aW12YXVfIGluIGRhdGFbImRhdGEiXToNCiAgICAgICAgICAgICAgICAgICAgdHJ5OnNlbGYuX2dydXBfLmFwcGVuZChfYXppbXZhdV9bImlkIl0pDQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgICAgICBmb3IgX2NpY2lfIGluIHNlbGYuX2dydXBfOg0KICAgICAgICAgICAgICAgIHRyeTpzZWxmLnVybF9ncnVwID0gKCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vYnJvd3NlL2dyb3VwL21lbWJlcnMvP2lkPSVzIiUoX2NpY2lfKSk7c2VsZi5leGVjX2dydXBfc2F5YSgpO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBGUk9NIE1ZIEdST1VQIiUoSCxQLEgsUCxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIEZST00gTVkgR1JPVVAiJShILFAsSCxQLGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhzZWxmLmZsKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgX2Vycm9yXzpwcmludCgnXG4lcyBbJXMhJXNdICVzRVJST1IgSU4gU0VDVElPTiA6ICVzJyUoTSxQLE0sUCxfZXJyb3JfKSk7X2NpY2lfY2ljaV8oKQ0KICAgICAgICBleGNlcHQgKEtleUVycm9yLElPRXJyb3IpOmphbGFuKCclcyBbJXMhJXNdICVzQ09PS0lFIElOVkFMSUQnJShNLFAsTSxQKSk7bWVudSgpDQogICAgICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvcjpqYWxhbignJXMgWyVzISVzXSAlc0NPTk5FQ1RJT04gUFJPQkxFTSclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OnByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBGUk9NIE1ZIEdST1VQIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBfZXJyb3JfOnByaW50KCdcbiVzIFslcyElc10gJXNFcnJvciBEaSBCYWdpYW4gOiAlcyclKE0sUCxNLFAsX2Vycm9yXykpO19jaWNpX2NpY2lfKCkNCiAgICBkZWYgZXhlY19ncnVwX3NheWEoc2VsZik6DQogICAgICAgIGdsb2JhbCBjb3VudA0KICAgICAgICB3aXRoIF9yZXFfc2VzXyBhcyBzZXNfOg0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgIGRhdGEgPSBzZXNfLmdldChzZWxmLnVybF9ncnVwLCBjb29raWVzPXNlbGYuY29va2llcywgaGVhZGVycz1zZWxmLmhlYWRlcikuY29udGVudDtzb3BfZGV2ID0gcGFyKGRhdGEsICJodG1sLnBhcnNlciIpO21lbWJlcnMgPSBzb3BfZGV2LmZpbmQoImRpdiIsIGlkPSJvYmplY3RzX2NvbnRhaW5lciIpDQogICAgICAgICAgICAgICAgZm9yIGRldiBpbiBtZW1iZXJzLmZpbmRfYWxsKCJ0YWJsZSIpOg0KICAgICAgICAgICAgICAgICAgICB1c2VyXyA9IGRldlsiaWQiXS5yZXBsYWNlKCJtZW1iZXJfIiwgIiIpO25hbWFfID0gcmUuZmluZGFsbCgnPGltZyBhbHQ9IiguKiksIHByb2ZpbGUgcGljdHVyZSInLCBzdHIoZGV2KSlbMF0NCiAgICAgICAgICAgICAgICAgICAgdHJ5Ol9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwsJ2ErJykud3JpdGUoc3RyKHVzZXJfKSsi4oCiIitzdHIobmFtYV8pKyJcbiIpLmNsb3NlKCkNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgICAgICAgICBwcmludCgiXHIlcyBbJXPigKIlc10gJXNUQUtJTkcgJXMlcyBJRCIlKEgsUCxILEssSCxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSkpLCBlbmQ9JyAnKTtzeXMuc3Rkb3V0LmZsdXNoKCkNCiAgICAgICAgICAgICAgICBpZiAiU2VlIG1vcmUiIGluIHN0cihzb3BfZGV2KTp1cmwgPSBzb3BfZGV2LmZpbmQoImEiLCBzdHJpbmc9IlNlZSBtb3JlIilbImhyZWYiXTt1cmxfZ3J1cCA9ICJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20iK3VybDtzZWxmLmV4ZWNfZ3J1cF9zYXlhKCkNCiAgICAgICAgICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDpwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQgRGFyaSBHcnVwIFNheWEiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhzZWxmLmZsKQ0KICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBfZXJyb3JfOnByaW50KCdcbiVzIFslcyElc10gJXNFcnJvciBEaSBCYWdpYW4gOiAlcyclKE0sUCxNLFAsX2Vycm9yXykpO19jaWNpX2NpY2lfKCkNCiAgICBkZWYgbWFudWFsKHNlbGYpOg0KICAgICAgICBpZD1fY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzRU5URVIgR1JPVVAgSUQgOiAiJShILFAsSCxLKSkNCiAgICAgICAgaWYgaWQ9PSIiOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7bWVudSgpDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICByPWJzNC5CZWF1dGlmdWxTb3VwKF9yZXFfZ2V0XygiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS9ncm91cHMvIitpZCxoZWFkZXJzPWhlYWRlcl9ncnVwLGNvb2tpZXM9c2VsZi5jb29raWVzKS50ZXh0LCJodG1sLnBhcnNlciIpDQogICAgICAgICAgICBpZiAibm8gY29udGVudCIgaW4gci5maW5kKCJ0aXRsZSIpLnRleHQubG93ZXIoKTpqYWxhbignJXMgWyVzISVzXSAlc1BSSVZBVEUgR1JPVVAgLyBXUk9ORyBJRCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgc2VsZi5saXN0ZWQ9eyJpZCI6aWQsIm5hbWUiOnIuZmluZCgidGl0bGUiKS50ZXh0fTtzZWxmLmYoaWQpO3ByaW50KCclcyAnJShPKSk7cHJpbnQoIiVzIFslc+KAoiVzXSAlc05BTUUgOiAlcyIlKEgsUCxILEssc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTt4ZCA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNEdW1wIElEL1VzZXJuYW1lPyBbaS91XSA6ICclKEgsUCxILEspKTtwcmludCgiJXMgWyVz4oCiJXNdICVzUFJFU1MgQ1RSTCtDIFRPIFNUT1AgRFVNUCIlKEgsUCxILEspKQ0KICAgICAgICAgICAgICAgIGlmIHhkIGluIFsnJ106amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgICAgICAgICBlbGlmIHhkIGluIFsnaScsJ0knLCcxJ106DQogICAgICAgICAgICAgICAgICAgIHRyeTpzZWxmLmR1bXBfaWQoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vZ3JvdXBzLyIraWQpO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBEYXJpICVzIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSksc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OnByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBEYXJpICVzIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSksc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBfZXJyb3JfOnByaW50KCdcbiVzIFslcyElc10gJXNFcnJvciBEaSBCYWdpYW4gOiAlcyclKE0sUCxNLFAsX2Vycm9yXykpO19jaWNpX2NpY2lfKCkNCiAgICAgICAgICAgICAgICBlbGlmIHhkIGluIFsndScsJ1UnLCcyJ106DQogICAgICAgICAgICAgICAgICAgIHRyeTpzZWxmLmR1bXBfdXNlcm5hbWUoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vZ3JvdXBzLyIraWQpO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBEYXJpICVzIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSksc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OnByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBGUk9NICVzIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSksc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBfZXJyb3JfOnByaW50KCdcbiVzIFslcyElc10gJXNFUlJPUiBJTiBTRUNUSU9OIDogJXMnJShNLFAsTSxNLF9lcnJvcl8pKTtfY2ljaV9jaWNpXygpDQogICAgICAgICAgICAgICAgZWxzZTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sTSkpO21lbnUoKSAgICANCiAgICBkZWYgc2VhcmNoKHNlbGYpOg0KICAgICAgICB3aGl0ZWxpc3Q9W107cT1fY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzTkFNRSA6ICclKEgsUCxILEspKS5sb3dlcigpDQogICAgICAgIGlmIHE9PScnOnNlbGYuc2VhcmNoKCkNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIGZvciBlLGkgaW4gZW51bWVyYXRlKHNlbGYuZ2xpc3QpOg0KICAgICAgICAgICAgICAgIGlmIHEgaW4gaS5nZXQoIm5hbWUiKS5sb3dlcigpOndoaXRlbGlzdC5hcHBlbmQoaSk7cHJpbnQoJyVzIFslcyVzJXNdICVzJXMnJShPLFAsbGVuKHdoaXRlbGlzdCksTyxQLGkuZ2V0KCJuYW1lIikucmVwbGFjZShxLCIlcyIlKHEpKSkpDQogICAgICAgICAgICBpZiBsZW4od2hpdGVsaXN0KT09MDpqYWxhbignJXMgWyVzISVzXSAlc1BSSVZBVEUgR1JPVVAgT1IgV1JPTkcgSUQnJShNLFAsTSxQKSk7bWVudSgpDQogICAgICAgICAgICBlbHNlOnNlbGYuY2hvaWNlKHdoaXRlbGlzdCxxKQ0KICAgIGRlZiBjaG9pY2Uoc2VsZiwgd2hpdGVsaXN0LHEpOg0KICAgICAgICB0cnk6DQogICAgICAgICAgICBzZWxmLmxpc3RlZD13aGl0ZWxpc3RbaW50KF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSE9PU0UgOiAnJShILFAsSCxLKSkpLWludCgxKV07c2VsZi5mKHEpO3ByaW50KCclcyAnJShPKSk7cHJpbnQoIiVzIFslc+KAoiVzXSAlc05BTUUgOiAlcyIlKEgsUCxILEssc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTt4ZCA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNEVU1QL1VTRVJOQU1FPyAlc1slc2klcy8lc3Ulc10gOiAnJShILFAsSCxLLFosTSxaLEgsWikpO3ByaW50KCIlcyBbJXPigKIlc10gJXNQUkVTUyBDVFJMK0MgVE8gU1RPUCBEVU1QIiUoSCxQLEgsSykpDQogICAgICAgICAgICBpZiB4ZCBpbiBbJyddOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7bWVudSgpDQogICAgICAgICAgICBlbGlmIHhkIGluIFsnaScsJ0knLCcxJ106DQogICAgICAgICAgICAgICAgdHJ5OnNlbGYuZHVtcF9pZCgiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS9ncm91cHMvIitzZWxmLmxpc3RlZC5nZXQoImlkIikpO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBEYXJpICVzIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSksc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIEZST00gJXMiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSxzZWxmLmxpc3RlZC5nZXQoIm5hbWUiKSkpO3JldHVybiBjcmFjayhzZWxmLmZsKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgX2Vycm9yXzpwcmludCgnXG4lcyBbJXMhJXNdICVzRVJST1IgSU4gU0VDVElPTiA6ICVzJyUoTSxQLE0sUCxfZXJyb3JfKSk7X2NpY2lfY2ljaV8oKQ0KICAgICAgICAgICAgZWxpZiB4ZCBpbiBbJ3UnLCdVJywnMiddOg0KICAgICAgICAgICAgICAgIHRyeTpzZWxmLmR1bXBfdXNlcm5hbWUoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vZ3JvdXBzLyIrc2VsZi5saXN0ZWQuZ2V0KCJpZCIpKTtwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQgRGFyaSAlcyIlKEgsUCxILEssbGVuKF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKS5zcGxpdGxpbmVzKCkpLHNlbGYubGlzdGVkLmdldCgibmFtZSIpKSk7cmV0dXJuIGNyYWNrKHNlbGYuZmwpDQogICAgICAgICAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OnByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBEYXJpICVzIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSksc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIF9lcnJvcl86cHJpbnQoJ1xuJXMgWyVzISVzXSAlc0VSUk9SIElOIFNFQ1RJT04gOiAlcyclKE0sUCxNLFAsX2Vycm9yXykpO19jaWNpX2NpY2lfKCkNCiAgICAgICAgICAgIGVsc2U6amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OnByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBGUk9NICVzIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSksc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBfZXJyb3JfOnByaW50KCdcbiVzIFslcyElc10gJXNFUlJPUiBJTiBTRUNUSU9OIDogJXMnJShNLFAsTSxQLF9lcnJvcl8pKTtfY2ljaV9jaWNpXygpDQogICAgZGVmIGYoc2VsZixpZCk6DQogICAgICAgIHNlbGYuZmw9KGlkLnJlcGxhY2UoJyAnLCdfJykrJy5qc29uJykNCiAgICAgICAgaWYgc2VsZi5mbD09Jyc6c2VsZi5mKCkNCiAgICAgICAgdHJ5Om9zLnJlbW92ZShzZWxmLmZsKQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICBfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsLCJ3IikuY2xvc2UoKQ0KICAgIGRlZiBkdW1wX3VzZXJuYW1lKHNlbGYsIHVybCk6DQogICAgICAgIHI9YnM0LkJlYXV0aWZ1bFNvdXAoX3JlcV9nZXRfKHVybCxjb29raWVzPXNlbGYuY29va2llcyxoZWFkZXJzPWhlYWRlcl9ncnVwKS50ZXh0LCJodG1sLnBhcnNlciIpO3ByaW50KCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiUoSCxQLEgsSyxILGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSksIGVuZD0nICcpO3N5cy5zdGRvdXQuZmx1c2goKQ0KICAgICAgICBmb3IgaSBpbiByLmZpbmRfYWxsKCJoMyIpOg0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgIGlmIGxlbihiczQucmUuZmluZGFsbCgiXC8iLGkuZmluZCgiYSIsaHJlZj1UcnVlKS5nZXQoImhyZWYiKSkpPT0xOg0KICAgICAgICAgICAgICAgICAgICBvZ2VoPWkuZmluZCgiYSIsaHJlZj1UcnVlKQ0KICAgICAgICAgICAgICAgICAgICBpZiAicHJvZmlsZS5waHAiIGluIG9nZWguZ2V0KCJocmVmIik6DQogICAgICAgICAgICAgICAgICAgICAgICBhPSIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoInByb2ZpbGVcLnBocFw/aWQ9KC4qPykmIixvZ2VoLmdldCgiaHJlZiIpKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxlbihhKT09MDpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiBhIGluIF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKTpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZTpfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsLCJhKyIpLndyaXRlKCIlc+KAoiVzXG4iJShhLG9nZWgudGV4dCkpO2NvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICBhPSIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoIi8oLio/KVw/IixvZ2VoLmdldCgiaHJlZiIpKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxlbihhKT09MDpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiBhIGluIF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKTpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZTpfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsLCJhKyIpLndyaXRlKCIlc+KAoiVzXG4iJShhLG9nZWgudGV4dCkpDQogICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgZm9yIGkgaW4gci5maW5kX2FsbCgiYSIsaHJlZj1UcnVlKToNCiAgICAgICAgICAgIGlmICJTZWUgTW9yZSBQb3N0cyIgaW4gaS50ZXh0Og0KICAgICAgICAgICAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICAgICAgICAgICAgIHRyeTpzZWxmLmR1bXBfdXNlcm5hbWUoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vIitpLmdldCgiaHJlZiIpKTticmVhaw0KICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6cHJpbnQoJ1xyJXMgWyVzISVzXSAlc1JFUEVBVCclKE0sUCxNLE0pKTtjb250aW51ZQ0KICAgIGRlZiBkdW1wX2lkKHNlbGYsIHVybCk6DQogICAgICAgIHI9YnM0LkJlYXV0aWZ1bFNvdXAoX3JlcV9nZXRfKHVybCxjb29raWVzPXNlbGYuY29va2llcyxoZWFkZXJzPWhlYWRlcl9ncnVwKS50ZXh0LCJodG1sLnBhcnNlciIpO3ByaW50KCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiUoSCxQLEgsSyxILGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSksIGVuZD0nICcpO3N5cy5zdGRvdXQuZmx1c2goKQ0KICAgICAgICBmb3IgaSBpbiByLmZpbmRfYWxsKCJoMyIpOg0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgIGlmIGxlbihiczQucmUuZmluZGFsbCgiXC8iLGkuZmluZCgiYSIsaHJlZj1UcnVlKS5nZXQoImhyZWYiKSkpPT0xOg0KICAgICAgICAgICAgICAgICAgICBvZ2VoPWkuZmluZCgiYSIsaHJlZj1UcnVlKQ0KICAgICAgICAgICAgICAgICAgICBpZiAicHJvZmlsZS5waHAiIGluIG9nZWguZ2V0KCJocmVmIik6DQogICAgICAgICAgICAgICAgICAgICAgICBhPSIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoInByb2ZpbGVcLnBocFw/aWQ9KC4qPykmIixvZ2VoLmdldCgiaHJlZiIpKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxlbihhKT09MDpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiBhIGluIF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKTpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZTpfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsLCJhKyIpLndyaXRlKCIlc+KAoiVzXG4iJShhLG9nZWgudGV4dCkpO2NvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICBhPSIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoIi8oLio/KVw/IixvZ2VoLmdldCgiaHJlZiIpKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxlbihhKT09MDpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiBhIGluIF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKTpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZTpfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsLCJhKyIpLndyaXRlKCIlc+KAoiVzXG4iJShfZ2V0X2lkXyhhKSxvZ2VoLnRleHQpKQ0KICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgICAgIGZvciBpIGluIHIuZmluZF9hbGwoImEiLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICBpZiAiU2VlIE1vcmUgUG9zdHMiIGluIGkudGV4dDoNCiAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOg0KICAgICAgICAgICAgICAgICAgICB0cnk6c2VsZi5kdW1wX2lkKCJodHRwczovL20uZmFjZWJvb2suY29tLyIraS5nZXQoImhyZWYiKSk7YnJlYWsNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOnByaW50KCdcciVzIFslcyElc10gJXNNZW5ndWxhbmdpJyUoTSxQLE0sUCkpO2NvbnRpbnVlDQoNCg0KZGVmIF9nZXRfaWRfKHVzZXJuYW1lKToNCiAgICB1cmwgPSAiaHR0cHM6Ly9sb29rdXAtaWQuY29tLyMiDQogICAgd2l0aCBfcmVxX3Nlc18gYXMgZGV2Og0KICAgICAgICBwYXlsb2FkID0geyJmYnVybCI6ICJodHRwczovL20uZmFjZWJvb2suY29tL3t9Ii5mb3JtYXQodXNlcm5hbWUpLCAiY2hlY2siOiAiTG9va3VwIn0NCiAgICAgICAgaWYgImZhY2Vib29rIiBpbiB1c2VybmFtZTpwYXlsb2FkID0geyJmYnVybCI6IHVzZXJuYW1lLCAiY2hlY2siOiAiTG9va3VwIn0NCiAgICAgICAgZGF0YV9kZXYgPSBkZXYucG9zdCh1cmwsIGRhdGE9cGF5bG9hZCkuY29udGVudDtzb3BfID0gcGFyKGRhdGFfZGV2LCAiaHRtbC5wYXJzZXIiKTtpZF8gPSBzb3BfLmZpbmQoInNwYW4iLCBpZD0iY29kZSIpO3VzZXJfZ2V0X2lkID0gaWRfLnRleHQNCiAgICAgICAgcmV0dXJuIHVzZXJfZ2V0X2lkDQoNCg0KZGVmIGR1bXBfbmFtZShfYXppbXZhdV8pOg0KICAgIHByaW50KCclcyBbJXPigKIlc10gJXNFWEFNUExFIDoga3VyZCclKEgsUCxILEspKTtfX25hbWVfXyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBOQU1FIDogJyUoSCxQLEgsSykpLnNwbGl0KCcsJyk7X2ZpbGVfID0gJ2R1bXBfbmFtZS5qc29uJw0KICAgIHRyeTpvcy5yZW1vdmUoX2ZpbGVfKQ0KICAgIGV4Y2VwdDpwYXNzDQogICAgZm9yIF9uYW1lXyBpbiBfX25hbWVfXzpfdXJsXyA9ICJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vc2VhcmNoL3Blb3BsZS8/cT0iK19uYW1lXztjYXJpX25hbWEoX2ZpbGVfLF9hemltdmF1XyxfdXJsXykNCiAgICBfYnVrYV9maWxlXyA9IF9hemltdmF1X2RhcHVudGFfKF9maWxlXywncicpLnJlYWQoKS5zcGxpdGxpbmVzKCk7cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzVE9UQUwgSUQgOiAlcyIlKEgsUCxILEssc3RyKGxlbihfYnVrYV9maWxlXykpKSkNCiAgICByZXR1cm4gY3JhY2soX2ZpbGVfKQ0KZGVmIGNhcmlfbmFtYShfZmlsZV8sX2Nvb2tpZXNfLF91cmxfKToNCiAgICBfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sImErIik7X3JlcV9zZXNfZGV2XyA9IGJzNC5CZWF1dGlmdWxTb3VwKF9yZXFfZ2V0XyhfdXJsXywgY29va2llcz1fY29va2llc18saGVhZGVycz1oZWFkZXJfbmFtYSkudGV4dCwiaHRtbC5wYXJzZXIiKQ0KICAgIGZvciBfYXppbXZhdV9kZXZfIGluIF9yZXFfc2VzX2Rldl8uZmluZF9hbGwoImEiLGhyZWY9VHJ1ZSk6DQogICAgICAgIHByaW50ICgiXHIlcyBbJXPigKIlc10gJXNUQUtJTkcgJXMlcyBJRCIlKEgsUCxILEssSCxsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSksZW5kPScnKTtzeXMuc3Rkb3V0LmZsdXNoKCkNCiAgICAgICAgaWYgIjxpbWcgYWx0PSIgaW4gc3RyKF9hemltdmF1X2Rldl8pOg0KICAgICAgICAgICAgaWYgImhvbWUucGhwIiBpbiBzdHIoX2F6aW12YXVfZGV2X1siaHJlZiJdKTpjb250aW51ZQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICBfc3RyX2Rldl8gPSBzdHIoX2F6aW12YXVfZGV2X1siaHJlZiJdKQ0KICAgICAgICAgICAgICAgIGlmICJwcm9maWxlLnBocCIgaW4gX3N0cl9kZXZfOg0KICAgICAgICAgICAgICAgICAgICBfbmFtZV8gPSBfYXppbXZhdV9kZXZfLmZpbmQoImltZyIpLmdldCgiYWx0IikucmVwbGFjZSgiLCBwcm9maWxlIHBpY3R1cmUiLCIiKTtfZmluZF8gPSBiczQucmUuZmluZGFsbCgiL3Byb2ZpbGVcLnBocFw/aWQ9KC4qPykmIixfc3RyX2Rldl8pDQogICAgICAgICAgICAgICAgICAgIGlmIGxlbiAoX2ZpbmRfKSAhPTA6DQogICAgICAgICAgICAgICAgICAgICAgICBfdXNlcl8gPSAiIi5qb2luKF9maW5kXykNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIF91c2VyXyBpbiBfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKTpwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOl9hemltdmF1X2RhcHVudGFfKF9maWxlXywiYSsiKS53cml0ZSgiJXPigKIlc1xuIiUoX3VzZXJfLF9uYW1lXykpDQogICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgX2ZpbmRfID0gYnM0LnJlLmZpbmRhbGwoIi8oLio/KVw/Iixfc3RyX2Rldl8pO19uYW1lXyA9IF9hemltdmF1X2Rldl8uZmluZCgiaW1nIikuZ2V0KCJhbHQiKS5yZXBsYWNlKCIsIHByb2ZpbGUgcGljdHVyZSIsIiIpDQogICAgICAgICAgICAgICAgICAgIGlmIGxlbihfZmluZF8pICE9MDoNCiAgICAgICAgICAgICAgICAgICAgICAgIF91c2VyXz0iIi5qb2luKF9maW5kXykNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIF91c2VyXyBpbiBfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKTpwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOl9hemltdmF1X2RhcHVudGFfKF9maWxlXywiYSsiKS53cml0ZSgiJXPigKIlc1xuIiUoX3VzZXJfLF9uYW1lXykpDQogICAgICAgIGlmICJTZWUgTW9yZSBSZXN1bHRzIiBpbiBfYXppbXZhdV9kZXZfLnRleHQ6Y2FyaV9uYW1hKF9maWxlXyxfY29va2llc18sX2F6aW12YXVfZGV2X1siaHJlZiJdKQ0KDQoNCmNsYXNzIGR1bXBfcGVzYW46DQogICAgZGVmIF9faW5pdF9fKHNlbGYsX2Nvb2tpZXNfLF9uYW1hXyxfaWRfKToNCiAgICAgICAgc2VsZi5jb29raWVzID0gX2Nvb2tpZXNfO3NlbGYuaWQgPSBfaWRfO3NlbGYuZmlsZXMgPSAoX25hbWFfKycuanNvbicpLnJlcGxhY2UoIiAiLCJfIik7X2F6aW12YXVfZGFwdW50YV8oc2VsZi5maWxlcywidyIpLmNsb3NlKCk7c2VsZi5kdW1wKCJodHRwczovL20uZmFjZWJvb2suY29tL21lc3NhZ2VzIikNCiAgICBkZWYgZHVtcChzZWxmLHVybCk6DQogICAgICAgIF9yZXFfc2VzX2Rldl8gPSBiczQuQmVhdXRpZnVsU291cChfcmVxX2dldF8odXJsLGhlYWRlcnM9aGVhZGVyX25hbWEsY29va2llcz1zZWxmLmNvb2tpZXMpLnRleHQsImh0bWwucGFyc2VyIikNCiAgICAgICAgZm9yIF9kZXZfIGluIF9yZXFfc2VzX2Rldl8uZmluZF9hbGwoImEiLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICBpZiAiL21lc3NhZ2VzL3JlYWQiIGluIF9kZXZfLmdldCgiaHJlZiIpOg0KICAgICAgICAgICAgICAgIF9zb3VwXyA9IGJzNC5yZS5maW5kYWxsKCJjaWRcLmNcLiguKj8pJTNBKC4qPykmIixfZGV2Xy5nZXQoImhyZWYiKSkNCiAgICAgICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgICAgIGZvciBfdXNlcl8gaW4gbGlzdChfc291cF8ucG9wKCkpOg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgX3VzZXJfIGluIHNlbGYuaWQ6Y29udGludWUNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgIkZhY2Vib29rIHVzZXIiIGluIF9kZXZfLnRleHQubG93ZXIoKTpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmlsZXMsImErIikud3JpdGUoIiVz4oCiJXNcbiIlKF91c2VyXyxfZGV2Xy50ZXh0KSk7cHJpbnQoIlxyJXMgWyVz4oCiJXNdICVzVEFLSU5HICVzJXMgSUQiJShILFAsSCxLLEgsbGVuKF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmlsZXMpLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSxlbmQ9JycpO3N5cy5zdGRvdXQuZmx1c2goKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpjb250aW51ZQ0KICAgICAgICAgICAgaWYgIlNlZSBPbGRlciBNZXNzYWdlcyIgaW4gX2Rldl8udGV4dDpzZWxmLmR1bXAoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vIitfZGV2Xy5nZXQoImhyZWYiKSkNCiAgICAgICAgX2J1a2FfZmlsZV8gPSBfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZpbGVzLCdyJykucmVhZCgpLnNwbGl0bGluZXMoKTtwcmludCgiXG4lcyBbJXPigKIlc10gJXNBTEwgSUQgOiAlcyIlKEgsUCxILEssc3RyKGxlbihfYnVrYV9maWxlXykpKSkNCiAgICAgICAgcmV0dXJuIGNyYWNrKHNlbGYuZmlsZXMpDQoNCg0KDQpkZWYgZmlsZSgpOg0KCXRyeToNCgkJcHJpbnQoIiIpDQoJCXhjID0gaW5wdXQoJyVzIFslc+KAoiVzXSAlc0ZJTEUgOiAlcyclKEgsUCxILEssSCkpDQoJCWlkID0gb3Blbih4YykucmVhZCgpLnNwbGl0bGluZXMoKQ0KCQlwcmludCgnJXMgWyVz4oCiJXNdICVzQUxMIElEIDogJXMlcyclKEgsUCxILE8sSCxsZW4oaWQpKSkNCgkJcmV0dXJuIGNyYWNrKHhjKQ0KCWV4Y2VwdCBGaWxlTm90Rm91bmRFcnJvcjoNCgkJcHJpbnQoIiVzIFslcyElc10gJXNGSUxFIE5PVCBFWElTVElORyIlKE0sUCxNLE0pKQ0KCQlmaWxlKCkNCgkJDQoNCmRlZiBkdW1wX2VtYWlsKCk6DQogICAgcHJpbnQoIiVzIFslc+KAoiVzXSAlc0VYQU1QTEUgOiBhaG1hZGt1cmQ4MTkgIiUoSCxQLEgsSykpO19xdWVyeV8gPSBfY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzRU5URVIgTkFNRSA6ICIlKEgsUCxILEspKS5sb3dlcigpDQogICAgaWYgbGVuKF9xdWVyeV8pIDwgMzpqYWxhbignJXMgWyVzISVzXSAlc05BTUUgTVVTVCBCRSBNT1JFIFRIQU4gMiBESUdJVFMnJShNLFAsTSxQKSk7dGltZS5zbGVlcCgyKTttZW51KCkNCiAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzRVhBTVBMRSA6ICVzZ21haWwuY29tIiUoSCxQLEgsSyxIKSk7X2RvbWFpbl8gPSBfY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzRU5URVIgRE9NQUlOIDogIiUoSCxQLEgsSykpLmxvd2VyKCkNCiAgICBpZiAnQCcgaW4gX2RvbWFpbl86X2RvbWFpbl8gPSBfZG9tYWluXy5zcGxpdCgnQCcpWzFdDQogICAgX2xpbWl0X2F3YWxfID0gaW50KF9jaWNpX2F6aW12YXVfKCIlcyBbJXPigKIlc10gJXNFTlRFUiBTVEFSSU5HIE5VTUJFUiA6ICIlKEgsUCxILEspKSk7X2xpbWl0X2FraGlyXz0gaW50KF9jaWNpX2F6aW12YXVfKCIlcyBbJXPigKIlc10gJXNFTlRFUiBFTkRJTkcgTlVNQkVSIDogIiUoSCxQLEgsSykpKTtfZmlsZV8gPSAoX3F1ZXJ5XysiLmpzb24iKS5yZXBsYWNlKCIgIiwiXyIpDQogICAgdHJ5Om9zLnJlbW92ZShfZmlsZV8pDQogICAgZXhjZXB0OnBhc3MNCiAgICBleGVjX2VtYWlsKF9xdWVyeV8sX2RvbWFpbl8sX2xpbWl0X2F3YWxfLF9saW1pdF9ha2hpcl8sX2ZpbGVfKQ0KZGVmIGV4ZWNfZW1haWwoX19xdWVyeV9fLF9kb21haW5fLF9saW1pdF9hd2FsXyxfbGltaXRfYWtoaXJfLF9maWxlXyk6DQogICAgX2hpdHVuZ19lbWFpbF8xXyA9IF9saW1pdF9hd2FsXysxO19oaXR1bmdfZW1haWxfMl8gPSBfbGltaXRfYXdhbF8rMTtfaGl0dW5nX2VtYWlsXzNfID0gX2xpbWl0X2F3YWxfKzE7X2hpdHVuZ19lbWFpbF9mdWxsXyA9IF9saW1pdF9hd2FsXysxDQogICAgaWYgJyAnIGluIF9fcXVlcnlfXzoNCiAgICAgICAgdHJ5Ol9xdWVyeV8xXyA9IF9fcXVlcnlfXy5zcGxpdCgnICcpWzBdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHRyeTpfcXVlcnlfMl8gPSBfX3F1ZXJ5X18uc3BsaXQoJyAnKVsxXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICB0cnk6X3F1ZXJ5XzNfID0gX19xdWVyeV9fLnNwbGl0KCcgJylbMl0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICBlbGlmICcuJyBpbiBfX3F1ZXJ5X186DQogICAgICAgIHRyeTpfcXVlcnlfMV8gPSBfX3F1ZXJ5X18uc3BsaXQoJy4nKVswXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICB0cnk6X3F1ZXJ5XzJfID0gX19xdWVyeV9fLnNwbGl0KCcuJylbMV0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgdHJ5Ol9xdWVyeV8zXyA9IF9fcXVlcnlfXy5zcGxpdCgnLicpWzJdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgZWxpZiAnXycgaW4gX19xdWVyeV9fOg0KICAgICAgICB0cnk6X3F1ZXJ5XzFfID0gX19xdWVyeV9fLnNwbGl0KCdfJylbMF0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgdHJ5Ol9xdWVyeV8yXyA9IF9fcXVlcnlfXy5zcGxpdCgnXycpWzFdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHRyeTpfcXVlcnlfM18gPSBfX3F1ZXJ5X18uc3BsaXQoJ18nKVsyXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgIGVsaWYgJy0nIGluIF9fcXVlcnlfXzoNCiAgICAgICAgdHJ5Ol9xdWVyeV8xXyA9IF9fcXVlcnlfXy5zcGxpdCgnLScpWzBdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHRyeTpfcXVlcnlfMl8gPSBfX3F1ZXJ5X18uc3BsaXQoJy0nKVsxXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICB0cnk6X3F1ZXJ5XzNfID0gX19xdWVyeV9fLnNwbGl0KCctJylbMl0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICBlbHNlOg0KICAgICAgICB0cnk6X3F1ZXJ5XzFfID0gX19xdWVyeV9fDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgdHJ5IDoNCiAgICAgICAgZm9yIF9qdW1sYWhfIGluIHJhbmdlKF9saW1pdF9hd2FsXyxfbGltaXRfYWtoaXJfKToNCiAgICAgICAgICAgIHRyeTpuYW1hID0gX3F1ZXJ5XzFfO2VtYWlsID0gKCclcyVzQCVzJyUoX3F1ZXJ5XzFfLHN0cihfaGl0dW5nX2VtYWlsXzFfKSxfZG9tYWluXykpO19hemltdmF1X2RhcHVudGFfKF9maWxlXywnYSsnKS53cml0ZSgnJXPigKIlc1xuJyUoZW1haWwsbmFtYSkpO19oaXR1bmdfZW1haWxfMV8gKz0gMQ0KICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgICAgIGZvciBfanVtbGFoXyBpbiByYW5nZShfbGltaXRfYXdhbF8sX2xpbWl0X2FraGlyXyk6DQogICAgICAgICAgICB0cnk6bmFtYSA9IF9xdWVyeV8yXztlbWFpbCA9ICgnJXMlc0AlcyclKF9xdWVyeV8yXyxzdHIoX2hpdHVuZ19lbWFpbF8yXyksX2RvbWFpbl8pKTtfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ2ErJykud3JpdGUoJyVz4oCiJXNcbiclKGVtYWlsLG5hbWEpKTtfaGl0dW5nX2VtYWlsXzJfICs9IDENCiAgICAgICAgICAgIGV4Y2VwdDpjb250aW51ZQ0KICAgICAgICBmb3IgX2p1bWxhaF8gaW4gcmFuZ2UoX2xpbWl0X2F3YWxfLF9saW1pdF9ha2hpcl8pOg0KICAgICAgICAgICAgdHJ5Om5hbWEgPSBfcXVlcnlfM187ZW1haWwgPSAoJyVzJXNAJXMnJShfcXVlcnlfM18sc3RyKF9oaXR1bmdfZW1haWxfM18pLF9kb21haW5fKSk7X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCdhKycpLndyaXRlKCclc+KAoiVzXG4nJShlbWFpbCxuYW1hKSk7X2hpdHVuZ19lbWFpbF8zXyArPSAxDQogICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgZm9yIF9qdW1sYWhfIGluIHJhbmdlKF9saW1pdF9hd2FsXyxfbGltaXRfYWtoaXJfKToNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICBpZiAnLicgaW4gX19xdWVyeV9fOl9xdWVyeV8gPSBfX3F1ZXJ5X187bmFtYSA9IF9fcXVlcnlfXy5yZXBsYWNlKCcuJywnICcpDQogICAgICAgICAgICAgICAgZWxpZiAnXycgaW4gX19xdWVyeV9fOl9xdWVyeV8gPSBfX3F1ZXJ5X187bmFtYSA9IF9fcXVlcnlfXy5yZXBsYWNlKCdfJywnICcpDQogICAgICAgICAgICAgICAgZWxpZiAnLScgaW4gX19xdWVyeV9fOl9xdWVyeV8gPSBfX3F1ZXJ5X187bmFtYSA9IF9fcXVlcnlfXy5yZXBsYWNlKCctJywnICcpDQogICAgICAgICAgICAgICAgZWxzZTpfcXVlcnlfID0gX19xdWVyeV9fLnJlcGxhY2UoJyAnLCcnKTtuYW1hID0gX19xdWVyeV9fDQogICAgICAgICAgICAgICAgZW1haWwgPSAoJyVzJXNAJXMnJShfcXVlcnlfLHN0cihfaGl0dW5nX2VtYWlsX2Z1bGxfKSxfZG9tYWluXykpO19hemltdmF1X2RhcHVudGFfKF9maWxlXywnYSsnKS53cml0ZSgnJXPigKIlc1xuJyUoZW1haWwsbmFtYSkpO19oaXR1bmdfZW1haWxfZnVsbF8gKz0gMQ0KICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgZXhjZXB0Og0KICAgICAgICBqYWxhbignJXMgWyVzISVzXSAlc1RIRVJFIElTIEFOIEVSUk9SJyUoTSxQLE0sTSkpDQogICAgICAgIHRpbWUuc2xlZXAoMikNCiAgICAgICAgbWVudSgpDQogICAgX2J1a2FfZmlsZV8gPSBfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ3InKS5yZWFkKCkuc3BsaXRsaW5lcygpDQogICAgcHJpbnQoIiVzIFslc+KAoiVzXSAlc1RPVEFMIElEIDogJXMlcyIlKEgsUCxILEssSCxzdHIobGVuKF9idWthX2ZpbGVfKSkpKQ0KICAgIHJldHVybiBjcmFjayhfZmlsZV8pDQoNCg0KZGVmIGR1bXBfdXNlcm5hbWUoKToNCiAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzRVhBTVBMRSA6ICVzYWhtYWRrdXJkODcxIiUoSCxQLEgsSyxIKSk7X3F1ZXJ5XyA9IF9jaWNpX2F6aW12YXVfKCIlcyBbJXPigKIlc10gJXNFTlRFUiBOQU1FIDogIiUoSCxQLEgsSykpLmxvd2VyKCkNCiAgICBpZiBsZW4oX3F1ZXJ5XykgPCAzOmphbGFuKCclcyBbJXMhJXNdICVzTkFNRSBNVVNUIEJFIE1PUkUgVEhBTiAyIERJR0lUUyclKE0sUCxNLE0pKTt0aW1lLnNsZWVwKDIpO21lbnUoKQ0KICAgIF9saW1pdF9hd2FsXyA9IGludChfY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzRU5URVIgU1RBUlRJTkcgTlVNQkVSIChFWDogMSkgOiAiJShILFAsSCxQKSkpO19saW1pdF9ha2hpcl89IGludChfY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzRU5URVIgRU5ESU5HIE5VTUJFUiAoRVg6IDEwMDApOiAiJShILFAsSCxQKSkpO19maWxlXyA9IChfcXVlcnlfKyIuanNvbiIpLnJlcGxhY2UoIiAiLCJfIikNCiAgICB0cnk6b3MucmVtb3ZlKF9maWxlXykNCiAgICBleGNlcHQ6cGFzcw0KICAgIGV4ZWNfdXNlcm5hbWUoX3F1ZXJ5XyxfbGltaXRfYXdhbF8sX2xpbWl0X2FraGlyXyxfZmlsZV8pDQpkZWYgZXhlY191c2VybmFtZShfX3F1ZXJ5X18sX2xpbWl0X2F3YWxfLF9saW1pdF9ha2hpcl8sX2ZpbGVfKToNCiAgICBfaGl0dW5nX2VtYWlsXzFfID0gX2xpbWl0X2F3YWxfKzE7X2hpdHVuZ19lbWFpbF8yXyA9IF9saW1pdF9hd2FsXysxO19oaXR1bmdfZW1haWxfM18gPSBfbGltaXRfYXdhbF8rMTtfaGl0dW5nX2VtYWlsX2Z1bGxfID0gX2xpbWl0X2F3YWxfKzENCiAgICBpZiAnICcgaW4gX19xdWVyeV9fOg0KICAgICAgICB0cnk6X3F1ZXJ5XzFfID0gX19xdWVyeV9fLnNwbGl0KCcgJylbMF0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgdHJ5Ol9xdWVyeV8yXyA9IF9fcXVlcnlfXy5zcGxpdCgnICcpWzFdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHRyeTpfcXVlcnlfM18gPSBfX3F1ZXJ5X18uc3BsaXQoJyAnKVsyXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgIGVsaWYgJy4nIGluIF9fcXVlcnlfXzoNCiAgICAgICAgdHJ5Ol9xdWVyeV8xXyA9IF9fcXVlcnlfXy5zcGxpdCgnLicpWzBdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHRyeTpfcXVlcnlfMl8gPSBfX3F1ZXJ5X18uc3BsaXQoJy4nKVsxXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICB0cnk6X3F1ZXJ5XzNfID0gX19xdWVyeV9fLnNwbGl0KCcuJylbMl0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICBlbGlmICdfJyBpbiBfX3F1ZXJ5X186DQogICAgICAgIHRyeTpfcXVlcnlfMV8gPSBfX3F1ZXJ5X18uc3BsaXQoJ18nKVswXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICB0cnk6X3F1ZXJ5XzJfID0gX19xdWVyeV9fLnNwbGl0KCdfJylbMV0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgdHJ5Ol9xdWVyeV8zXyA9IF9fcXVlcnlfXy5zcGxpdCgnXycpWzJdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgZWxpZiAnLScgaW4gX19xdWVyeV9fOg0KICAgICAgICB0cnk6X3F1ZXJ5XzFfID0gX19xdWVyeV9fLnNwbGl0KCctJylbMF0NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgdHJ5Ol9xdWVyeV8yXyA9IF9fcXVlcnlfXy5zcGxpdCgnLScpWzFdDQogICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgIHRyeTpfcXVlcnlfM18gPSBfX3F1ZXJ5X18uc3BsaXQoJy0nKVsyXQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgIGVsc2U6DQogICAgICAgIHRyeTpfcXVlcnlfMV8gPSBfX3F1ZXJ5X18NCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICB0cnkgOg0KICAgICAgICBmb3IgX2p1bWxhaF8gaW4gcmFuZ2UoX2xpbWl0X2F3YWxfLF9saW1pdF9ha2hpcl8pOg0KICAgICAgICAgICAgdHJ5Om5hbWEgPSBfcXVlcnlfMV87ZW1haWwgPSAoJyVzJXMnJShfcXVlcnlfMV8sc3RyKF9oaXR1bmdfZW1haWxfMV8pKSk7X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCdhKycpLndyaXRlKCclc+KAoiVzXG4nJShlbWFpbCxuYW1hKSk7X2hpdHVuZ19lbWFpbF8xXyArPSAxDQogICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgZm9yIF9qdW1sYWhfIGluIHJhbmdlKF9saW1pdF9hd2FsXyxfbGltaXRfYWtoaXJfKToNCiAgICAgICAgICAgIHRyeTpuYW1hID0gX3F1ZXJ5XzJfO2VtYWlsID0gKCclcyVzJyUoX3F1ZXJ5XzJfLHN0cihfaGl0dW5nX2VtYWlsXzJfKSkpO19hemltdmF1X2RhcHVudGFfKF9maWxlXywnYSsnKS53cml0ZSgnJXPigKIlc1xuJyUoZW1haWwsbmFtYSkpO19oaXR1bmdfZW1haWxfMl8gKz0gMQ0KICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgICAgIGZvciBfanVtbGFoXyBpbiByYW5nZShfbGltaXRfYXdhbF8sX2xpbWl0X2FraGlyXyk6DQogICAgICAgICAgICB0cnk6bmFtYSA9IF9xdWVyeV8zXztlbWFpbCA9ICgnJXMlcyclKF9xdWVyeV8zXyxzdHIoX2hpdHVuZ19lbWFpbF8zXykpKTtfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sJ2ErJykud3JpdGUoJyVz4oCiJXNcbiclKGVtYWlsLG5hbWEpKTtfaGl0dW5nX2VtYWlsXzNfICs9IDENCiAgICAgICAgICAgIGV4Y2VwdDpjb250aW51ZQ0KICAgICAgICBmb3IgX2p1bWxhaF8gaW4gcmFuZ2UoX2xpbWl0X2F3YWxfLF9saW1pdF9ha2hpcl8pOg0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgIGlmICcuJyBpbiBfX3F1ZXJ5X186X3F1ZXJ5XyA9IF9fcXVlcnlfXztuYW1hID0gX19xdWVyeV9fLnJlcGxhY2UoJy4nLCcgJykNCiAgICAgICAgICAgICAgICBlbGlmICdfJyBpbiBfX3F1ZXJ5X186X3F1ZXJ5XyA9IF9fcXVlcnlfXztuYW1hID0gX19xdWVyeV9fLnJlcGxhY2UoJ18nLCcgJykNCiAgICAgICAgICAgICAgICBlbGlmICctJyBpbiBfX3F1ZXJ5X186X3F1ZXJ5XyA9IF9fcXVlcnlfXztuYW1hID0gX19xdWVyeV9fLnJlcGxhY2UoJy0nLCcgJykNCiAgICAgICAgICAgICAgICBlbHNlOl9xdWVyeV8gPSBfX3F1ZXJ5X18ucmVwbGFjZSgnICcsJycpO25hbWEgPSBfX3F1ZXJ5X18NCiAgICAgICAgICAgICAgICBlbWFpbCA9ICgnJXMlcyclKF9xdWVyeV8sc3RyKF9oaXR1bmdfZW1haWxfZnVsbF8pKSk7X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCdhKycpLndyaXRlKCclc+KAoiVzXG4nJShlbWFpbCxuYW1hKSk7X2hpdHVuZ19lbWFpbF9mdWxsXyArPSAxDQogICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICBleGNlcHQ6amFsYW4oJyVzIFslcyElc10gJXNUSEVSRSBJUyBBTiBFUlJPUiclKE0sUCxNLFApKTt0aW1lLnNsZWVwKDIpO21lbnUoKQ0KICAgIF9idWthX2ZpbGVfID0gX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCdyJykucmVhZCgpLnNwbGl0bGluZXMoKTtwcmludCgiJXMgWyVz4oCiJXNdICVzQUxMIElEIDogJXMlcyIlKEgsUCxILEssSCxzdHIobGVuKF9idWthX2ZpbGVfKSkpKQ0KICAgIHJldHVybiBjcmFjayhfZmlsZV8pDQoNCiMjIyBEdW1wIElEIERhcmkgSGFzaHRhZw0KZGVmIGhhc2h0YWcoY29va2llcyk6DQogICAgX3F1ZXJ5XyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBIQVNIVEFHIDogJyUoSCxQLEgsQikpO191cmxfZGV2XyA9ICdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vaGFzaHRhZy8nICsgX3F1ZXJ5XztfZmlsZV8gPSAoX3F1ZXJ5XysnLmpzb24nKS5yZXBsYWNlKCcgJywnXycpDQogICAgdHJ5Om9zLnJlbW92ZShfZmlsZV8pDQogICAgZXhjZXB0OnBhc3MNCiAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzUFJFU1MgQ1RSTCtDIFRPIFNUT1AgRFVNUCIlKEgsUCxILEspKTtleGVjX2hhc2h0YWcoX3VybF9kZXZfLGNvb2tpZXMsX2ZpbGVfKTtwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykNCmRlZiBleGVjX2hhc2h0YWcodXJsLGNvb2tpZXMsX2ZpbGVfKToNCiAgICBvcGVuKF9maWxlXywnYScpO19yZXFfc2VzXyA9IHJlcXVlc3RzLlNlc3Npb24oKTtfcmVxX2dldF8gPSBfcmVxX3Nlc18uZ2V0KHVybCxjb29raWVzPWNvb2tpZXMsaGVhZGVycz1oZWFkZXJfaGFzaHRhZyk7X3NvcF9kZXZfID0gcGFyKF9yZXFfZ2V0Xy50ZXh0LCdodG1sLnBhcnNlcicpO19idWthX2ZpbGVfID0gb3BlbihfZmlsZV8pLnJlYWQoKTtwcmludCAoIlxyJXMgWyVz4oCiJXNdICVzVEFLSU5HICVzJXMgSUQiJShILFAsSCxLLEgsbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpLGVuZD0nJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQogICAgdHJ5Og0KICAgICAgICBmb3IgX2NpY2lfIGluIF9zb3BfZGV2Xy5maW5kX2FsbCgnaDMnKToNCiAgICAgICAgICAgIGZvciBfYXppbXZhdV8gaW4gX2NpY2lfLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOg0KICAgICAgICAgICAgICAgIGlmICdtYmFzaWMuZmFjZWJvb2suY29tJyBpbiBfYXppbXZhdV8uZ2V0KCdocmVmJyk6cGFzcw0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgIGlmICJwcm9maWxlLnBocCIgaW4gX2F6aW12YXVfLmdldCgnaHJlZicpOg0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9uYW1lX2Rldl8gPSBfYXppbXZhdV8udGV4dDtfaWRfZGV2XyA9ICIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoInByb2ZpbGVcLnBocFw/aWQ9KC4qPykmIixfYXppbXZhdV8uZ2V0KCJocmVmIikpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIF9uYW1lX2Rldl8gaW4gX2J1a2FfZmlsZV86cGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgJy8nIGluIF9pZF9kZXZfOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlOm9wZW4oX2ZpbGVfLCdhKycpLndyaXRlKCclc+KAoiVzXG4nJShfaWRfZGV2XyxfbmFtZV9kZXZfKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX25hbWVfZGV2XyA9IF9hemltdmF1Xy50ZXh0O19pZF9kZXZfID0gIiIuam9pbihiczQucmUuZmluZGFsbCgiLyguKj8pXD8iLF9hemltdmF1Xy5nZXQoImhyZWYiKSkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgX25hbWVfZGV2XyBpbiBfYnVrYV9maWxlXzpwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiAnLycgaW4gX2lkX2Rldl86cGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6b3BlbihfZmlsZV8sJ2ErJykud3JpdGUoJyVz4oCiJXNcbiclKF9pZF9kZXZfLF9uYW1lX2Rldl8pKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgICAgIGZvciBfYXppbXZhdV8gaW4gX3NvcF9kZXZfLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOg0KICAgICAgICAgICAgICAgIGlmICdTZWUgTW9yZSBSZXN1bHRzJyBpbiBfYXppbXZhdV8udGV4dDp1cmxfZGV2ID0gX2F6aW12YXVfLmdldCgnaHJlZicpO2V4ZWNfaGFzaHRhZyh1cmxfZGV2LGNvb2tpZXMsX2ZpbGVfKQ0KICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDpwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykNCg0KDQpkZWYgYmVyYW5kYShjb29raWVzKToNCiAgICBfdXJsX2Rldl8gPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2hvbWUucGhwJztfZmlsZV8gPSAnYmVyYW5kYS5qc29uJw0KICAgIHRyeTpvcy5yZW1vdmUoX2ZpbGVfKQ0KICAgIGV4Y2VwdDpwYXNzDQogICAgcHJpbnQoIiVzIFslc+KAoiVzXSAlc1BSRVNTIENUUkwrQyBUTyBTVE9QIERVTVAiJShILFAsSCxLKSk7ZXhlY19iZXJhbmRhKF91cmxfZGV2Xyxjb29raWVzLF9maWxlXyk7cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhfZmlsZV8pDQpkZWYgZXhlY19iZXJhbmRhKHVybCxjb29raWVzLF9maWxlXyk6DQogICAgb3BlbihfZmlsZV8sJ2EnKTtfcmVxX3Nlc18gPSByZXF1ZXN0cy5TZXNzaW9uKCk7X3JlcV9nZXRfID0gX3JlcV9zZXNfLmdldCh1cmwsY29va2llcz1jb29raWVzLGhlYWRlcnM9aGVhZGVyX25hbWEpO19zb3BfZGV2XyA9IHBhcihfcmVxX2dldF8udGV4dCwnaHRtbC5wYXJzZXInKTtfYnVrYV9maWxlXyA9IG9wZW4oX2ZpbGVfKS5yZWFkKCk7cHJpbnQgKCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiUoSCxQLEgsSyxILGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSxlbmQ9JycpO3N5cy5zdGRvdXQuZmx1c2goKQ0KICAgIHRyeToNCiAgICAgICAgZm9yIF9jaWNpXyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2gzJyk6DQogICAgICAgICAgICBmb3IgX2F6aW12YXVfIGluIF9jaWNpXy5maW5kX2FsbCgnYScsaHJlZj1UcnVlKToNCiAgICAgICAgICAgICAgICBpZiAicHJvZmlsZS5waHAiIGluIF9hemltdmF1Xy5nZXQoJ2hyZWYnKToNCiAgICAgICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICAgICAgX25hbWVfZGV2XyA9IF9hemltdmF1Xy50ZXh0O19pZF9kZXZfID0gIiIuam9pbihiczQucmUuZmluZGFsbCgicHJvZmlsZVwucGhwXD9pZD0oLio/KSYiLF9hemltdmF1Xy5nZXQoImhyZWYiKSkpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBfbmFtZV9kZXZfIGluIF9idWthX2ZpbGVfOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgJy8nIGluIF9pZF9kZXZfOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6b3BlbihfZmlsZV8sJ2ErJykud3JpdGUoJyVz4oCiJXNcbiclKF9pZF9kZXZfLF9uYW1lX2Rldl8pKQ0KICAgICAgICAgICAgICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgICAgIF9uYW1lX2Rldl8gPSBfYXppbXZhdV8udGV4dDtfaWRfZGV2XyA9ICIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoIi8oLio/KVw/IixfYXppbXZhdV8uZ2V0KCJocmVmIikpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgX25hbWVfZGV2XyBpbiBfYnVrYV9maWxlXzpwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICBlbGlmICcvJyBpbiBfaWRfZGV2XzpwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOm9wZW4oX2ZpbGVfLCdhKycpLndyaXRlKCclc+KAoiVzXG4nJShfaWRfZGV2XyxfbmFtZV9kZXZfKSkNCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgICAgIGZvciBfYXppbXZhdV8gaW4gX3NvcF9kZXZfLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOg0KICAgICAgICAgICAgICAgIGlmICdTZWUgTW9yZSBTdG9yaWVzJyBpbiBfYXppbXZhdV8udGV4dDp1cmxfZGV2ID0gJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8nICsgX2F6aW12YXVfLmdldCgnaHJlZicpO2V4ZWNfYmVyYW5kYSh1cmxfZGV2LGNvb2tpZXMsX2ZpbGVfKQ0KICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDpwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykNCg0KZGVmIHBlcm1pbnRhYW5fcGVydGVtYW5hbl9tYXN1ayhjb29raWVzKToNCiAgICBfdXJsX2Rldl8gPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2ZyaWVuZHMvY2VudGVyL3JlcXVlc3RzJztfZmlsZV8gPSAnZnJpZW5kX2xvZ2luLmpzb24nDQogICAgdHJ5Om9zLnJlbW92ZShfZmlsZV8pDQogICAgZXhjZXB0OnBhc3MNCiAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzUFJFU1MgQ1RSTCtDIFRPIFNUT1AgRFVNUCIlKEgsUCxILEspKTtleGVjX3Blcm1pbnRhYW5fcGVydGVtYW5hbl9tYXN1ayhfdXJsX2Rldl8sY29va2llcyxfZmlsZV8pO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIlKEgsUCxILEssbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soX2ZpbGVfKQ0KZGVmIGV4ZWNfcGVybWludGFhbl9wZXJ0ZW1hbmFuX21hc3VrKHVybCxjb29raWVzLF9maWxlXyk6DQogICAgb3BlbihfZmlsZV8sJ2EnKTtfcmVxX3Nlc18gPSByZXF1ZXN0cy5TZXNzaW9uKCk7X3JlcV9nZXRfID0gX3JlcV9zZXNfLmdldCh1cmwsY29va2llcz1jb29raWVzLGhlYWRlcnM9aGVhZGVyX25hbWEpO19zb3BfZGV2XyA9IHBhcihfcmVxX2dldF8udGV4dCwnaHRtbC5wYXJzZXInKTtwcmludCAoIlxyJXMgWyVz4oCiJXNdICVzVEFLSU5HICVzJXMgSUQiJShILFAsSCxLLEgsbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpLGVuZD0nJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQogICAgdHJ5Og0KICAgICAgICBmb3IgX2F6aW12YXVfIGluIF9zb3BfZGV2Xy5maW5kX2FsbCgnYScsaHJlZj1UcnVlKToNCiAgICAgICAgICAgIGlmICcvZnJpZW5kcy9ob3ZlcmNhcmQnIGluIF9hemltdmF1Xy5nZXQoJ2hyZWYnKToNCiAgICAgICAgICAgICAgICB0cnk6X25hbWVfZGV2XyA9IF9hemltdmF1Xy50ZXh0O19pZF9kZXZfID0gIiIuam9pbihiczQucmUuZmluZGFsbCgndWlkPSguKj8pJicsX2F6aW12YXVfLmdldCgnaHJlZicpKSk7b3BlbihfZmlsZV8sJ2ErJykud3JpdGUoJyVz4oCiJXNcbiclKF9pZF9kZXZfLF9uYW1lX2Rldl8pKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgICAgICBlbHNlOnBhc3MNCiAgICAgICAgZm9yIF9hemltdmF1XyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2EnLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICBpZiAnU2VlIE1vcmUnIGluIF9hemltdmF1Xy50ZXh0OnVybF9kZXYgPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLycgKyBfYXppbXZhdV8uZ2V0KCdocmVmJyk7ZXhlY19wZXJtaW50YWFuX3BlcnRlbWFuYW5fbWFzdWsodXJsX2Rldixjb29raWVzLF9maWxlXykNCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6cHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIiUoSCxQLEgsSyxsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhfZmlsZV8pDQoNCg0KZGVmIHBlcm1pbnRhYW5fcGVydGVtYW5hbl9rZWx1YXIoY29va2llcyk6DQogICAgX3VybF9kZXZfID0gJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9mcmllbmRzL2NlbnRlci9yZXF1ZXN0cy9vdXRnb2luZyc7X2ZpbGVfID0gJ2ZyaWVuZF9vdXQuanNvbicNCiAgICB0cnk6b3MucmVtb3ZlKF9maWxlXykNCiAgICBleGNlcHQ6cGFzcw0KICAgIHByaW50KCIlcyBbJXPigKIlc10gJXNQUkVTUyBDVFJMK0MgVE8gU1RPUCBEVU1QIiUoSCxQLEgsSykpO2V4ZWNfcGVybWludGFhbl9wZXJ0ZW1hbmFuX2tlbHVhcihfdXJsX2Rldl8sY29va2llcyxfZmlsZV8pO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIlKEgsUCxILEssbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soX2ZpbGVfKQ0KZGVmIGV4ZWNfcGVybWludGFhbl9wZXJ0ZW1hbmFuX2tlbHVhcih1cmwsY29va2llcyxfZmlsZV8pOg0KICAgIG9wZW4oX2ZpbGVfLCdhJyk7X3JlcV9zZXNfID0gcmVxdWVzdHMuU2Vzc2lvbigpO19yZXFfZ2V0XyA9IF9yZXFfc2VzXy5nZXQodXJsLGNvb2tpZXM9Y29va2llcyxoZWFkZXJzPWhlYWRlcl9uYW1hKTtfc29wX2Rldl8gPSBwYXIoX3JlcV9nZXRfLnRleHQsJ2h0bWwucGFyc2VyJyk7cHJpbnQgKCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiUoSCxQLEgsSyxILGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSxlbmQ9JycpO3N5cy5zdGRvdXQuZmx1c2goKQ0KICAgIHRyeToNCiAgICAgICAgZm9yIF9hemltdmF1XyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2EnLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICBpZiAnL2ZyaWVuZHMvaG92ZXJjYXJkJyBpbiBfYXppbXZhdV8uZ2V0KCdocmVmJyk6DQogICAgICAgICAgICAgICAgdHJ5Ol9uYW1lX2Rldl8gPSBfYXppbXZhdV8udGV4dDtfaWRfZGV2XyA9ICIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoJ3VpZD0oLio/KSYnLF9hemltdmF1Xy5nZXQoJ2hyZWYnKSkpO29wZW4oX2ZpbGVfLCdhKycpLndyaXRlKCclc+KAoiVzXG4nJShfaWRfZGV2XyxfbmFtZV9kZXZfKSkNCiAgICAgICAgICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICAgICAgZWxzZTpwYXNzDQogICAgICAgIGZvciBfYXppbXZhdV8gaW4gX3NvcF9kZXZfLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOg0KICAgICAgICAgICAgaWYgJ1NlZSBNb3JlJyBpbiBfYXppbXZhdV8udGV4dDp1cmxfZGV2ID0gJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8nICsgX2F6aW12YXVfLmdldCgnaHJlZicpO2V4ZWNfcGVybWludGFhbl9wZXJ0ZW1hbmFuX2tlbHVhcih1cmxfZGV2LGNvb2tpZXMsX2ZpbGVfKQ0KICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDpwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiJShILFAsSCxLLGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykNCg0KIyMjIENlayBUYXJnZXQgQ3JhY2sNCmRlZiBjZWtfdGFyZ2V0X2NyYWNrXyhfaWRfKToNCiAgICBvcGVuKCdsaXN0X2lkLnR4dCcsJ2ErJykNCiAgICB0cnk6DQogICAgICAgIF9jZWtfID0gb3BlbignbGlzdF9pZC50eHQnLCdyJykucmVhZCgpDQogICAgICAgIGlmIF9pZF8gaW4gX2Nla186DQogICAgICAgICAgICBpZiBfaWRfID09ICdtZSc6cGFzcw0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICBfY29renpfID0gX2NpY2lfYXppbXZhdV8oJyVzIFslcyElc10gJXNJRCBIQVMgQkVFTiBDUkFDS0VELCBDT05USU5VRT8gW1kvbl0gOiAnJShNLFAsTSxQKSkNCiAgICAgICAgICAgICAgICBpZiBfY29renpfIGluIFsnJywnICddOnBhc3MNCiAgICAgICAgICAgICAgICBlbGlmIF9jb2t6el8gaW4gWycxJywnMDEnLCd5J106cGFzcw0KICAgICAgICAgICAgICAgIGVsaWYgX2Nva3p6XyBpbiBbJzInLCcwJywnbiddOm1lbnUoKQ0KICAgICAgICAgICAgICAgIGVsc2U6cGFzcw0KICAgICAgICBlbHNlOl9hemltdmF1X2RhcHVudGFfKCdsaXN0X2lkLnR4dCcsImErIikud3JpdGUoIiVzXG4iJShfaWRfKSkNCiAgICBleGNlcHQ6cGFzcw0KDQojIyMgR2VuZXJhdGUgUGFzc3dvcmQNCmRlZiBnZW5lcmF0ZTEoX2NpY2lfKToNCiAgICBfYXppbXZhdV89W10NCiAgICBmb3IgaSBpbiBfY2ljaV8uc3BsaXQoIiAiKToNCiAgICAgICAgaWYgbGVuKGkpPDM6Y29udGludWUgDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBpPWkubG93ZXIoKQ0KICAgICAgICAgICAgaWYgbGVuKGkpPT0zIG9yIGxlbihpKT09NCBvciBsZW4oaSk9PTU6X2F6aW12YXVfLmFwcGVuZChpKyIxMjMiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQ1Iik7X2F6aW12YXVfLmFwcGVuZChpKyIxMjM0NTY3ODkiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQ1NiIpDQogICAgICAgICAgICBlbGlmIGxlbihpKT49NjpfYXppbXZhdV8uYXBwZW5kKGkpO19hemltdmF1Xy5hcHBlbmQoaSsiMTIzIik7X2F6aW12YXVfLmFwcGVuZChpKyIxMjM0NSIpO19hemltdmF1Xy5hcHBlbmQoaSsiMTIzNDU2Nzg5Iik7X2F6aW12YXVfLmFwcGVuZChpKyIxMjM0Iik7X2F6aW12YXVfLmFwcGVuZChpKyIxMjM0NTYiKQ0KICAgICAgICAgICAgZWxzZTpjb250aW51ZQ0KICAgIF9hemltdmF1Xy5hcHBlbmQoX2NpY2lfLmxvd2VyKCkpDQogICAgcmV0dXJuIF9hemltdmF1Xw0KDQpkZWYgZ2VuZXJhdGUyKF9jaWNpXyk6DQogICAgX2F6aW12YXVfPVtdDQogICAgZm9yIGkgaW4gX2NpY2lfLnNwbGl0KCIgIik6DQogICAgICAgIGlmIGxlbihpKTwzOmNvbnRpbnVlDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBpPWkubG93ZXIoKQ0KICAgICAgICAgICAgaWYgbGVuKGkpPT0zIG9yIGxlbihpKT09NCBvciBsZW4oaSk9PTU6X2F6aW12YXVfLmFwcGVuZChpKyIxMjMiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQ1IikNCiAgICAgICAgICAgIGVsc2U6X2F6aW12YXVfLmFwcGVuZChpKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyIik7X2F6aW12YXVfLmFwcGVuZChpKyIyMDAwIik7X2F6aW12YXVfLmFwcGVuZChpKyIxMjM0Iik7X2F6aW12YXVfLmFwcGVuZChpKyIxMTIyMzM0NCIpDQogICAgX2F6aW12YXVfLmFwcGVuZChfY2ljaV8ubG93ZXIoKSk7X2F6aW12YXVfLmFwcGVuZChfY2ljaV8ubG93ZXIoKS5zcGxpdCgiICIpWzBdK19jaWNpXy5sb3dlcigpLnNwbGl0KCIgIilbMV0pDQogICAgcmV0dXJuIF9hemltdmF1Xw0KDQpkZWYgZ2VuZXJhdGUzKF9jaWNpXyk6DQogICAgX2F6aW12YXVfPVtdDQogICAgZm9yIGkgaW4gX2NpY2lfLnNwbGl0KCIgIik6DQogICAgICAgIGlmIGxlbihpKTwzOmNvbnRpbnVlDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBpPWkubG93ZXIoKQ0KICAgICAgICAgICAgaWYgbGVuKGkpPT0zIG9yIGxlbihpKT09NCBvciBsZW4oaSk9PTU6X2F6aW12YXVfLmFwcGVuZChpKyIxMjMiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQ1Iik7X2F6aW12YXVfLmFwcGVuZChpKyIyMDAyIikNCiAgICAgICAgICAgIGVsc2U6X2F6aW12YXVfLmFwcGVuZChpKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQ1Njc4Iik7X2F6aW12YXVfLmFwcGVuZChpKyIxMiIpO19hemltdmF1Xy5hcHBlbmQoaSsiMTIzIik7X2F6aW12YXVfLmFwcGVuZChpKyIxMjM0Iik7X2F6aW12YXVfLmFwcGVuZChpKyIxMjM0NSIpO19hemltdmF1Xy5hcHBlbmQoaS51cHBlcigpKyIxMjMiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjIwMDEiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQ1Njc4OSIpDQogICAgX2F6aW12YXVfLmFwcGVuZChfY2ljaV8ubG93ZXIoKSk7X2F6aW12YXVfLmFwcGVuZChfY2ljaV8ubG93ZXIoKS5zcGxpdCgiICIpWzBdK19jaWNpXy5sb3dlcigpLnNwbGl0KCIgIilbMV0pO19hemltdmF1Xy5hcHBlbmQoX2NpY2lfLmxvd2VyKCkuc3BsaXQoIiAiKVswXStfY2ljaV8ubG93ZXIoKS5zcGxpdCgiICIpWzFdKyIxMiIpO19hemltdmF1Xy5hcHBlbmQoX2NpY2lfLmxvd2VyKCkuc3BsaXQoIiAiKVswXStfY2ljaV8ubG93ZXIoKS5zcGxpdCgiICIpWzFdKyIxMjMiKTtfYXppbXZhdV8uYXBwZW5kKCIxMTIyMzM0NDU1IikNCiAgICByZXR1cm4gX2F6aW12YXVfDQoNCg0KZGVmIGdlbmVyYXRlNChfY2ljaV8pOg0KICAgIF9hemltdmF1Xz1bXQ0KICAgIHBzID0gX2F6aW12YXVfZGFwdW50YV8oJ3Bhc3MudHh0JywncicpLnJlYWQoKQ0KICAgIHBwID0gX2F6aW12YXVfZGFwdW50YV8oJ2RpZ2l0cGFzcy50eHQnLCdyJykucmVhZCgpDQogICAgZm9yIGkgaW4gX2NpY2lfLnNwbGl0KCIgIik6ICANCiAgICAgICAgaT1pLmxvd2VyKCkNCiAgICAgICAgaWYgbGVuKGkpPDM6Y29udGludWUNCiAgICAgICAgZWxpZiBsZW4oaSk9PTMgb3IgbGVuKGkpPT00IG9yIGxlbihpKT09NTpfYXppbXZhdV8uYXBwZW5kKGkrIjEyMyIpO19hemltdmF1Xy5hcHBlbmQoaSsiMTIzNDUiKQ0KICAgICAgICBlbHNlOl9hemltdmF1Xy5hcHBlbmQoaSk7X2F6aW12YXVfLmFwcGVuZChpKyIxMjMiKTtfYXppbXZhdV8uYXBwZW5kKGkrIjEyMzQ1IikNCiAgICBpZiBwcCBpbiBbJycsJyAnLCcgICddOnBhc3MNCiAgICBlbHNlOg0KICAgICAgICBmb3IgaSBpbiBfY2ljaV8uc3BsaXQoIiAiKTogIA0KICAgICAgICAgICAgaT1pLmxvd2VyKCkNCiAgICAgICAgICAgIGZvciB4IGluIHBwLnNwbGl0KCcsJyk6X2F6aW12YXVfLmFwcGVuZChpK3gpDQogICAgaWYgcHMgaW4gWycnLCcgJywnICAnXTpwYXNzDQogICAgZWxzZToNCiAgICAgICAgZm9yIHogaW4gcHMuc3BsaXQoJywnKTpfYXppbXZhdV8uYXBwZW5kKHopDQogICAgX2F6aW12YXVfLmFwcGVuZChfY2ljaV8ubG93ZXIoKSkNCiAgICByZXR1cm4gX2F6aW12YXVfDQpkZWYgdGFtYmFoX3Bhc3MoKToNCiAgICBwcmludCgnJXMgJyUoTykpO3ByaW50KCclcyBbJXPigKIlc10gJXNFWEFNUExFIDogJTc3ODg5OSwxMjM0NTYsMTAyMDMwLDc4Njc4NiclKEgsUCxILEssSCkpO2N1eSA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBNQU5VQUwgU1VQUExFTUVOVEFMIFBBU1MgWzEgV09SRF0gOiAnJShILFAsSCxLKSk7Z2ggPSBfYXppbXZhdV9kYXB1bnRhXygncGFzcy50eHQnLCd3Jyk7Z2gud3JpdGUoY3V5KTtnaC5jbG9zZQ0KZGVmIHRhbWJhaF9wYXNzX2FuZ2thKCk6DQogICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc0VYQU1QTEUgOiAlczE0Myw3ODYsZ2FtaW5nJyUoSCxQLEgsSyxIKSk7Y295ID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0VOVEVSIEFERElUSU9OQUwgUEFTUyBCRUhJTkQgTkFNRSA6ICclKEgsUCxILEspKTt4eSA9IF9hemltdmF1X2RhcHVudGFfKCdkaWdpdHBhc3MudHh0JywndycpO3h5LndyaXRlKGNveSk7eHkuY2xvc2UNCiAgICANCiMjIyBMb2dnZXIgQ3JhY2sNCmRlZiBsb2dfYXBpXzEoZW0scGFzKToNCiAgICB1YSA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCdyJykucmVhZCgpDQogICAgciA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KICAgIGhlYWRlciA9IHsieC1mYi1jb25uZWN0aW9uLWJhbmR3aWR0aCI6IHN0cihyYW5kb20ucmFuZGludCgyMDAwMDAwMC4wLCAzMDAwMDAwMC4wKSksIngtZmItc2ltLWhuaSI6IHN0cihyYW5kb20ucmFuZGludCgyMDAwMCwgNDAwMDApKSwieC1mYi1uZXQtaG5pIjogc3RyKHJhbmRvbS5yYW5kaW50KDIwMDAwLCA0MDAwMCkpLCJ4LWZiLWNvbm5lY3Rpb24tcXVhbGl0eSI6ICJFWENFTExFTlQiLCJ4LWZiLWNvbm5lY3Rpb24tdHlwZSI6ICJjZWxsLkNUUmFkaW9BY2Nlc3NUZWNobm9sb2d5SFNEUEEiLCJ1c2VyLWFnZW50IjogdWEsImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiLCJ4LWZiLWh0dHAtZW5naW5lIjogIkxpZ2VyIn0NCiAgICByZXNwb25zZSA9IHIuZ2V0KCdodHRwczovL2ItYXBpLmZhY2Vib29rLmNvbS9tZXRob2QvYXV0aC5sb2dpbj9mb3JtYXQ9anNvbiZlbWFpbD0nICsgZW0gKyAnJnBhc3N3b3JkPScgKyBwYXMgKyAnJmNyZWRlbnRpYWxzX3R5cGU9ZGV2aWNlX2Jhc2VkX2xvZ2luX3Bhc3N3b3JkJmdlbmVyYXRlX3Nlc3Npb25fY29va2llcz0xJmVycm9yX2RldGFpbF90eXBlPWJ1dHRvbl93aXRoX2Rpc2FibGVkJnNvdXJjZT1kZXZpY2VfYmFzZWRfbG9naW4mbWV0YV9pbmZfZmJtZXRhPSUyMCZjdXJyZW50bHlfbG9nZ2VkX2luX3VzZXJpZD0wJm1ldGhvZD1HRVQmbG9jYWxlPWVuX1VTJmNsaWVudF9jb3VudHJ5X2NvZGU9VVMmZmJfYXBpX2NhbGxlcl9jbGFzcz1jb20uZmFjZWJvb2suZm9zLmhlYWRlcnN2Mi5mYjRhb3JjYS5IZWFkZXJzVjJDb25maWdGZXRjaFJlcXVlc3RIYW5kbGVyJmFjY2Vzc190b2tlbj0zNTA2ODU1MzE3Mjh8NjJmOGNlOWY3NGIxMmY4NGMxMjNjYzIzNDM3YTRhMzImZmJfYXBpX3JlcV9mcmllbmRseV9uYW1lPWF1dGhlbnRpY2F0ZSZjcGw9dHJ1ZScsIGhlYWRlcnM9aGVhZGVyKQ0KICAgIGlmICdzZXNzaW9uX2tleScgaW4gcmVzcG9uc2UudGV4dCBhbmQgJ0VBQUEnIGluIHJlc3BvbnNlLnRleHQ6cmV0dXJuIHsic3RhdHVzIjoib2siLCJlbWFpbCI6ZW0sInBhc3MiOnBhc30NCiAgICBlbGlmICd3d3cuZmFjZWJvb2suY29tJyBpbiByZXNwb25zZS5qc29uKClbJ2Vycm9yX21zZyddOnJldHVybiB7InN0YXR1cyI6ImNwIiwiZW1haWwiOmVtLCJwYXNzIjpwYXN9DQogICAgZWxzZTpyZXR1cm4geyJzdGF0dXMiOiJlcnJvciIsImVtYWlsIjplbSwicGFzcyI6cGFzfQ0KZGVmIGxvZ19hcGlfMihlbSxwYXMpOg0KICAgIHVhID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3InKS5yZWFkKCkNCiAgICByID0gcmVxdWVzdHMuU2Vzc2lvbigpDQogICAgaGVhZGVyID0geyJ4LWZiLWNvbm5lY3Rpb24tYmFuZHdpZHRoIjogc3RyKHJhbmRvbS5yYW5kaW50KDIwMDAwMDAwLjAsIDMwMDAwMDAwLjApKSwieC1mYi1zaW0taG5pIjogc3RyKHJhbmRvbS5yYW5kaW50KDIwMDAwLCA0MDAwMCkpLCJ4LWZiLW5ldC1obmkiOiBzdHIocmFuZG9tLnJhbmRpbnQoMjAwMDAsIDQwMDAwKSksIngtZmItY29ubmVjdGlvbi1xdWFsaXR5IjogIkVYQ0VMTEVOVCIsIngtZmItY29ubmVjdGlvbi10eXBlIjogImNlbGwuQ1RSYWRpb0FjY2Vzc1RlY2hub2xvZ3lIU0RQQSIsInVzZXItYWdlbnQiOiB1YSwiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIsIngtZmItaHR0cC1lbmdpbmUiOiAiTGlnZXIifQ0KICAgIHBhcmFtID0geydhY2Nlc3NfdG9rZW4nOiAnMzUwNjg1NTMxNzI4JTdDNjJmOGNlOWY3NGIxMmY4NGMxMjNjYzIzNDM3YTRhMzInLCAnZm9ybWF0JzogJ2pzb24nLCAnc2RrX3ZlcnNpb24nOiAnMicsICdlbWFpbCc6IGVtLCAnbG9jYWxlJzogJ2VuX1VTJywgJ3Bhc3N3b3JkJzogcGFzLCAnc2RrJzogJ2lvcycsICdnZW5lcmF0ZV9zZXNzaW9uX2Nvb2tpZXMnOiAnMScsICdzaWcnOiczZjU1NWY5OWZiNjFmY2Q3YWEwYzQ0ZjU4ZjUyMmVmNid9DQogICAgYXBpID0gJ2h0dHBzOi8vYi1hcGkuZmFjZWJvb2suY29tL21ldGhvZC9hdXRoLmxvZ2luJw0KICAgIHJlc3BvbnNlID0gci5nZXQoYXBpLCBwYXJhbXM9cGFyYW0sIGhlYWRlcnM9aGVhZGVyKQ0KICAgIGlmICdzZXNzaW9uX2tleScgaW4gcmVzcG9uc2UudGV4dCBhbmQgJ0VBQUEnIGluIHJlc3BvbnNlLnRleHQ6cmV0dXJuIHsic3RhdHVzIjoib2siLCJlbWFpbCI6ZW0sInBhc3MiOnBhc30NCiAgICBlbGlmICd3d3cuZmFjZWJvb2suY29tJyBpbiByZXNwb25zZS5qc29uKClbJ2Vycm9yX21zZyddOnJldHVybiB7InN0YXR1cyI6ImNwIiwiZW1haWwiOmVtLCJwYXNzIjpwYXN9DQogICAgZWxzZTpyZXR1cm4geyJzdGF0dXMiOiJlcnJvciIsImVtYWlsIjplbSwicGFzcyI6cGFzfQ0KZGVmIGxvZ19tYmFzaWNfMShlbSxwYXMpOg0KICAgIHVhID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3InKS5yZWFkKCkNCiAgICByID0gcmVxdWVzdHMuU2Vzc2lvbigpDQogICAgci5oZWFkZXJzLnVwZGF0ZSh7Ikhvc3QiOiJtYmFzaWMuZmFjZWJvb2suY29tIiwiY2FjaGUtY29udHJvbCI6Im1heC1hZ2U9MCIsInVwZ3JhZGUtaW5zZWN1cmUtcmVxdWVzdHMiOiIxIiwidXNlci1hZ2VudCI6dWEsImFjY2VwdCI6InRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgiLCJhY2NlcHQtZW5jb2RpbmciOiJnemlwLCBkZWZsYXRlIiwiYWNjZXB0LWxhbmd1YWdlIjoiZW4tR0IsZW4tVVM7cT0wLjksZW47cT0wLjgsYm47cT0wLjcifSkNCiAgICBwID0gci5nZXQoImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8iKQ0KICAgIGIgPSByLnBvc3QoImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9sb2dpbi5waHAiLCBkYXRhPXsiZW1haWwiOiBlbSwgInBhc3MiOiBwYXMsICJsb2dpbiI6ICJzdWJtaXQifSkNCiAgICBfcmF3X2Nvb2tpZXNfID0gKCI7Iikuam9pbihbICIlcz0lcyIgJSAoa2V5LCB2YWx1ZSkgZm9yIGtleSwgdmFsdWUgaW4gci5jb29raWVzLmdldF9kaWN0KCkuaXRlbXMoKSBdKQ0KICAgIGlmICJjX3VzZXIiIGluIHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKTpyZXR1cm4geyJzdGF0dXMiOiJvayIsImVtYWlsIjplbSwicGFzcyI6cGFzLCJjb29raWVzIjpfcmF3X2Nvb2tpZXNffQ0KICAgIGVsaWYgImNoZWNrcG9pbnQiIGluIHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKTpyZXR1cm4geyJzdGF0dXMiOiJjcCIsImVtYWlsIjplbSwicGFzcyI6cGFzLCJjb29raWVzIjpfcmF3X2Nvb2tpZXNffQ0KICAgIGVsc2U6cmV0dXJuIHsic3RhdHVzIjoiZXJyb3IiLCJlbWFpbCI6ZW0sInBhc3MiOnBhc30NCmRlZiBsb2dfbWJhc2ljXzIoZW0scGFzKToNCiAgICB1YSA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCdyJykucmVhZCgpDQogICAgciA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KICAgIHIuaGVhZGVycy51cGRhdGUoeyJIb3N0IjoibWJhc2ljLmZhY2Vib29rLmNvbSIsImNhY2hlLWNvbnRyb2wiOiJtYXgtYWdlPTAiLCJ1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzIjoiMSIsInVzZXItYWdlbnQiOnVhLCJhY2NlcHQiOiJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS93ZWJwLGltYWdlL2FwbmcsKi8qO3E9MC44IiwiYWNjZXB0LWVuY29kaW5nIjoiZ3ppcCwgZGVmbGF0ZSIsImFjY2VwdC1sYW5ndWFnZSI6ImVuLUdCLGVuLVVTO3E9MC45LGVuO3E9MC44LGJuO3E9MC43In0pDQogICAgcCA9IHIuZ2V0KCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vIikNCiAgICBiID0gYnM0LkJlYXV0aWZ1bFNvdXAocC50ZXh0LCJodG1sLnBhcnNlciIpDQogICAgbWV0YT0iIi5qb2luKGJzNC5yZS5maW5kYWxsKCdkdHNnIjpceyJ0b2tlbiI6IiguKj8pIicscC50ZXh0KSkNCiAgICBkYXRhPXt9DQogICAgZm9yIGkgaW4gYigiaW5wdXQiKToNCiAgICAgICAgaWYgaS5nZXQoInZhbHVlIikgaXMgTm9uZToNCiAgICAgICAgICAgIGlmIGkuZ2V0KCJuYW1lIik9PSJlbWFpbCI6ZGF0YS51cGRhdGUoeyJlbWFpbCI6ZW19KQ0KICAgICAgICAgICAgZWxpZiBpLmdldCgibmFtZSIpPT0icGFzcyI6ZGF0YS51cGRhdGUoeyJwYXNzIjpwYXN9KQ0KICAgICAgICAgICAgZWxzZTpkYXRhLnVwZGF0ZSh7aS5nZXQoIm5hbWUiKToiIn0pDQogICAgICAgIGVsc2U6ZGF0YS51cGRhdGUoe2kuZ2V0KCJuYW1lIik6aS5nZXQoInZhbHVlIil9KQ0KICAgIGRhdGEudXBkYXRlKHsiZmJfZHRzZyI6bWV0YSwibV9zZXNzIjoiIiwiX191c2VyIjoiMCIsIl9fcmVxIjoiZCIsIl9fY3NyIjoiIiwiX19hIjoiIiwiX19keW4iOiIiLCJlbmNwYXNzIjoiIn0pDQogICAgci5oZWFkZXJzLnVwZGF0ZSh7InJlZmVyZXIiOiJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vbG9naW4vP25leHQmcmVmPWRibCZmbCZyZWZpZD04In0pDQogICAgcG8gPSByLnBvc3QoImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9sb2dpbi9kZXZpY2UtYmFzZWQvbG9naW4vYXN5bmMvP3JlZnNyYz1odHRwcyUzQSUyRiUyRm0uZmFjZWJvb2suY29tJTJGbG9naW4lMkYlM0ZyZWYlM0RkYmwmbHd2PTEwMCIsZGF0YT1kYXRhKS50ZXh0DQogICAgX3Jhd19jb29raWVzXyA9ICgiOyIpLmpvaW4oWyAiJXM9JXMiICUgKGtleSwgdmFsdWUpIGZvciBrZXksIHZhbHVlIGluIHIuY29va2llcy5nZXRfZGljdCgpLml0ZW1zKCkgXSkNCiAgICBpZiAiY191c2VyIiBpbiBsaXN0KHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKSk6cmV0dXJuIHsic3RhdHVzIjoib2siLCJlbWFpbCI6ZW0sInBhc3MiOnBhcywiY29va2llcyI6X3Jhd19jb29raWVzX30NCiAgICBlbGlmICJjaGVja3BvaW50IiBpbiBsaXN0KHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKSk6cmV0dXJuIHsic3RhdHVzIjoiY3AiLCJlbWFpbCI6ZW0sInBhc3MiOnBhcywiY29va2llcyI6X3Jhd19jb29raWVzX30NCiAgICBlbHNlOnJldHVybiB7InN0YXR1cyI6ImVycm9yIiwiZW1haWwiOmVtLCJwYXNzIjpwYXN9DQpkZWYgbG9nX21vYmlsZV8xKGVtLHBhcyk6DQogICAgdWEgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywncicpLnJlYWQoKQ0KICAgIHIgPSByZXF1ZXN0cy5TZXNzaW9uKCkNCiAgICByLmhlYWRlcnMudXBkYXRlKHsiSG9zdCI6Im0uZmFjZWJvb2suY29tIiwiY2FjaGUtY29udHJvbCI6Im1heC1hZ2U9MCIsInVwZ3JhZGUtaW5zZWN1cmUtcmVxdWVzdHMiOiIxIiwidXNlci1hZ2VudCI6dWEsImFjY2VwdCI6InRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgiLCJhY2NlcHQtZW5jb2RpbmciOiJnemlwLCBkZWZsYXRlIiwiYWNjZXB0LWxhbmd1YWdlIjoiZW4tR0IsZW4tVVM7cT0wLjksZW47cT0wLjgsYm47cT0wLjcifSkNCiAgICBwID0gci5nZXQoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vIikNCiAgICBiID0gci5wb3N0KCJodHRwczovL20uZmFjZWJvb2suY29tL2xvZ2luLnBocCIsIGRhdGE9eyJlbWFpbCI6IGVtLCAicGFzcyI6IHBhcywgImxvZ2luIjogInN1Ym1pdCJ9KQ0KICAgIF9yYXdfY29va2llc18gPSAoIjsiKS5qb2luKFsgIiVzPSVzIiAlIChrZXksIHZhbHVlKSBmb3Iga2V5LCB2YWx1ZSBpbiByLmNvb2tpZXMuZ2V0X2RpY3QoKS5pdGVtcygpIF0pDQogICAgaWYgImNfdXNlciIgaW4gci5jb29raWVzLmdldF9kaWN0KCkua2V5cygpOnJldHVybiB7InN0YXR1cyI6Im9rIiwiZW1haWwiOmVtLCJwYXNzIjpwYXMsImNvb2tpZXMiOl9yYXdfY29va2llc199DQogICAgZWxpZiAiY2hlY2twb2ludCIgaW4gci5jb29raWVzLmdldF9kaWN0KCkua2V5cygpOnJldHVybiB7InN0YXR1cyI6ImNwIiwiZW1haWwiOmVtLCJwYXNzIjpwYXMsImNvb2tpZXMiOl9yYXdfY29va2llc199DQogICAgZWxzZTpyZXR1cm4geyJzdGF0dXMiOiJlcnJvciIsImVtYWlsIjplbSwicGFzcyI6cGFzfQ0KZGVmIGxvZ19tb2JpbGVfMihlbSxwYXMpOg0KICAgIHVhID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsJ3InKS5yZWFkKCkNCiAgICByID0gcmVxdWVzdHMuU2Vzc2lvbigpDQogICAgci5oZWFkZXJzLnVwZGF0ZSh7Ikhvc3QiOiJtLmZhY2Vib29rLmNvbSIsImNhY2hlLWNvbnRyb2wiOiJtYXgtYWdlPTAiLCJ1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzIjoiMSIsInVzZXItYWdlbnQiOnVhLCJhY2NlcHQiOiJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS93ZWJwLGltYWdlL2FwbmcsKi8qO3E9MC44IiwiYWNjZXB0LWVuY29kaW5nIjoiZ3ppcCwgZGVmbGF0ZSIsImFjY2VwdC1sYW5ndWFnZSI6ImVuLUdCLGVuLVVTO3E9MC45LGVuO3E9MC44LGJuO3E9MC43In0pDQogICAgcCA9IHIuZ2V0KCJodHRwczovL20uZmFjZWJvb2suY29tLyIpDQogICAgYiA9IGJzNC5CZWF1dGlmdWxTb3VwKHAudGV4dCwiaHRtbC5wYXJzZXIiKQ0KICAgIG1ldGE9IiIuam9pbihiczQucmUuZmluZGFsbCgnZHRzZyI6XHsidG9rZW4iOiIoLio/KSInLHAudGV4dCkpDQogICAgZGF0YT17fQ0KICAgIGZvciBpIGluIGIoImlucHV0Iik6DQogICAgICAgIGlmIGkuZ2V0KCJ2YWx1ZSIpIGlzIE5vbmU6DQogICAgICAgICAgICBpZiBpLmdldCgibmFtZSIpPT0iZW1haWwiOmRhdGEudXBkYXRlKHsiZW1haWwiOmVtfSkNCiAgICAgICAgICAgIGVsaWYgaS5nZXQoIm5hbWUiKT09InBhc3MiOmRhdGEudXBkYXRlKHsicGFzcyI6cGFzfSkNCiAgICAgICAgICAgIGVsc2U6ZGF0YS51cGRhdGUoe2kuZ2V0KCJuYW1lIik6IiJ9KQ0KICAgICAgICBlbHNlOmRhdGEudXBkYXRlKHtpLmdldCgibmFtZSIpOmkuZ2V0KCJ2YWx1ZSIpfSkNCiAgICBkYXRhLnVwZGF0ZSh7ImZiX2R0c2ciOm1ldGEsIm1fc2VzcyI6IiIsIl9fdXNlciI6IjAiLCJfX3JlcSI6ImQiLCJfX2NzciI6IiIsIl9fYSI6IiIsIl9fZHluIjoiIiwiZW5jcGFzcyI6IiJ9KQ0KICAgIHIuaGVhZGVycy51cGRhdGUoeyJyZWZlcmVyIjoiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS9sb2dpbi8/bmV4dCZyZWY9ZGJsJmZsJnJlZmlkPTgifSkNCiAgICBwbyA9IHIucG9zdCgiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS9sb2dpbi9kZXZpY2UtYmFzZWQvbG9naW4vYXN5bmMvP3JlZnNyYz1odHRwcyUzQSUyRiUyRm0uZmFjZWJvb2suY29tJTJGbG9naW4lMkYlM0ZyZWYlM0RkYmwmbHd2PTEwMCIsZGF0YT1kYXRhKS50ZXh0DQogICAgX3Jhd19jb29raWVzXyA9ICgiOyIpLmpvaW4oWyAiJXM9JXMiICUgKGtleSwgdmFsdWUpIGZvciBrZXksIHZhbHVlIGluIHIuY29va2llcy5nZXRfZGljdCgpLml0ZW1zKCkgXSkNCiAgICBpZiAiY191c2VyIiBpbiBsaXN0KHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKSk6cmV0dXJuIHsic3RhdHVzIjoib2siLCJlbWFpbCI6ZW0sInBhc3MiOnBhcywiY29va2llcyI6X3Jhd19jb29raWVzX30NCiAgICBlbGlmICJjaGVja3BvaW50IiBpbiBsaXN0KHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKSk6cmV0dXJuIHsic3RhdHVzIjoiY3AiLCJlbWFpbCI6ZW0sInBhc3MiOnBhcywiY29va2llcyI6X3Jhd19jb29raWVzX30NCiAgICBlbHNlOnJldHVybiB7InN0YXR1cyI6ImVycm9yIiwiZW1haWwiOmVtLCJwYXNzIjpwYXN9DQoNCiMjIyBDaGVjayBPcHNpDQpkZWYgY2VrX29wc2kodXNlcixwdyxmb3JtYXQpOg0KICAgIF9yZXFfc2VzXyA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KICAgIHRyeTpjZWtfZGV2X29wc2kgICAgICAgICAgPSBvcGVuKCdvcHRpb25fLnR4dCcsJ3InKS5yZWFkKCkNCiAgICBleGNlcHQ6Y2VrX2Rldl9vcHNpICAgICAgID0gJ251bGwnDQogICAgdHJ5Ol9hdXRvX2NoYW5nZV9wYXNzXyAgICA9IG9wZW4oJ2F1dG9fZ2FudGkudHh0JywncicpLnJlYWQoKQ0KICAgIGV4Y2VwdDpfYXV0b19jaGFuZ2VfcGFzc18gPSAnWWVzJw0KICAgIHRyeTpjZWtfcGlsaWhfb3BzaSAgICAgICAgPSBvcGVuKCdtdW5jdWxfb3BzaS50eHQnLCdyJykucmVhZCgpDQogICAgZXhjZXB0OmNla19waWxpaF9vcHNpICAgICA9ICdObycNCiAgICBfcmVxX3Nlc18uaGVhZGVycy51cGRhdGUoeyJIb3N0IjoibWJhc2ljLmZhY2Vib29rLmNvbSIsImFjY2VwdCI6InRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL2F2aWYsaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCxhcHBsaWNhdGlvbi9zaWduZWQtZXhjaGFuZ2U7dj1iMztxPTAuOSIsImFjY2VwdC1lbmNvZGluZyI6Imd6aXAsIGRlZmxhdGUiLCJhY2NlcHQtbGFuZ3VhZ2UiOiJlbi1HQixlbi1VUztxPTAuOSIsInJlZmVyZXIiOiJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vIiwidXNlci1hZ2VudCI6dWFfeGlhb21pfSk7X3NvcF9kZXZfID0gcGFyKF9yZXFfc2VzXy5nZXQoaG9zdCsiL2xvZ2luLz9uZXh0JnJlZj1kYmwmZmwmcmVmaWQ9OCIpLnRleHQsImh0bWwucGFyc2VyIik7X2xpbmt1cmxfID0gX3NvcF9kZXZfLmZpbmQoImZvcm0iLHsibWV0aG9kIjoicG9zdCJ9KQ0KICAgIGZvciBfY2ljaV8gaW4gX3NvcF9kZXZfKCJpbnB1dCIpOmRhdGFfMS51cGRhdGUoe19jaWNpXy5nZXQoIm5hbWUiKTpfY2ljaV8uZ2V0KCJ2YWx1ZSIpfSkNCiAgICBkYXRhXzEudXBkYXRlKHsiZW1haWwiOnVzZXIsInBhc3MiOnB3fSk7X3VybF9wb3N0XyA9IF9yZXFfc2VzXy5wb3N0KGhvc3QrX2xpbmt1cmxfLmdldCgiYWN0aW9uIiksZGF0YT1kYXRhXzEpO19yZXNwb25zZV8gPSBwYXIoX3VybF9wb3N0Xy50ZXh0LCAiaHRtbC5wYXJzZXIiKQ0KICAgIGlmICJjX3VzZXIiIGluIF9yZXFfc2VzXy5jb29raWVzLmdldF9kaWN0KCk6DQogICAgICAgIGlmICJ5b3VyIGFjY291bnQgaGFzIGJlZW4gbG9ja2VkIiBpbiBfdXJsX3Bvc3RfLnRleHQ6cGFzcw0KICAgICAgICBlbHNlOl9jb29raWVzXyA9ICcnLmpvaW4oX3JlcV9zZXNfLmNvb2tpZXMuZ2V0X2RpY3QoKSk7X3Jlc3VsdF9va18gPSAiXHIgJXNbJVNVQ0NFU1NGVUxMJXNdICVzIOKAoiAlcyVzJXMgICAgICAgICAgIiUoSCxQLEgsdXNlcixwdyx0YWh1bih1c2VyKSxQKTtjZWtfYXBrKF9yZXN1bHRfb2tfLGN2dF9jb29raWVzKF9jb29raWVzXykpDQogICAgZWxpZiAiY2hlY2twb2ludCIgaW4gX3JlcV9zZXNfLmNvb2tpZXMuZ2V0X2RpY3QoKToNCiAgICAgICAgX3JhdHlhXyA9IDA7anVtbGFoX29wc2kgID0gW107X3RpdGxlX2Rldl8gPSByZS5maW5kYWxsKCJcPHRpdGxlPiguKj8pPFwvdGl0bGU+IixzdHIoX3Jlc3BvbnNlXykpO2xpbmtfMiA9IF9yZXNwb25zZV8uZmluZCgiZm9ybSIseyJtZXRob2QiOiJwb3N0In0pO2xpc3RfaW5wdXQgPSBbJ2ZiX2R0c2cnLCdqYXpvZXN0JywnY2hlY2twb2ludF9kYXRhJywnc3VibWl0W0NvbnRpbnVlXScsJ25oJ10NCiAgICAgICAgZm9yIF9hemltdmF1XyBpbiBfcmVzcG9uc2VfKCJpbnB1dCIpOg0KICAgICAgICAgICAgaWYgX2F6aW12YXVfLmdldCgibmFtZSIpIGluIGxpc3RfaW5wdXQ6ZGF0YV8yLnVwZGF0ZSh7X2F6aW12YXVfLmdldCgibmFtZSIpOl9hemltdmF1Xy5nZXQoInZhbHVlIil9KQ0KICAgICAgICBfcmVxX2FjdF8gPSBfcmVxX3Nlc18ucG9zdChob3N0K2xpbmtfMi5nZXQoImFjdGlvbiIpLGRhdGE9ZGF0YV8yKTtfcmVzcG9uc2UyXyA9IHBhcihfcmVxX2FjdF8udGV4dCwiaHRtbC5wYXJzZXIiKTtfY2hlY2tfb3BzaV8gID0gW19zYWxzYWJpbGFfLnRleHQgZm9yIF9zYWxzYWJpbGFfIGluIF9yZXNwb25zZTJfLmZpbmRfYWxsKCJvcHRpb24iKV0NCiAgICAgICAgaWYgbGVuKF9jaGVja19vcHNpXyk9PTA6DQogICAgICAgICAgICBpZiAiQ2hlY2sgdGhlIGxvZ2luIGRldGFpbHMgc2hvd24uIFdhcyBpdCB5b3U/IiBpbiBfdGl0bGVfZGV2XzoNCiAgICAgICAgICAgICAgICBpZiBfYXV0b19jaGFuZ2VfcGFzc18gPT0gJ1llcyc6Y2hhbmdlX3Bhc3ModXNlcixfcmVxX3Nlc18sX3Jlc3BvbnNlXyxsaW5rXzIpDQogICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgaWYgY2VrX3BpbGloX29wc2kgPT0gJ1llcyc6cHJpbnQoZm9ybWF0KTtwcmludCgnICAgJXPigKIgJXNPTkUgVEFQIEFDQ09VTlQnJShILFApKTtwcmludCgiIikNCiAgICAgICAgICAgICAgICAgICAgZWxzZTpwcmludChmb3JtYXQpO3ByaW50KCcgICAlc+KAoiAlc09ORSBUQVAgQUNDT1VOVCclKEgsUCkpDQogICAgICAgICAgICBlbHNlOnBhc3MNCiAgICAgICAgZWxpZiBsZW4oX2NoZWNrX29wc2lfKSE9MDoNCiAgICAgICAgICAgIGlmIGNla19waWxpaF9vcHNpID09ICdZZXMnOg0KICAgICAgICAgICAgICAgIGZvciBfYXN1XyBpbiByYW5nZShsZW4oX2NoZWNrX29wc2lfKSk6X3JhdHlhXyArPSAxO2p1bWxhaF9vcHNpLmFwcGVuZCgiXG4gICAgICIrUCtzdHIoX2FzdV8rMSkrIi4gIitfY2hlY2tfb3BzaV9bX2FzdV9dKyIgIikNCiAgICAgICAgICAgICAgICBqdW1vcCA9ICgnJXMgICBIRVJFIEFSRSAlcyBPUFRJT05TIDogJyUoUCxzdHIobGVuKGp1bWxhaF9vcHNpKSkpKTtwcmludChmb3JtYXQpO3ByaW50KGp1bW9wKyIiLmpvaW4oanVtbGFoX29wc2kpKTtwcmludCgiIikNCiAgICAgICAgICAgIGVsc2U6cHJpbnQoZm9ybWF0KQ0KICAgIGVsc2U6DQogICAgICAgIGlmICdyZXN1bHQnIGluIGNla19kZXZfb3BzaTpwcmludChmb3JtYXQpO3ByaW50KCIlcyAgIFslcyElc10gJXNQQVNTV09SRCBIQVMgQ0hBTkdFRCA6KCIlKFAsTSxQLE0pKTtwcmludCgnJykNCiAgICAgICAgZWxzZTpwcmludChmb3JtYXQpDQoNCiMjIyBHYW50aSBQYXNzd29yZA0KZGVmIGF1dG9fZ2FudGlfcGFzcyhfcGl5ZV8pOg0KICAgIHdoaWxlIFRydWU6DQogICAgICAgIF9naW1hbmFfID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0NIQU5HRSBPTkUgVEFQIEFDQ09VTlQgUEFTUz8gW1kvbl0gOiAnJShILFAsSCxLKSkNCiAgICAgICAgaWYgX2dpbWFuYV8gaW4gWycnXTpqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyUoTSxQLE0sUCkpO21lbnUoKQ0KICAgICAgICBlbGlmIF9naW1hbmFfIGluIFsnMScsJzAxJywnMDAxJywneScsJ1knXToNCiAgICAgICAgICAgIG9wZW4oJ2F1dG9fZ2FudGkudHh0JywndycpLndyaXRlKCdZZXMnKTtfbmV3cGFzc18gPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzRU5URVIgT05FIFRBUCBQQVNTV09SRCA6ICclKEgsUCxILEspKQ0KICAgICAgICAgICAgaWYgbGVuKF9uZXdwYXNzXyk8NjpwcmludCgnJXMgWyVzISVzXSAlc1NhbmRpIE1pbmltYWwgNiBLYXJha3RlciclKE0sUCxNLFApKTt0aW1lLnNsZWVwKDMpO21lbnUoKQ0KICAgICAgICAgICAgZWxzZTpvcGVuKCdfbmV3X3Bhc3NfLnR4dCcsJ3cnKS53cml0ZShfbmV3cGFzc18pDQogICAgICAgICAgICBpZiBfcGl5ZV8gPT0gJ1llcyc6b3BlbignbXVuY3VsX29wc2kudHh0JywndycpLndyaXRlKCdZZXMnKQ0KICAgICAgICAgICAgZWxpZiBfcGl5ZV8gPT0gJ05vJzpvcGVuKCdtdW5jdWxfb3BzaS50eHQnLCd3Jykud3JpdGUoJ05vJykNCiAgICAgICAgICAgIGVsc2U6b3BlbignbXVuY3VsX29wc2kudHh0JywndycpLndyaXRlKCdObycpDQogICAgICAgICAgICBicmVhaw0KICAgICAgICBlbGlmIF9naW1hbmFfIGluIFsnMicsJzAyJywnMDAyJywnTicsJ24nXTpvcGVuKCdhdXRvX2dhbnRpLnR4dCcsJ3cnKS53cml0ZSgnTm8nKTtwYXNzDQogICAgICAgIGVsc2U6amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgYnJlYWsNCmRlZiBjaGFuZ2VfcGFzcyh1c2VyLF9yZXFfc2VzXyxfcmVzcG9uc2VfLGxpbmtfMik6DQogICAgZ2xvYmFsIG9rLGNwDQogICAgZmlsZXNfb2sgPSAiT0svJXMudHh0IiUodGFuZ2dhbCkNCiAgICB0cnk6X25ld19wYXNzXyA9IG9wZW4oJ19uZXdfcGFzc18udHh0JywncicpLnJlYWQoKQ0KICAgIGV4Y2VwdDpfbmV3X3Bhc3NfID0gJ2F6aW12YXUtXycNCiAgICBfcGFzc3dvcmRfID0gJycuam9pbihfbmV3X3Bhc3NfKTtfcmVzdWx0X29rXyA9ICJcciAlc1slc1NVQ0NFU1NGVUxMJXNdICVzIOKAoiAlcyVzJXMgICAgICAgICAgIiUoSCxQLEgsdXNlcixfcGFzc3dvcmRfLHRhaHVuKHVzZXIpLFApO19idXR0b25fZGV2XyA9IFsic3VibWl0W1llc10iLCJuaCIsImZiX2R0c2ciLCJqYXpvZXN0IiwiY2hlY2twb2ludF9kYXRhIl0NCiAgICBmb3IgX2F6aW12YXVfIGluIF9yZXNwb25zZV8oImlucHV0Iik6DQogICAgICAgIGlmIF9hemltdmF1Xy5nZXQoIm5hbWUiKSBpbiBfYnV0dG9uX2Rldl86ZGF0YV9jaGFuZ2VfMS51cGRhdGUoe19hemltdmF1Xy5nZXQoIm5hbWUiKTpfYXppbXZhdV8uZ2V0KCJ2YWx1ZSIpfSkNCiAgICBfZ2FudGlfcGFzc18gPSBfcmVxX3Nlc18ucG9zdChob3N0K2xpbmtfMi5nZXQoImFjdGlvbiIpLGRhdGE9ZGF0YV9jaGFuZ2VfMSkudGV4dDtfcmVzdWx0X3Bhc3NfID0gcGFyKF9nYW50aV9wYXNzXywiaHRtbC5wYXJzZXIiKTtfbGlua18zXyA9IF9yZXN1bHRfcGFzc18uZmluZCgiZm9ybSIseyJtZXRob2QiOiJwb3N0In0pO19idXR0b25fZGV2X18yXyA9IFsic3VibWl0W05leHRdIiwibmgiLCJmYl9kdHNnIiwiamF6b2VzdCJdDQogICAgaWYgIkNyZWF0ZSBhIG5ldyBwYXNzd29yZCIgaW4gcmUuZmluZGFsbCgiXDx0aXRsZT4oLio/KTxcL3RpdGxlPiIsc3RyKF9nYW50aV9wYXNzXykpOg0KICAgICAgICBmb3IgX2NpY2lfIGluIF9yZXN1bHRfcGFzc18oImlucHV0Iik6DQogICAgICAgICAgICBpZiBfY2ljaV8uZ2V0KCJuYW1lIikgaW4gX2J1dHRvbl9kZXZfXzJfOmRhdGFfY2hhbmdlXzIudXBkYXRlKHtfY2ljaV8uZ2V0KCJuYW1lIik6X2NpY2lfLmdldCgidmFsdWUiKX0pDQogICAgICAgIGRhdGFfY2hhbmdlXzIudXBkYXRlKHsicGFzc3dvcmRfbmV3IjpfcGFzc3dvcmRffSk7X3Nlc19maW5hbF8gPSBfcmVxX3Nlc18ucG9zdChob3N0K19saW5rXzNfLmdldCgiYWN0aW9uIiksZGF0YT1kYXRhX2NoYW5nZV8yKTtfY29va2llc18gPSAoIjsiKS5qb2luKFsgIiVzPSVzIiAlIChrZXksIHZhbHVlKSBmb3Iga2V5LCB2YWx1ZSBpbiBfcmVxX3Nlc18uY29va2llcy5nZXRfZGljdCgpLml0ZW1zKCldKTtfX2Nvb2tpZXNfXyA9IGN2dF9jb29raWVzKF9jb29raWVzXyk7Y2VrX2FwayhfcmVzdWx0X29rXyxfX2Nvb2tpZXNfXyk7b2suYXBwZW5kKCIlc+KAoiVzIiUodXNlcixfcGFzc3dvcmRfKSk7X2F6aW12YXVfZGFwdW50YV8oZmlsZXNfb2ssImErIikud3JpdGUoIiVz4oCiJXNcbiIlKHVzZXIsX3Bhc3N3b3JkXykpO2NwIC09IDE7cGFzcw0KICAgIGVsc2U6cGFzcw0KDQojIyMgQ2VrIEFwbGlrYXNpDQpkZWYgY2VrX2FwayhoX29rLF9hemltdmF1Xyk6DQogICAgYXBrID0gW107c2VzXyA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KICAgIGNla19waWxpaF9vcHNpID0gb3BlbignbXVuY3VsX29wc2kudHh0JywncicpLnJlYWQoKQ0KICAgIHVybCA9ICJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vc2V0dGluZ3MvaW5zdGFudF9nYW1lcy90YWJiZWQvP3RhYj1hY3RpdmUiO2RhdF9nYW1lID0gc2VzXy5nZXQodXJsLGNvb2tpZXM9eydjb29raWUnOl9hemltdmF1X30pO2RhdGFnYW1lID0gcGFyKGRhdF9nYW1lLmNvbnRlbnQsJ2h0bWwucGFyc2VyJyk7Zm9ybV8gICAgPSBkYXRhZ2FtZS5maW5kKCdmb3JtJyxtZXRob2Q9J3Bvc3QnKQ0KICAgIGZvciBhc3UgaW4gZm9ybV8uZmluZF9hbGwoImgzIik6DQogICAgICAgIHRyeTpjZWxlbmcgPSBhc3UuZmluZCgnc3BhbicpLnRleHQ7YXBrLmFwcGVuZCgnXG4gICBDb25uZWN0OiAnK2NlbGVuZykNCiAgICAgICAgZXhjZXB0OnBhc3MNCiAgICB1cmwyID0gImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9zZXR0aW5ncy9pbnN0YW50X2dhbWVzL3RhYmJlZC8/dGFiPWluYWN0aXZlIjtkYXRfZ2FtZSA9IHNlc18uZ2V0KHVybDIsY29va2llcz17J2Nvb2tpZSc6X2F6aW12YXVffSk7ZGF0YWdhbWUgPSBwYXIoZGF0X2dhbWUuY29udGVudCwnaHRtbC5wYXJzZXInKTtmb3JtXyAgICA9IGRhdGFnYW1lLmZpbmQoJ2Zvcm0nLG1ldGhvZD0ncG9zdCcpDQogICAgZm9yIGFzdSBpbiBmb3JtXy5maW5kX2FsbCgiaDMiKToNCiAgICAgICAgdHJ5OmNlbGVuZyA9IGFzdS5maW5kKCdzcGFuJykudGV4dDthcGsuYXBwZW5kKCdcbiAgIENvbm5lY3Q6ICcrY2VsZW5nKQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgIGlmIGNla19waWxpaF9vcHNpID09ICdZZXMnOnByaW50KGhfb2srJycuam9pbihhcGspKTtwcmludCgnJykNCiAgICBlbGlmIGNla19waWxpaF9vcHNpID09ICdObyc6cHJpbnQoaF9vaysnJy5qb2luKGFwaykpDQoNCiMjIyBDZWsgVGFodW4gUGVtYnVhdGFuDQpkZWYgdGFodW4oZngpOg0KICAgIGlmIChyZS5maW5kYWxsKCJbYS16QS1aXSIsc3RyKGZ4KSkpOnRhaHVuej0nJw0KICAgIGVsc2U6DQogICAgICAgIGlmIGxlbihmeCk9PTE1Og0KICAgICAgICAgICAgaWYgZnhbOjEwXSBpbiBbJzEwMDAwMDAwMDAnXSAgICAgICA6dGFodW56ID0gJyDigKIgMjAwOScNCiAgICAgICAgICAgIGVsaWYgZnhbOjldIGluIFsnMTAwMDAwMDAwJ10gICAgICAgOnRhaHVueiA9ICcg4oCiIDIwMDknDQogICAgICAgICAgICBlbGlmIGZ4Wzo4XSBpbiBbJzEwMDAwMDAwJ10gICAgICAgIDp0YWh1bnogPSAnIOKAoiAyMDA5Jw0KICAgICAgICAgICAgZWxpZiBmeFs6N10gaW4gWycxMDAwMDAwJywnMTAwMDAwMScsJzEwMDAwMDInLCcxMDAwMDAzJywnMTAwMDAwNCcsJzEwMDAwMDUnXTp0YWh1bnogPSAnIOKAoiAyMDA5Jw0KICAgICAgICAgICAgZWxpZiBmeFs6N10gaW4gWycxMDAwMDA2JywnMTAwMDAwNycsJzEwMDAwMDgnLCcxMDAwMDA5J106dGFodW56ID0gJyDigKIgMjAxMCcNCiAgICAgICAgICAgIGVsaWYgZnhbOjZdIGluIFsnMTAwMDAxJ10gICAgICAgICAgOnRhaHVueiA9ICcg4oCiIDIwMTAvMjAxMScNCiAgICAgICAgICAgIGVsaWYgZnhbOjZdIGluIFsnMTAwMDAyJywnMTAwMDAzJ10gOnRhaHVueiA9ICcg4oCiIDIwMTEvMjAxMicNCiAgICAgICAgICAgIGVsaWYgZnhbOjZdIGluIFsnMTAwMDA0J10gICAgICAgICAgOnRhaHVueiA9ICcg4oCiIDIwMTIvMjAxMycNCiAgICAgICAgICAgIGVsaWYgZnhbOjZdIGluIFsnMTAwMDA1JywnMTAwMDA2J10gOnRhaHVueiA9ICcg4oCiIDIwMTMvMjAxNCcNCiAgICAgICAgICAgIGVsaWYgZnhbOjZdIGluIFsnMTAwMDA3JywnMTAwMDA4J10gOnRhaHVueiA9ICcg4oCiIDIwMTQvMjAxNScNCiAgICAgICAgICAgIGVsaWYgZnhbOjZdIGluIFsnMTAwMDA5J10gICAgICAgICAgOnRhaHVueiA9ICcg4oCiIDIwMTUnDQogICAgICAgICAgICBlbGlmIGZ4Wzo1XSBpbiBbJzEwMDAxJ10gICAgICAgICAgIDp0YWh1bnogPSAnIOKAoiAyMDE1LzIwMTYnDQogICAgICAgICAgICBlbGlmIGZ4Wzo1XSBpbiBbJzEwMDAyJ10gICAgICAgICAgIDp0YWh1bnogPSAnIOKAoiAyMDE2LzIwMTcnDQogICAgICAgICAgICBlbGlmIGZ4Wzo1XSBpbiBbJzEwMDAzJ10gICAgICAgICAgIDp0YWh1bnogPSAnIOKAoiAyMDE4LzIwMTknDQogICAgICAgICAgICBlbGlmIGZ4Wzo1XSBpbiBbJzEwMDA0J10gICAgICAgICAgIDp0YWh1bnogPSAnIOKAoiAyMDE5LzIwMjAnDQogICAgICAgICAgICBlbGlmIGZ4Wzo1XSBpbiBbJzEwMDA1J10gICAgICAgICAgIDp0YWh1bnogPSAnIOKAoiAyMDIwJw0KICAgICAgICAgICAgZWxpZiBmeFs6NV0gaW4gWycxMDAwNicsJzEwMDA3JywnMTAwMDgnXTp0YWh1bnogPSAnIOKAoiAyMDIxJw0KICAgICAgICAgICAgZWxzZTp0YWh1bno9JycNCiAgICAgICAgZWxpZiBsZW4oZngpIGluIFs5LDEwXTp0YWh1bnogPSAnIOKAoiAyMDA4LzIwMDknDQogICAgICAgIGVsaWYgbGVuKGZ4KT09ODp0YWh1bnogPSAnIOKAoiAyMDA3LzIwMDgnDQogICAgICAgIGVsaWYgbGVuKGZ4KT09Nzp0YWh1bnogPSAnIOKAoiAyMDA2LzIwMDcnDQogICAgICAgIGVsc2U6dGFodW56PScnDQogICAgcmV0dXJuIHRhaHVueg0KDQojIyMgQ29udmVydCBDb29raWVzDQpkZWYgY3Z0X2Nvb2tpZXMocmF3X2Nvb2tpZXMpOg0KICAgIG8gPSB7fQ0KICAgICMgX3Jhd19jb29raWVzX3dhcnZlc3RfID0gY191c2VyLGRhdHIsZG5vbmNlLGZyLHNiLHhzDQogICAgIyBfcmF3X2Nvb2tpZXNfYWFwXyAgICAgPSBjX3VzZXIsZnIsc2IseHMsZGF0cg0KICAgICMgX2Nvb2tlZF9jb29raWVzXyAgICAgID0gc2IsZGF0cixjX3VzZXIseHMsZnINCiAgICBraWtvID0gcmF3X2Nvb2tpZXMucmVwbGFjZSgnICcsJycpLnNwbGl0KCc7JykNCiAgICBmb3IgeCBpbiBraWtvOg0KICAgICAgICB5ID0geC5zcGxpdCgnPScpWzBdDQogICAgICAgIHogPSB4LnNwbGl0KCc9JylbMV0NCiAgICAgICAgby51cGRhdGUoe3k6en0pDQogICAgY29va2VkX2Nvb2tpZXMgPSAoJ3NiPSVzOyBkYXRyPSVzOyBjX3VzZXI9JXM7IHhzPSVzOyBmcj0lcyclKG9bJ3NiJ10sb1snZGF0ciddLG9bJ2NfdXNlciddLG9bJ3hzJ10sb1snZnInXSkpDQogICAgI19jb29raWVzXyA9IHsnY29va2llJzpjb29rZWRfY29va2llc30NCiAgICAjcHJpbnQoY29va2VkX2Nvb2tpZXMpDQogICAgcmV0dXJuIGNvb2tlZF9jb29raWVzDQoNCiMjIyBNZXRvZGUgQ3JhY2sNCmRlZiBwaWxpaF9tZXRob2RlKCk6DQogICAgdHJ5Om9zLnJlbW92ZSgnbWV0aG9kLnR4dCcpDQogICAgZXhjZXB0OnBhc3MNCiAgICB3aGlsZSBUcnVlOg0KICAgICAgICBzdGFydF9tZXRob2QoKQ0KICAgICAgICBwdXQgPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzQ0hPT1NFIDogJyUoSCxQLEgsSykpDQogICAgICAgIGlmIHB1dCBpbiBbJycsJyAnLCcgICddOmNvayA9IG9wZW4oJ21ldGhvZC50eHQnLCd3Jyk7Y29rLndyaXRlKCdtZXRob2RlX21iYXNpY192MScpO2Nvay5jbG9zZSgpDQogICAgICAgIGVsaWYgcHV0IGluIFsnMScsJzAxJywnMDAxJywnYSddOmNvayA9IG9wZW4oJ21ldGhvZC50eHQnLCd3Jyk7Y29rLndyaXRlKCdtZXRob2RlX2FwaV92MScpO2Nvay5jbG9zZSgpDQogICAgICAgIGVsaWYgcHV0IGluIFsnMicsJzAyJywnMDAyJywnYiddOmNvayA9IG9wZW4oJ21ldGhvZC50eHQnLCd3Jyk7Y29rLndyaXRlKCdtZXRob2RlX2FwaV92MicpO2Nvay5jbG9zZSgpDQogICAgICAgIGVsaWYgcHV0IGluIFsnMycsJzAzJywnMDAzJywnYyddOmNvayA9IG9wZW4oJ21ldGhvZC50eHQnLCd3Jyk7Y29rLndyaXRlKCdtZXRob2RlX21iYXNpY192MScpO2Nvay5jbG9zZSgpDQogICAgICAgIGVsaWYgcHV0IGluIFsnNCcsJzA0JywnMDA0JywnZCddOmNvayA9IG9wZW4oJ21ldGhvZC50eHQnLCd3Jyk7Y29rLndyaXRlKCdtZXRob2RlX21iYXNpY192MicpO2Nvay5jbG9zZSgpDQogICAgICAgIGVsaWYgcHV0IGluIFsnNScsJzA1JywnMDA1JywnZSddOmNvayA9IG9wZW4oJ21ldGhvZC50eHQnLCd3Jyk7Y29rLndyaXRlKCdtZXRob2RlX21vYmlsZV92MScpO2Nvay5jbG9zZSgpDQogICAgICAgIGVsaWYgcHV0IGluIFsnNicsJzA2JywnMDA2JywnZiddOmNvayA9IG9wZW4oJ21ldGhvZC50eHQnLCd3Jyk7Y29rLndyaXRlKCdtZXRob2RlX21vYmlsZV92MicpO2Nvay5jbG9zZSgpDQogICAgICAgIGVsc2U6Y29rID0gb3BlbignbWV0aG9kLnR4dCcsJ3cnKTtjb2sud3JpdGUoJ21ldGhvZGVfbWJhc2ljX3YxJyk7Y29rLmNsb3NlKCkNCiAgICAgICAgYnJlYWsNCg0KIyMjIENyYWNrDQpjbGFzcyBjcmFjazoNCiAgICBkZWYgX19pbml0X18oc2VsZixmaWxlcyk6DQogICAgICAgIGdsb2JhbCBvayxjcA0KICAgICAgICBzZWxmLmFkYSA9IG9rO3NlbGYuY3AgPSBjcDtzZWxmLmtvID0gMA0KICAgICAgICBzZWxmLl9oYXlvX21hdV9yZWNvZGVfID0gIjEyMzQ1Ig0KICAgICAgICBpZiBsZW4oc2VsZi5faGF5b19tYXVfcmVjb2RlXykgPT0gNTpwYXNzDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICB0cnk6b3MucmVtb3ZlKGZpbGVzKQ0KICAgICAgICAgICAgZXhjZXB0OnByaW50KCJGVUNLIikNCiAgICAgICAgdHJ5Om9zLnJlbW92ZSgnb3B0aW9uXy50eHQnKQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICBjaWsgPSBvcGVuKCdvcHRpb25fLnR4dCcsJ3cnKTtjaWsud3JpdGUoJ251bGwnKTtjaWsuY2xvc2UoKQ0KICAgICAgICB3aGlsZSBUcnVlOg0KICAgICAgICAgICAgcGlsaWhfbWV0aG9kZSgpO3ByaW50KCclcyAnJShPKSk7cHJpbnQoJyVzIFslc+KAoiVzXSAlc0NSQUNLIFdJVEggREVGQVVMVCAvIE1BTlVBTCBQQVNTV09SRCAlc1slc2Qlcy8lc20lc10nJShILFAsSCxCLFAsSCxQLEssUCkpDQogICAgICAgICAgICBfcGlsaWhfc2FuZGlfID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0NIT09TRSA6ICclKEgsUCxILEspKQ0KICAgICAgICAgICAgaWYgX3BpbGloX3NhbmRpXz09IiI6amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgICAgIGVsaWYgX3BpbGloX3NhbmRpXyBpbiBbJ20nLCdNJywnMicsJzAyJywnMDAyJ106DQogICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOg0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OnNlbGYuYXBrID0gZmlsZXM7c2VsZi5mcyA9IF9hemltdmF1X2RhcHVudGFfKHNlbGYuYXBrKS5yZWFkKCkuc3BsaXRsaW5lcygpO2JyZWFrDQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6cHJpbnQgKCIgICAlcyIlKGUpKTtjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICBzZWxmLmZsID0gW10NCiAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gc2VsZi5mczoNCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeTpzZWxmLmZsLmFwcGVuZCh7ImlkIjppLnNwbGl0KCLigKIiKVswXX0pDQogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6cHJpbnQoKCIgICAlcyIlZSkpO2NvbnRpbnVlDQogICAgICAgICAgICAgICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc0VYQU1QTEUgOiAlc05JR0VSSUFOLDEyMzQ1NiwxMjM0NTY2NTQzMjEnJShILFAsSCxLLEgpKTtzZWxmLnB3bGlzdCgpO2JyZWFrDQogICAgICAgICAgICBlbGlmIF9waWxpaF9zYW5kaV8gaW4gWydkJywnRCcsJzEnLCcwMScsJzAwMSddOg0KICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeTpzZWxmLmFwayA9IGZpbGVzO3NlbGYuZnMgPSBfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmFwaykucmVhZCgpLnNwbGl0bGluZXMoKTticmVhaw0KICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOnByaW50ICgiICAgJXMiJShlKSk7Y29udGludWUNCiAgICAgICAgICAgICAgICAgICAgc2VsZi5mbCA9IFtdO3N0YXJ0X21ldGhvZGV6eigpO2tvcGkgPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzQ0hPT1NFIDogJyUoSCxQLEgsSykpDQogICAgICAgICAgICAgICAgICAgIGlmIGtvcGkgaW4gWycnXToNCiAgICAgICAgICAgICAgICAgICAgICAgIGphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnUoKQ0KICAgICAgICAgICAgICAgICAgICBlbGlmIGtvcGkgaW4gWycxJywnMDEnXToNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpIGluIHNlbGYuZnM6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OnNlbGYuZmwuYXBwZW5kKHsiaWQiOmkuc3BsaXQoIuKAoiIpWzBdLCJwdyI6Z2VuZXJhdGUxKGkuc3BsaXQoIuKAoiIpWzFdKX0pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgIGVsaWYga29waSBpbiBbJzInLCcwMiddOg0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gc2VsZi5mczoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6c2VsZi5mbC5hcHBlbmQoeyJpZCI6aS5zcGxpdCgi4oCiIilbMF0sInB3IjpnZW5lcmF0ZTIoaS5zcGxpdCgi4oCiIilbMV0pfSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6Y29udGludWUNCiAgICAgICAgICAgICAgICAgICAgZWxpZiBrb3BpIGluIFsnMycsJzAzJ106DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiBzZWxmLmZzOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeTpzZWxmLmZsLmFwcGVuZCh7ImlkIjppLnNwbGl0KCLigKIiKVswXSwicHciOmdlbmVyYXRlMyhpLnNwbGl0KCLigKIiKVsxXSl9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDpjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICBlbGlmIGtvcGkgaW4gWyc0JywnMDQnXToNCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeTpvcy5yZW1vdmUoJ3Bhc3MudHh0JykNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICB0cnk6b3MucmVtb3ZlKCdkaWdpdHBhc3MudHh0JykNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICB0YW1iYWhfcGFzcygpO3RhbWJhaF9wYXNzX2FuZ2thKCkNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpIGluIHNlbGYuZnM6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OnNlbGYuZmwuYXBwZW5kKHsiaWQiOmkuc3BsaXQoIuKAoiIpWzBdLCJwdyI6Z2VuZXJhdGU0KGkuc3BsaXQoIuKAoiIpWzFdKX0pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgIGVsc2U6amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICAgICAgICAgICAgICAgICAgdHJ5Om9zLnJlbW92ZSgnY3Bfb3B0aW9uLnR4dCcpDQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgICAgICAgICAgICAgIHByaW50KCclcyAnJShPKSk7cHVmID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0JSSU5HIFVQIENQIE9QVElPTlM/IFtZL25dIDogJyUoSCxQLEgsSykpDQogICAgICAgICAgICAgICAgICAgIGlmIHB1ZiBpbiBbJyddOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7bWVudSgpDQogICAgICAgICAgICAgICAgICAgIGVsaWYgcHVmIGluIFsnMScsJzAxJywnMDAxJywneScsJ1knXTphdXRvX2dhbnRpX3Bhc3MoJ1llcycpO2NvayA9IG9wZW4oJ2NwX29wdGlvbi50eHQnLCd3Jyk7Y29rLndyaXRlKCdvcHNpX2NwJyk7Y29rLmNsb3NlKCk7c3RhcnRlZCgpO1RocmVhZFBvb2woMzUpLm1hcChzZWxmLnN0YXJ0X2NyYWNrLHNlbGYuZmwpO29zLnJlbW92ZShzZWxmLmFwayk7X2NpY2lfY2ljaV8oKTticmVhaw0KICAgICAgICAgICAgICAgICAgICBlbGlmIHB1ZiBpbiBbJzInLCcwMicsJzAwMicsJ24nLCdOJ106YXV0b19nYW50aV9wYXNzKCdObycpO2NvayA9IG9wZW4oJ2NwX29wdGlvbi50eHQnLCd3Jyk7Y29rLndyaXRlKCdudWxsJyk7Y29rLmNsb3NlKCk7c3RhcnRlZCgpO1RocmVhZFBvb2woMzUpLm1hcChzZWxmLnN0YXJ0X2NyYWNrLHNlbGYuZmwpO29zLnJlbW92ZShzZWxmLmFwayk7X2NpY2lfY2ljaV8oKTticmVhaw0KICAgICAgICAgICAgICAgICAgICBlbHNlOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7bWVudSgpDQogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOnByaW50KCgiICAgJXMiJWUpKQ0KICAgIGRlZiBwd2xpc3Qoc2VsZik6DQogICAgICAgIHNlbGYucHcgPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzRU5URVIgUEFTU1dPUkQgOiAnJShLLFAsSyxIKSkuc3BsaXQoIiwiKQ0KICAgICAgICBpZiBsZW4oc2VsZi5wdykgPT0wOnNlbGYucHdsaXN0KCkNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIGZvciBpIGluIHNlbGYuZmw6aS51cGRhdGUoeyJwdyI6c2VsZi5wd30pDQogICAgICAgICAgICB0cnk6b3MucmVtb3ZlKCdjcF9vcHRpb24udHh0JykNCiAgICAgICAgICAgIGV4Y2VwdDpwYXNzDQogICAgICAgICAgICBwcmludCgnJXMgJyUoTykpO3B1ZiA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNQT1AgVVAgQ1AgT1BUSU9OUz8gW1kvbl0gOiAnJShILFAsSCxLKSkNCiAgICAgICAgICAgIGlmIHB1ZiBpbiBbJyddOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7bWVudSgpDQogICAgICAgICAgICBlbGlmIHB1ZiBpbiBbJzEnLCcwMScsJzAwMScsJ3knLCdZJ106YXV0b19nYW50aV9wYXNzKCdZZXMnKTtjb2sgPSBvcGVuKCdjcF9vcHRpb24udHh0JywndycpO2Nvay53cml0ZSgnb3BzaV9jcCcpO2Nvay5jbG9zZSgpO3N0YXJ0ZWQoKTtUaHJlYWRQb29sKDMwKS5tYXAoc2VsZi5zdGFydF9jcmFjayxzZWxmLmZsKTtvcy5yZW1vdmUoc2VsZi5hcGspO19jaWNpX2NpY2lfKCkNCiAgICAgICAgICAgIGVsaWYgcHVmIGluIFsnMicsJzAyJywnMDAyJywnbicsJ04nXTphdXRvX2dhbnRpX3Bhc3MoJ05vJyk7Y29rID0gb3BlbignY3Bfb3B0aW9uLnR4dCcsJ3cnKTtjb2sud3JpdGUoJ251bGwnKTtjb2suY2xvc2UoKTtzdGFydGVkKCk7VGhyZWFkUG9vbCgzMCkubWFwKHNlbGYuc3RhcnRfY3JhY2ssc2VsZi5mbCk7b3MucmVtb3ZlKHNlbGYuYXBrKTtfY2ljaV9jaWNpXygpDQogICAgICAgICAgICBlbHNlOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7bWVudSgpDQogICAgZGVmIHN0YXJ0X2NyYWNrKHNlbGYsZmwpOg0KICAgICAgICB0cnk6DQogICAgICAgICAgICBtZXRvZGUgPSBvcGVuKCdtZXRob2QudHh0JywncicpLnJlYWQoKQ0KICAgICAgICAgICAgZm9yIGkgaW4gZmwuZ2V0KCJwdyIpOg0KICAgICAgICAgICAgICAgIGlmICdtZXRob2RlX2FwaV92MScgaW4gbWV0b2RlOmxvZyA9IGxvZ19hcGlfMShmbC5nZXQoImlkIiksaSkNCiAgICAgICAgICAgICAgICBlbGlmICdtZXRob2RlX2FwaV92MicgaW4gbWV0b2RlOmxvZyA9IGxvZ19hcGlfMihmbC5nZXQoImlkIiksaSkNCiAgICAgICAgICAgICAgICBlbGlmICdtZXRob2RlX21iYXNpY192MScgaW4gbWV0b2RlOmxvZyA9IGxvZ19tYmFzaWNfMShmbC5nZXQoImlkIiksaSkNCiAgICAgICAgICAgICAgICBlbGlmICdtZXRob2RlX21iYXNpY192MicgaW4gbWV0b2RlOmxvZyA9IGxvZ19tYmFzaWNfMihmbC5nZXQoImlkIiksaSkNCiAgICAgICAgICAgICAgICBlbGlmICdtZXRob2RlX21vYmlsZV92MScgaW4gbWV0b2RlOmxvZyA9IGxvZ19tb2JpbGVfMShmbC5nZXQoImlkIiksaSkNCiAgICAgICAgICAgICAgICBlbGlmICdtZXRob2RlX21vYmlsZV92MicgaW4gbWV0b2RlOmxvZyA9IGxvZ19tb2JpbGVfMihmbC5nZXQoImlkIiksaSkNCiAgICAgICAgICAgICAgICBlbHNlOmxvZyA9IGxvZ19tYmFzaWNfMShmbC5nZXQoImlkIiksaSkNCiAgICAgICAgICAgICAgICBpZiBsb2cuZ2V0KCJzdGF0dXMiKT09ImNwIjoNCiAgICAgICAgICAgICAgICAgICAgZmlsZXNfY3AgPSAiQ1AvJXMudHh0IiUodGFuZ2dhbCkNCiAgICAgICAgICAgICAgICAgICAgaWYgZmwuZ2V0KCJpZCIpIGluIGZpbGVzX2NwOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeTprZSA9IF9yZXFfZ2V0XygiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIiArIGZsLmdldCgiaWQiKSArICI/ZmllbGRzPW5hbWUsaWQsYmlydGhkYXksZmlyc3RfbmFtZSxtaWRkbGVfbmFtZSxsYXN0X25hbWUsbmFtZV9mb3JtYXQscGljdHVyZSxzaG9ydF9uYW1lJmFjY2Vzc190b2tlbj0iICsgX2F6aW12YXVfZGFwdW50YV8oInRva2VuLnR4dCIsInIiKS5yZWFkKCkpO3R0ID0gX2pzX2xvXyhrZS50ZXh0KTt0dGwgPSB0dFsiYmlydGhkYXkiXTttLGQseSA9IHR0bC5zcGxpdCgiLyIpO20gPSBidWxhbl90dGxbbV07dHRsbCA9ICgnIOKAoiAlcyAlcyAlcyclKGQsbSx5KSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDp0dGxsID0gKCcnJSgpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaF9jcCA9ICJcciAlc1slc0NQJXNdICVzIOKAoiAlcyVzJXMgICAgICAgICAgIiUoSyxQLEssZmwuZ2V0KCJpZCIpLGksdHRsbCx0YWh1bihmbC5nZXQoImlkIikpKTtjZWtfb3BzaShmbC5nZXQoImlkIiksaSxoX2NwKQ0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jcC5hcHBlbmQoIiVz4oCiJXMiJShmbC5nZXQoImlkIiksaSkpO19hemltdmF1X2RhcHVudGFfKGZpbGVzX2NwLCJhKyIpLndyaXRlKCIlc+KAoiVzJXNcbiIlKGZsLmdldCgiaWQiKSxpLHR0bGwucmVwbGFjZSgnICcsJycpKSk7YnJlYWsNCiAgICAgICAgICAgICAgICBlbGlmIGxvZy5nZXQoInN0YXR1cyIpPT0ib2siOg0KICAgICAgICAgICAgICAgICAgICBmaWxlc19vayA9ICJPSy8lcy50eHQiJSh0YW5nZ2FsKQ0KICAgICAgICAgICAgICAgICAgICBpZiBmbC5nZXQoImlkIikgaW4gZmlsZXNfb2s6cGFzcw0KICAgICAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgJ21ldGhvZGVfbWJhc2ljX3YxJyBpbiBtZXRvZGUgb3IgJ21ldGhvZGVfbWJhc2ljX3YyJyBpbiBtZXRvZGUgb3IgJ21ldGhvZGVfbW9iaWxlX3YxJyBpbiBtZXRvZGUgb3IgJ21ldGhvZGVfbW9iaWxlX3YyJyBpbiBtZXRvZGU6aF9vayA9ICJcciAlc1slc1NVQ0NFU1NGVUxMJXNdICVzIOKAoiAlcyVzJXMgICAgICAgICAgIiUoSCxQLEgsZmwuZ2V0KCJpZCIpLGksdGFodW4oZmwuZ2V0KCJpZCIpKSxQKTtjZWtfYXBrKGhfb2ssY3Z0X2Nvb2tpZXMobG9nLmdldCgiY29va2llcyIpKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6cHJpbnQoIlxyICVzWyVzU1VDQ0VTU0ZVTEwlc10gJXMg4oCiICVzJXMgICAgICAgICAgIiUoSCxQLEgsZmwuZ2V0KCJpZCIpLGksdGFodW4oZmwuZ2V0KCJpZCIpKSkpDQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFkYS5hcHBlbmQoIiVz4oCiJXMiJShmbC5nZXQoImlkIiksaSkpO19hemltdmF1X2RhcHVudGFfKGZpbGVzX29rLCJhKyIpLndyaXRlKCIlc+KAoiVzXG4iJShmbC5nZXQoImlkIiksaSkpO2JyZWFrDQogICAgICAgICAgICAgICAgZWxzZTpjb250aW51ZQ0KICAgICAgICAgICAgc2VsZi5rbys9MQ0KICAgICAgICAgICAgcHJpbnQoIlxyICVzWyVzQ3JhY2tpbmclc11bJXMlcy8lcyVzXVslc0dPT0Q6JXMlc11bJXNDUDolcyVzXSVzIiUoSyxILEssUCxzZWxmLmtvLGxlbihzZWxmLmZsKSxLLFAsbGVuKHNlbGYuYWRhKSxLLFAsbGVuKHNlbGYuY3ApLEssUCksIGVuZD0nJyk7c3lzLnN0ZG91dC5mbHVzaCgpDQogICAgICAgIGV4Y2VwdDpzZWxmLnN0YXJ0X2NyYWNrKGZsKQ0KDQoNCiMjIyBNZW5kYXBhdCBKdW1sYWggVGVtYW4gVGFyZ2V0DQpkZWYgdGVtYW5fdGFyZ2V0KCk6DQogICAgaXQgPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzVEFSR0VUIElEIDolcyAnJShILFAsSCxLLEgpKQ0KICAgIHRyeTp0b2tlbiA9IF9hemltdmF1X2RhcHVudGFfKCd0b2tlbi50eHQnLCdyJykucmVhZCgpO21tID0gX3JlcV9nZXRfKCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8lcz9hY2Nlc3NfdG9rZW49JXMnJShpdCx0b2tlbikpO25uID0gX2pzX2xvXyhtbS50ZXh0KTtwcmludCAoJyVzIFslc+KAoiVzXSAlc05BTUUgOiAlcyclKEgsUCxILEssbm5bJ25hbWUnXSkpDQogICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yKTpqYWxhbignJXMgWyVzISVzXSAlc1RPS0VOL0NPT0tJRVMgSU5WQUxJRCclKE0sUCxNLFApKTttZW51X2xvZygpDQogICAgdHQ9W107dGU9W107bGltID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0RVTVAgTElNSVQgOiAlcyclKEgsUCxILEssSCkpO3ByaW50KCclcyAlcyclKE8sUCkpO2FkYSA9IF9yZXFfZ2V0XygnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXMvZnJpZW5kcz9saW1pdD0lcyZhY2Nlc3NfdG9rZW49JXMnJShpdCxsaW0sdG9rZW4pKTtpZGkgPSBfanNfbG9fKGFkYS50ZXh0KQ0KICAgIGZvciB4IGluIGlkaVsnZGF0YSddOnR0LmFwcGVuZCh4WydpZCddKQ0KICAgIGZvciBpZCBpbiB0dDoNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgYWRhMiA9IF9yZXFfZ2V0XygnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXMvZnJpZW5kcz9hY2Nlc3NfdG9rZW49JXMnJShpZCx0b2tlbikpO2lkaTIgPSBfanNfbG9fKGFkYTIudGV4dCkNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICBmb3IgYiBpbiBpZGkyWydkYXRhJ106dGUuYXBwZW5kKGJbJ2lkJ10pDQogICAgICAgICAgICBleGNlcHQgS2V5RXJyb3I6cHJpbnQoJyBbIV0gUFJJVkFURScpDQogICAgICAgICAgICBwcmludCgnIFvigKJdJyxpZCwn4oCiJyxsZW4odGUpKTt0ZS5jbGVhcigpDQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjpwcmludCgnJXMgWyFdIFNQQU0gQUNDT1VOVC4uLiEnJShNKSkNCiAgICBwcmludCgnICcpO19jaWNpX2F6aW12YXVfKCcgWyBCQUNLIF0nKTttZW51KCkNCg0KIyMjIE1lbnUgTWVuZ2VjZWsgcmVzdWx0IENyYWNrDQpkZWYgcmVzdWx0KCk6DQogICAgY2xlYXIoKQ0KICAgIGJhbm5lcigpDQogICAgamFsYW4oJyVzIFsgJXNDUkFDSyBSRVNVTFRTICVzXSclKEgsUCxIKSk7cHJpbnQoJyVzICclKE8pKTtwcmludCgnJXMgWyVzMSVzXSAlc0NIRUNLIFJFU1VMVFMgT0snJShILFAsSCxLKSk7cHJpbnQoJyVzIFslczIlc10gJXNDSEVDSyBSRVNVTFRTIENQJyUoSCxQLEgsUCkpO2NoID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0NIT09TRSA6ICclKEgsUCxILEspKQ0KICAgIGlmIGNoIGluIFsnJ106amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTttZW51KCkNCiAgICBlbGlmIGNoIGluIFsnMScsJzAxJywnMDAxJywnYSddOg0KICAgICAgICB0cnk6DQogICAgICAgICAgICBva2wgPSBvcy5saXN0ZGlyKCJPSyIpO3ByaW50KCclcyAnJShPKSk7cHJpbnQoJyVzIFslcyBDUkFDSyBSRVNVTFRTIFNUT1JFRCBJTiBPSyBGSUxFICVzXSclKEgsUCxIKSk7cHJpbnQoJyVzICclKE8pKQ0KICAgICAgICAgICAgZm9yIGZpbGUgaW4gb2tsOnByaW50KCclcyBbJXPigKIlc10gJXMlcyclKEgsUCxILEssZmlsZSkpDQogICAgICAgICAgICBwcmludCgnJXMgJyUoTykpO2ZpbGVzID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0VOVEVSIEZJTEUgTkFNRSA6ICclKEgsUCxILEspKTtwcmludCgnJykNCiAgICAgICAgICAgIGlmIGZpbGVzID09ICIiOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxQKSk7cmVzdWx0KCkNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICBwcHAgPSBfYXppbXZhdV9kYXB1bnRhXygiT0svJXMiJShmaWxlcykpLnJlYWQoKS5zcGxpdGxpbmVzKCkNCiAgICAgICAgICAgICAgICBmb3IgeCBpbiBwcHA6eXl5ID0geC5yZXBsYWNlKCfigKInLCcg4oCiICcpO3ByaW50KCcgJXNbJXNTVUNDRVNTRlVMJXNdICVzJyUoSCxQLEgseXl5KSkNCiAgICAgICAgICAgICAgICBkZWwxID0gKCIlcyIlKGZpbGVzKSkucmVwbGFjZSgiLSIsICIgIikucmVwbGFjZSgiLnR4dCIsICIiKTtwcmludCgnXG4lcyBbJXPigKIlc10gJXNUT1RBTCBDUkFDSyBSRVNVTFQgREFURSAlcyBJUyAlcyBBQ0NPVU5UJyUoSCxQLEgsSyxkZWwxLGxlbihwcHApKSkNCiAgICAgICAgICAgIGV4Y2VwdDpwcmludCgnJXMgWyVzIE5PIFJFU1VMVFMgRk9VTkQgJXNdJyUoTSxQLE0pKQ0KICAgICAgICBleGNlcHQgKEtleUVycm9yLElPRXJyb3IpOnByaW50KCclcyBbJXMgTk8gUkVTVUxUUyBGT1VORCAlc10nJShNLFAsTSkpDQogICAgZWxpZiBjaCBpbiBbJzInLCcwMicsJzAwMicsJ2InXToNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgY3BsID0gb3MubGlzdGRpcigiQ1AiKTtwcmludCgnJXMgJyUoTykpO3ByaW50KCclcyBbJXMgQ1JBQ0sgUkVTVUxUUyBTVE9SRUQgSU4gQ1AgRklMRVMgJXNdJyUoSCxQLEgpKTtwcmludCgnJXMgJyUoTykpDQogICAgICAgICAgICBmb3IgZmlsZSBpbiBjcGw6cHJpbnQoJyVzIFslc+KAoiVzXSAlcyVzJyUoSCxQLEgsSyxmaWxlKSkNCiAgICAgICAgICAgIHByaW50KCclcyAnJShPKSk7ZmlsZXMgPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzRU5URVIgRklMRSBOQU1FIDogJyUoSCxQLEgsSykpO3ByaW50KCcnKQ0KICAgICAgICAgICAgaWYgZmlsZXMgPT0gIiI6amFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCclKE0sUCxNLFApKTtyZXN1bHQoKQ0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgIHBwcCA9IF9hemltdmF1X2RhcHVudGFfKCJDUC8lcyIlKGZpbGVzKSkucmVhZCgpLnNwbGl0bGluZXMoKQ0KICAgICAgICAgICAgICAgIGZvciB4IGluIHBwcDp5eXkgPSB4LnJlcGxhY2UoJ+KAoicsJyDigKIgJyk7cHJpbnQoJyAlc1slc0NQJXNdICVzJyUoSyxQLEsseXl5KSkNCiAgICAgICAgICAgICAgICBkZWwxID0gKCIlcyIlKGZpbGVzKSkucmVwbGFjZSgiLSIsICIgIikucmVwbGFjZSgiLnR4dCIsICIiKTtwcmludCgnXG4lcyBbJXPigKIlc10gJXNUT1RBTCBDUkFDSyBSRVNVTFQgREFURSAlcyBJUyAlcyBBQ0NPVU5UJyUoSCxQLEgsUCxkZWwxLGxlbihwcHApKSkNCiAgICAgICAgICAgIGV4Y2VwdDpwcmludCgnJXMgWyVzIE5PIFJFU1VMVFMgRk9VTkQgJXNdJyUoUCxNLE0pKQ0KICAgICAgICBleGNlcHQ6cHJpbnQoJyVzIFslcyBOTyBSRVNVTFRTIEZPVU5EICVzXSclKFAsTSxQKSkNCiAgICBlbHNlOmphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnJShNLFAsTSxNKSk7bWVudSgpDQogICAgcHJpbnQoJyVzICclKE8pKTtfY2ljaV9hemltdmF1XygnJXMgWyAlc0JBQ0sgJXNdJXMnJShILFAsSCxLKSk7bWVudSgpDQoNCmRlZiBjZWtfcmVzdWx0KCk6DQogICAgdHJ5Om9zLnJlbW92ZSgnb3B0aW9uXy50eHQnKQ0KICAgIGV4Y2VwdDpwYXNzDQogICAgY2lrID0gb3Blbignb3B0aW9uXy50eHQnLCd3Jyk7Y2lrLndyaXRlKCdyZXN1bHQnKTtjaWsuY2xvc2UoKQ0KICAgIHByaW50KCclcyBbICVzQ0hFQ0sgQ1JBQ0sgUkVTVUxUIEFDQ09VTlQgT1BUSU9OUyAlc10nJShILEssSCkpO3ByaW50KCclcyAnJShPKSk7cHJpbnQoJyVzIFslc+KAoiVzXSAlc0VYQU1QTEUgRklMRSA6ICVzLnR4dCclKEgsUCxILEssdGFuZ2dhbCkpO2ZpbGVzX18gPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzRmlsZSA6ICclKEgsUCxILEspKTtmaWxlcyA9ICJDUC8iK2ZpbGVzX18NCiAgICB0cnk6YnVrYV9iYWp1ID0gX2F6aW12YXVfZGFwdW50YV8oZmlsZXMsInIiKS5yZWFkKCkuc3BsaXRsaW5lcygpDQogICAgZXhjZXB0IEZpbGVOb3RGb3VuZEVycm9yOnByaW50KCIlcyBbJXMhJXNdICVzRklMRSBOT1QgRVhJU1RJTkciJShNLFAsTSxQKSk7dGltZS5zbGVlcCgyKTsgbWVudSgpDQogICAgYXV0b19nYW50aV9wYXNzKCdZZXMnKTtwcmludCgiJXMgWyVz4oCiJXNdICVzVE9UQUwgQUNDT1VOVFMgOiAlcyVzIiUoSCxQLEgsSyxILHN0cihsZW4oYnVrYV9iYWp1KSkpKTtwcmludCgiIikNCiAgICBmb3IgbWVtZWsgaW4gYnVrYV9iYWp1Og0KICAgICAgICBpZiAnw6LigqzCoicgaW4gbWVtZWs6bWVtZWsgPSBtZW1lay5yZXBsYWNlKCfDouKCrMKiJywn4oCiJykNCiAgICAgICAga29udG9sID0gbWVtZWsucmVwbGFjZSgi4oCiIiwiIOKAoiAiKTt0aXRpZCAgPSBtZW1lay5zcGxpdCgi4oCiIikNCiAgICAgICAgX2Zvcm1hdF8gPSAiXHIgJXNbJXNDUCVzXSAlcyAgICAgICAgICAiJShLLFAsSyxrb250b2wpDQogICAgICAgIHRyeTpjZWtfb3BzaSh0aXRpZFswXSx0aXRpZFsxXSxfZm9ybWF0XykNCiAgICAgICAgZXhjZXB0OmNvbnRpbnVlDQogICAgcHJpbnQoIiIpO3ByaW50KCclcyBbJXPigKIlc10gJXNDSEVDS0lORyBQUk9DRVNTIENPTVBMRVRFJyUoSCxQLEgsSykpO3ByaW50KCclcyAnJShPKSk7X2NpY2lfYXppbXZhdV8oJyVzIFsgJXNCQUNLICVzXSVzJyUoSCxQLEgsSykpO21lbnUoKQ0KDQoNCiMjIyBWYXJpYXNpIFRla3MNCmRlZiB2YXJfbWVudSgpOg0KICAgIHByaW50KCclcyAgICAgICAgICBbICVzQ0hPT1NFIExPR0lOIE1FVEhPRCAlc10nJShaLEssWikpDQogICAgcHJpbnQoJycpDQogICAgcHJpbnQoJyVzIFslczElc10gJXNMT0dJTiBXSVRIIFRPS0VOIFslc0xJTUlURUQgQUNDRVNTJXNdJyUoSCxQLEgsUCxNLFApKQ0KICAgIHByaW50KCclcyBbJXMyJXNdICVzTE9HSU4gV0lUSCBDT09LSUVTIFslc1VOTElNSVRFRCBBQ0NFU1Mlc10nJShILFAsSCxQLEgsUCkpDQogICAgcHJpbnQoJyVzIFslczAlc10gJXNFWElUJyUoSCxQLEgsTSkpDQogICAgcHJpbnQoJyVzICclKE8pKQ0KICAgIA0KICAgIA0KZGVmIHZhcl91Z2VuKCk6DQogICAgcHJpbnQoIiVzIFslczElc10gJXNHRVQgVVNFUiBBR0VOVCIlKEgsUCxILEgpKQ0KICAgIHByaW50KCIlcyBbJXMyJXNdICVzQ0hBTkdFIFVTRVIgQUdFTlQgJXMoJXNNQU5VQUwlcykiJShILFAsSCxQLEIsSCxCKSkNCiAgICBwcmludCgiJXMgWyVzMyVzXSAlc0NIQU5HRSBVU0VSIEFHRU5UICVzKCVzQURKVVNUIEhQJXMpIiUoSCxQLEgsUCxCLEssQikpDQogICAgcHJpbnQoIiVzIFslczQlc10gJXNERUxFVEUgVVNFUiBBR0VOVCIlKEgsUCxILE0pKQ0KICAgIHByaW50KCIlcyBbJXM1JXNdICVzQ0hFQ0sgVVNFUiBBR0VOVCIlKEgsUCxILEspKQ0KICAgIHByaW50KCIlcyBbJXMwJXNdICVzQkFDSyIlKEgsUCxILE0pKQ0KDQpkZWYgc3RhcnRfbWV0aG9kKCk6DQogICAgcHJpbnQoJyVzICclKE8pKQ0KICAgIHByaW50KCclcyBbJXMxJXNdICVzQVBJIE1FVEhPRCBWMSclKEgsUCxILE0pKQ0KICAgIHByaW50KCclcyBbJXMyJXNdICVzQVBJIE1FVEhPRCBWMiclKEgsUCxILEIpKQ0KICAgIHByaW50KCclcyBbJXMzJXNdICVzV0lGSSBNT0QgVjEgW1NwZWVkXSclKEgsUCxILEgpKQ0KICAgIHByaW50KCclcyBbJXM0JXNdICVzV0lGSSBNT0QgVjInJShILFAsSCxLKSkNCiAgICBwcmludCgnJXMgWyVzNSVzXSAlc01PQklMRSBNRVRIT0QgVjEnJShILFAsSCxPKSkNCiAgICBwcmludCgnJXMgWyVzNiVzXSAlc01PQklMRSBNRVRIT0QgVjInJShILFAsSCxQKSkNCg0KZGVmIHN0YXJ0X21ldGhvZGV6eigpOg0KICAgIHByaW50KCIiKQ0KICAgIHByaW50KCclcyBbJXMxJXNdICVzRkFTVCBDTE9ORSAlc1slc0ZFVyBSRVNVTFRTJXNdJyUoSCxQLEgsTyxPLE0sTykpDQogICAgcHJpbnQoJyVzIFslczIlc10gJXNTTE9XIENMT05FICVzWyVzUkVDT01NRU5ERUQlc10nJShILFAsSCxPLE8sSCxPKSkNCiAgICBwcmludCgnJXMgWyVzMyVzXSAlc1ZFUlkgU0xPVyBDTE9ORSAlc1slc01PUkUgUkVTVUxUUyVzXSclKEgsUCxILE8sTyxCLE8pKQ0KICAgIHByaW50KCclcyBbJXM0JXNdICVzQ09NQklORUQgUEFTU1dPUkQgQ0xPTkUnJShILFAsSCxLKSkNCiAgICBwcmludCgiIikNCiAgICANCiAgICANCmRlZiBzdGFydGVkKCk6DQogICAgcHJpbnQoIiIpDQogICAgcHJpbnQoIiAgICAgJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiIiUoSCxNLEIsSyxVLE8sSyxILE0sQixLLFUsTyxLLEgsTSxCLEspKQ0KICAgIHByaW50KCclcyBbJXPigKIlc10gJXNDTE9OSU5HIElOIFBST0dSRVNTLi4uJyUoSCxNLEgsSCkpDQogICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc1slc0dPT0Qlc10gSURTIFNBVkVEIElOID4+ICVzR09PRC8lcy50eHQnJShILEIsSCxPLEgsTyxILHRhbmdnYWwpKQ0KICAgIHByaW50KCclcyBbJXPigKIlc10gJXNbJXNDUCVzXSBJRFMgU0FWRUQgSU4gPj4gJXNDUC8lcy50eHQnJShILEssSCxPLE0sTyxNLHRhbmdnYWwpKQ0KICAgIHBzYignJXMgWyVz4oCiJXNdICVzT04gRkxJR0hUIE1PREUgRk9SIFszIFNFQ10gRVZFUlkgMyBNSU5VVEVTXG4nJShILFAsSCxCKSkNCg0KDQpkZWYgZm9sZGVyKCk6DQogICAgdHJ5Om9zLm1rZGlyKCJDUCIpDQogICAgZXhjZXB0OnBhc3MNCiAgICB0cnk6b3MubWtkaXIoIkdPT0QiKQ0KICAgIGV4Y2VwdDpwYXNzDQoNCg0KDQogICAJDQppZiBfX25hbWVfXz09J19fbWFpbl9fJzoNCglvcy5zeXN0ZW0oJ2dpdCBwdWxsJykNCglmb2xkZXIoKQ0KCW1lbnUoKQ=="))
